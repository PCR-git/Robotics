
function SmallAngleApprox

close all;
clear all;
clc;

syms L1 L2 L3 L4 L5 L6...
     m1 I1 m2 I2 m3 I3 m4 I4 m5 I5 m6 I6...
     phi1 phi2 phi3 phi4 phi5 phi6...
     phi1p phi2p phi3p phi4p phi5p phi6p...
     u1b u2b u3b u4b u5b...
     force1 force2 force3 force4 force5 force6 force7 force8 force9...
     force10 force11 force12 force13 force14 force15 force16 force17 force18...
     lambda1 lambda2 lambda3 lambda4...
     lambda5 lambda6 lambda7 lambda8...
     lambda9 lambda10...

%% LAMBDA VECTOR

Lambda = [-(2*force4*m1 - 2*force1*m3 - 2*force1*m4 - 2*force1*m2 - 2*force1*m5 - 2*force1*m6 + 2*force7*m1 + 2*force10*m1 + 2*force13*m1 + 2*force16*m1 + m1*m2*u1b*cos(phi1) - m1*m2*u1b*cos(phi2) + m1*m3*u1b*cos(phi1) + m1*m2*u2b*cos(phi2) - 2*m1*m3*u1b*cos(phi2) + m1*m4*u1b*cos(phi1) + 2*m1*m3*u2b*cos(phi2) - 2*m1*m4*u1b*cos(phi2) + m1*m5*u1b*cos(phi1) - m1*m3*u2b*cos(phi3) + 2*m1*m4*u2b*cos(phi2) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) + m1*m3*u3b*cos(phi3) - 2*m1*m4*u2b*cos(phi3) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) + 2*m1*m4*u3b*cos(phi3) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) - m1*m4*u3b*cos(phi4) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) + m1*m4*u4b*cos(phi4) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) + 2*m1*m6*u5b*cos(phi5) - m1*m6*u5b*cos(phi6) + 2*L1*m1*m2*phi1p^2*sin(phi1) + 2*L1*m1*m3*phi1p^2*sin(phi1) + 2*L1*m1*m4*phi1p^2*sin(phi1) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L2*m1*m2*phi2p^2*sin(phi2) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 4*L2*m1*m3*phi2p^2*sin(phi2) + 4*L2*m1*m4*phi2p^2*sin(phi2) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L3*m1*m3*phi3p^2*sin(phi3) + 4*L3*m1*m4*phi3p^2*sin(phi3) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 2*L4*m1*m4*phi4p^2*sin(phi4) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
           (2*force2*m2 + 2*force2*m3 + 2*force2*m4 - 2*force5*m1 + 2*force2*m5 + 2*force2*m6 - 2*force8*m1 - 2*force11*m1 - 2*force14*m1 - 2*force17*m1 - m1*m2*u1b*sin(phi1) + m1*m2*u1b*sin(phi2) - m1*m3*u1b*sin(phi1) - m1*m2*u2b*sin(phi2) + 2*m1*m3*u1b*sin(phi2) - m1*m4*u1b*sin(phi1) - 2*m1*m3*u2b*sin(phi2) + 2*m1*m4*u1b*sin(phi2) - m1*m5*u1b*sin(phi1) + m1*m3*u2b*sin(phi3) - 2*m1*m4*u2b*sin(phi2) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) - m1*m3*u3b*sin(phi3) + 2*m1*m4*u2b*sin(phi3) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) - 2*m1*m4*u3b*sin(phi3) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) + m1*m4*u3b*sin(phi4) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) - m1*m4*u4b*sin(phi4) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) - 2*m1*m6*u5b*sin(phi5) + m1*m6*u5b*sin(phi6) + 2*L1*m1*m2*phi1p^2*cos(phi1) + 2*L1*m1*m3*phi1p^2*cos(phi1) + 2*L1*m1*m4*phi1p^2*cos(phi1) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L2*m1*m2*phi2p^2*cos(phi2) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 4*L2*m1*m3*phi2p^2*cos(phi2) + 4*L2*m1*m4*phi2p^2*cos(phi2) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L3*m1*m3*phi3p^2*cos(phi3) + 4*L3*m1*m4*phi3p^2*cos(phi3) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 2*L4*m1*m4*phi4p^2*cos(phi4) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
          -(2*force7*m1 - 2*force1*m4 - 2*force1*m5 - 2*force1*m6 - 2*force4*m3 - 2*force4*m4 - 2*force1*m3 - 2*force4*m5 + 2*force7*m2 - 2*force4*m6 + 2*force10*m1 + 2*force10*m2 + 2*force13*m1 + 2*force13*m2 + 2*force16*m1 + 2*force16*m2 + m1*m3*u1b*cos(phi1) - 2*m1*m3*u1b*cos(phi2) + m1*m4*u1b*cos(phi1) + 2*m1*m3*u2b*cos(phi2) - 2*m1*m4*u1b*cos(phi2) + m1*m5*u1b*cos(phi1) - m2*m3*u1b*cos(phi2) - m1*m3*u2b*cos(phi3) + 2*m1*m4*u2b*cos(phi2) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) + m2*m3*u2b*cos(phi2) - m2*m4*u1b*cos(phi2) + m1*m3*u3b*cos(phi3) - 2*m1*m4*u2b*cos(phi3) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) - m2*m3*u2b*cos(phi3) + m2*m4*u2b*cos(phi2) - m2*m5*u1b*cos(phi2) + 2*m1*m4*u3b*cos(phi3) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) + m2*m3*u3b*cos(phi3) - 2*m2*m4*u2b*cos(phi3) + m2*m5*u2b*cos(phi2) - m2*m6*u1b*cos(phi2) - m1*m4*u3b*cos(phi4) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) + 2*m2*m4*u3b*cos(phi3) - 2*m2*m5*u2b*cos(phi3) + m2*m6*u2b*cos(phi2) + m1*m4*u4b*cos(phi4) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) - m2*m4*u3b*cos(phi4) + 2*m2*m5*u3b*cos(phi3) - 2*m2*m6*u2b*cos(phi3) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) + m2*m4*u4b*cos(phi4) - 2*m2*m5*u3b*cos(phi4) + 2*m2*m6*u3b*cos(phi3) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) + 2*m2*m5*u4b*cos(phi4) - 2*m2*m6*u3b*cos(phi4) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) - m2*m5*u4b*cos(phi5) + 2*m2*m6*u4b*cos(phi4) + 2*m1*m6*u5b*cos(phi5) + m2*m5*u5b*cos(phi5) - 2*m2*m6*u4b*cos(phi5) - m1*m6*u5b*cos(phi6) + 2*m2*m6*u5b*cos(phi5) - m2*m6*u5b*cos(phi6) + 2*L1*m1*m3*phi1p^2*sin(phi1) + 2*L1*m1*m4*phi1p^2*sin(phi1) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 4*L2*m1*m3*phi2p^2*sin(phi2) + 4*L2*m1*m4*phi2p^2*sin(phi2) + 2*L2*m2*m3*phi2p^2*sin(phi2) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 2*L2*m2*m4*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L2*m2*m5*phi2p^2*sin(phi2) + 2*L3*m1*m3*phi3p^2*sin(phi3) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L3*m1*m4*phi3p^2*sin(phi3) + 2*L3*m2*m3*phi3p^2*sin(phi3) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 4*L3*m2*m4*phi3p^2*sin(phi3) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m2*m5*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 2*L4*m1*m4*phi4p^2*sin(phi4) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 2*L4*m2*m4*phi4p^2*sin(phi4) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m2*m5*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 2*L5*m2*m5*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 2*L6*m2*m6*phi6p^2*sin(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
           (2*force2*m3 + 2*force2*m4 + 2*force2*m5 + 2*force2*m6 + 2*force5*m3 + 2*force5*m4 - 2*force8*m1 + 2*force5*m5 - 2*force8*m2 + 2*force5*m6 - 2*force11*m1 - 2*force11*m2 - 2*force14*m1 - 2*force14*m2 - 2*force17*m1 - 2*force17*m2 - m1*m3*u1b*sin(phi1) + 2*m1*m3*u1b*sin(phi2) - m1*m4*u1b*sin(phi1) - 2*m1*m3*u2b*sin(phi2) + 2*m1*m4*u1b*sin(phi2) - m1*m5*u1b*sin(phi1) + m2*m3*u1b*sin(phi2) + m1*m3*u2b*sin(phi3) - 2*m1*m4*u2b*sin(phi2) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) - m2*m3*u2b*sin(phi2) + m2*m4*u1b*sin(phi2) - m1*m3*u3b*sin(phi3) + 2*m1*m4*u2b*sin(phi3) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) + m2*m3*u2b*sin(phi3) - m2*m4*u2b*sin(phi2) + m2*m5*u1b*sin(phi2) - 2*m1*m4*u3b*sin(phi3) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) - m2*m3*u3b*sin(phi3) + 2*m2*m4*u2b*sin(phi3) - m2*m5*u2b*sin(phi2) + m2*m6*u1b*sin(phi2) + m1*m4*u3b*sin(phi4) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) - 2*m2*m4*u3b*sin(phi3) + 2*m2*m5*u2b*sin(phi3) - m2*m6*u2b*sin(phi2) - m1*m4*u4b*sin(phi4) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) + m2*m4*u3b*sin(phi4) - 2*m2*m5*u3b*sin(phi3) + 2*m2*m6*u2b*sin(phi3) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) - m2*m4*u4b*sin(phi4) + 2*m2*m5*u3b*sin(phi4) - 2*m2*m6*u3b*sin(phi3) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) - 2*m2*m5*u4b*sin(phi4) + 2*m2*m6*u3b*sin(phi4) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) + m2*m5*u4b*sin(phi5) - 2*m2*m6*u4b*sin(phi4) - 2*m1*m6*u5b*sin(phi5) - m2*m5*u5b*sin(phi5) + 2*m2*m6*u4b*sin(phi5) + m1*m6*u5b*sin(phi6) - 2*m2*m6*u5b*sin(phi5) + m2*m6*u5b*sin(phi6) + 2*L1*m1*m3*phi1p^2*cos(phi1) + 2*L1*m1*m4*phi1p^2*cos(phi1) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 4*L2*m1*m3*phi2p^2*cos(phi2) + 4*L2*m1*m4*phi2p^2*cos(phi2) + 2*L2*m2*m3*phi2p^2*cos(phi2) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 2*L2*m2*m4*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L2*m2*m5*phi2p^2*cos(phi2) + 2*L3*m1*m3*phi3p^2*cos(phi3) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L3*m1*m4*phi3p^2*cos(phi3) + 2*L3*m2*m3*phi3p^2*cos(phi3) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 4*L3*m2*m4*phi3p^2*cos(phi3) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m2*m5*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 2*L4*m1*m4*phi4p^2*cos(phi4) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 2*L4*m2*m4*phi4p^2*cos(phi4) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m2*m5*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 2*L5*m2*m5*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 2*L6*m2*m6*phi6p^2*cos(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
          -(2*force10*m1 - 2*force1*m5 - 2*force1*m6 - 2*force4*m4 - 2*force4*m5 - 2*force4*m6 - 2*force7*m4 - 2*force1*m4 - 2*force7*m5 + 2*force10*m2 - 2*force7*m6 + 2*force10*m3 + 2*force13*m1 + 2*force13*m2 + 2*force13*m3 + 2*force16*m1 + 2*force16*m2 + 2*force16*m3 + m1*m4*u1b*cos(phi1) - 2*m1*m4*u1b*cos(phi2) + m1*m5*u1b*cos(phi1) + 2*m1*m4*u2b*cos(phi2) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) - m2*m4*u1b*cos(phi2) - 2*m1*m4*u2b*cos(phi3) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) + m2*m4*u2b*cos(phi2) - m2*m5*u1b*cos(phi2) + 2*m1*m4*u3b*cos(phi3) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) - 2*m2*m4*u2b*cos(phi3) + m2*m5*u2b*cos(phi2) - m2*m6*u1b*cos(phi2) - m1*m4*u3b*cos(phi4) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) + 2*m2*m4*u3b*cos(phi3) - 2*m2*m5*u2b*cos(phi3) + m2*m6*u2b*cos(phi2) - m3*m4*u2b*cos(phi3) + m1*m4*u4b*cos(phi4) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) - m2*m4*u3b*cos(phi4) + 2*m2*m5*u3b*cos(phi3) - 2*m2*m6*u2b*cos(phi3) + m3*m4*u3b*cos(phi3) - m3*m5*u2b*cos(phi3) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) + m2*m4*u4b*cos(phi4) - 2*m2*m5*u3b*cos(phi4) + 2*m2*m6*u3b*cos(phi3) - m3*m4*u3b*cos(phi4) + m3*m5*u3b*cos(phi3) - m3*m6*u2b*cos(phi3) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) + 2*m2*m5*u4b*cos(phi4) - 2*m2*m6*u3b*cos(phi4) + m3*m4*u4b*cos(phi4) - 2*m3*m5*u3b*cos(phi4) + m3*m6*u3b*cos(phi3) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) - m2*m5*u4b*cos(phi5) + 2*m2*m6*u4b*cos(phi4) + 2*m3*m5*u4b*cos(phi4) - 2*m3*m6*u3b*cos(phi4) + 2*m1*m6*u5b*cos(phi5) + m2*m5*u5b*cos(phi5) - 2*m2*m6*u4b*cos(phi5) - m3*m5*u4b*cos(phi5) + 2*m3*m6*u4b*cos(phi4) - m1*m6*u5b*cos(phi6) + 2*m2*m6*u5b*cos(phi5) + m3*m5*u5b*cos(phi5) - 2*m3*m6*u4b*cos(phi5) - m2*m6*u5b*cos(phi6) + 2*m3*m6*u5b*cos(phi5) - m3*m6*u5b*cos(phi6) + 2*L1*m1*m4*phi1p^2*sin(phi1) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 4*L2*m1*m4*phi2p^2*sin(phi2) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 2*L2*m2*m4*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L2*m2*m5*phi2p^2*sin(phi2) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L3*m1*m4*phi3p^2*sin(phi3) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 4*L3*m2*m4*phi3p^2*sin(phi3) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m2*m5*phi3p^2*sin(phi3) + 2*L3*m3*m4*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 2*L3*m3*m5*phi3p^2*sin(phi3) + 2*L4*m1*m4*phi4p^2*sin(phi4) + 2*L3*m3*m6*phi3p^2*sin(phi3) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 2*L4*m2*m4*phi4p^2*sin(phi4) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m2*m5*phi4p^2*sin(phi4) + 2*L4*m3*m4*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 4*L4*m3*m5*phi4p^2*sin(phi4) + 4*L4*m3*m6*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 2*L5*m2*m5*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 2*L5*m3*m5*phi5p^2*sin(phi5) + 4*L5*m3*m6*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 2*L6*m2*m6*phi6p^2*sin(phi6) + 2*L6*m3*m6*phi6p^2*sin(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
           (2*force2*m4 + 2*force2*m5 + 2*force2*m6 + 2*force5*m4 + 2*force5*m5 + 2*force5*m6 + 2*force8*m4 - 2*force11*m1 + 2*force8*m5 - 2*force11*m2 + 2*force8*m6 - 2*force11*m3 - 2*force14*m1 - 2*force14*m2 - 2*force14*m3 - 2*force17*m1 - 2*force17*m2 - 2*force17*m3 - m1*m4*u1b*sin(phi1) + 2*m1*m4*u1b*sin(phi2) - m1*m5*u1b*sin(phi1) - 2*m1*m4*u2b*sin(phi2) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) + m2*m4*u1b*sin(phi2) + 2*m1*m4*u2b*sin(phi3) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) - m2*m4*u2b*sin(phi2) + m2*m5*u1b*sin(phi2) - 2*m1*m4*u3b*sin(phi3) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) + 2*m2*m4*u2b*sin(phi3) - m2*m5*u2b*sin(phi2) + m2*m6*u1b*sin(phi2) + m1*m4*u3b*sin(phi4) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) - 2*m2*m4*u3b*sin(phi3) + 2*m2*m5*u2b*sin(phi3) - m2*m6*u2b*sin(phi2) + m3*m4*u2b*sin(phi3) - m1*m4*u4b*sin(phi4) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) + m2*m4*u3b*sin(phi4) - 2*m2*m5*u3b*sin(phi3) + 2*m2*m6*u2b*sin(phi3) - m3*m4*u3b*sin(phi3) + m3*m5*u2b*sin(phi3) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) - m2*m4*u4b*sin(phi4) + 2*m2*m5*u3b*sin(phi4) - 2*m2*m6*u3b*sin(phi3) + m3*m4*u3b*sin(phi4) - m3*m5*u3b*sin(phi3) + m3*m6*u2b*sin(phi3) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) - 2*m2*m5*u4b*sin(phi4) + 2*m2*m6*u3b*sin(phi4) - m3*m4*u4b*sin(phi4) + 2*m3*m5*u3b*sin(phi4) - m3*m6*u3b*sin(phi3) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) + m2*m5*u4b*sin(phi5) - 2*m2*m6*u4b*sin(phi4) - 2*m3*m5*u4b*sin(phi4) + 2*m3*m6*u3b*sin(phi4) - 2*m1*m6*u5b*sin(phi5) - m2*m5*u5b*sin(phi5) + 2*m2*m6*u4b*sin(phi5) + m3*m5*u4b*sin(phi5) - 2*m3*m6*u4b*sin(phi4) + m1*m6*u5b*sin(phi6) - 2*m2*m6*u5b*sin(phi5) - m3*m5*u5b*sin(phi5) + 2*m3*m6*u4b*sin(phi5) + m2*m6*u5b*sin(phi6) - 2*m3*m6*u5b*sin(phi5) + m3*m6*u5b*sin(phi6) + 2*L1*m1*m4*phi1p^2*cos(phi1) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 4*L2*m1*m4*phi2p^2*cos(phi2) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 2*L2*m2*m4*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L2*m2*m5*phi2p^2*cos(phi2) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L3*m1*m4*phi3p^2*cos(phi3) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 4*L3*m2*m4*phi3p^2*cos(phi3) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m2*m5*phi3p^2*cos(phi3) + 2*L3*m3*m4*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 2*L3*m3*m5*phi3p^2*cos(phi3) + 2*L4*m1*m4*phi4p^2*cos(phi4) + 2*L3*m3*m6*phi3p^2*cos(phi3) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 2*L4*m2*m4*phi4p^2*cos(phi4) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m2*m5*phi4p^2*cos(phi4) + 2*L4*m3*m4*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 4*L4*m3*m5*phi4p^2*cos(phi4) + 4*L4*m3*m6*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 2*L5*m2*m5*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 2*L5*m3*m5*phi5p^2*cos(phi5) + 4*L5*m3*m6*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 2*L6*m2*m6*phi6p^2*cos(phi6) + 2*L6*m3*m6*phi6p^2*cos(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
          -(2*force13*m1 - 2*force1*m6 - 2*force4*m5 - 2*force4*m6 - 2*force7*m5 - 2*force7*m6 - 2*force1*m5 - 2*force10*m5 + 2*force13*m2 - 2*force10*m6 + 2*force13*m3 + 2*force13*m4 + 2*force16*m1 + 2*force16*m2 + 2*force16*m3 + 2*force16*m4 + m1*m5*u1b*cos(phi1) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) - m2*m5*u1b*cos(phi2) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) + m2*m5*u2b*cos(phi2) - m2*m6*u1b*cos(phi2) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) - 2*m2*m5*u2b*cos(phi3) + m2*m6*u2b*cos(phi2) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) + 2*m2*m5*u3b*cos(phi3) - 2*m2*m6*u2b*cos(phi3) - m3*m5*u2b*cos(phi3) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) - 2*m2*m5*u3b*cos(phi4) + 2*m2*m6*u3b*cos(phi3) + m3*m5*u3b*cos(phi3) - m3*m6*u2b*cos(phi3) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) + 2*m2*m5*u4b*cos(phi4) - 2*m2*m6*u3b*cos(phi4) - 2*m3*m5*u3b*cos(phi4) + m3*m6*u3b*cos(phi3) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) - m2*m5*u4b*cos(phi5) + 2*m2*m6*u4b*cos(phi4) + 2*m3*m5*u4b*cos(phi4) - 2*m3*m6*u3b*cos(phi4) - m4*m5*u3b*cos(phi4) + 2*m1*m6*u5b*cos(phi5) + m2*m5*u5b*cos(phi5) - 2*m2*m6*u4b*cos(phi5) - m3*m5*u4b*cos(phi5) + 2*m3*m6*u4b*cos(phi4) + m4*m5*u4b*cos(phi4) - m4*m6*u3b*cos(phi4) - m1*m6*u5b*cos(phi6) + 2*m2*m6*u5b*cos(phi5) + m3*m5*u5b*cos(phi5) - 2*m3*m6*u4b*cos(phi5) - m4*m5*u4b*cos(phi5) + m4*m6*u4b*cos(phi4) - m2*m6*u5b*cos(phi6) + 2*m3*m6*u5b*cos(phi5) + m4*m5*u5b*cos(phi5) - 2*m4*m6*u4b*cos(phi5) - m3*m6*u5b*cos(phi6) + 2*m4*m6*u5b*cos(phi5) - m4*m6*u5b*cos(phi6) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L2*m2*m5*phi2p^2*sin(phi2) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m2*m5*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 2*L3*m3*m5*phi3p^2*sin(phi3) + 2*L3*m3*m6*phi3p^2*sin(phi3) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m2*m5*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 4*L4*m3*m5*phi4p^2*sin(phi4) + 4*L4*m3*m6*phi4p^2*sin(phi4) + 2*L4*m4*m5*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 2*L4*m4*m6*phi4p^2*sin(phi4) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 2*L5*m2*m5*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 2*L5*m3*m5*phi5p^2*sin(phi5) + 4*L5*m3*m6*phi5p^2*sin(phi5) + 2*L5*m4*m5*phi5p^2*sin(phi5) + 4*L5*m4*m6*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 2*L6*m2*m6*phi6p^2*sin(phi6) + 2*L6*m3*m6*phi6p^2*sin(phi6) + 2*L6*m4*m6*phi6p^2*sin(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
           (2*force2*m5 + 2*force2*m6 + 2*force5*m5 + 2*force5*m6 + 2*force8*m5 + 2*force8*m6 - 2*force14*m1 + 2*force11*m5 - 2*force14*m2 + 2*force11*m6 - 2*force14*m3 - 2*force14*m4 - 2*force17*m1 - 2*force17*m2 - 2*force17*m3 - 2*force17*m4 - m1*m5*u1b*sin(phi1) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) + m2*m5*u1b*sin(phi2) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) - m2*m5*u2b*sin(phi2) + m2*m6*u1b*sin(phi2) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) + 2*m2*m5*u2b*sin(phi3) - m2*m6*u2b*sin(phi2) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) - 2*m2*m5*u3b*sin(phi3) + 2*m2*m6*u2b*sin(phi3) + m3*m5*u2b*sin(phi3) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) + 2*m2*m5*u3b*sin(phi4) - 2*m2*m6*u3b*sin(phi3) - m3*m5*u3b*sin(phi3) + m3*m6*u2b*sin(phi3) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) - 2*m2*m5*u4b*sin(phi4) + 2*m2*m6*u3b*sin(phi4) + 2*m3*m5*u3b*sin(phi4) - m3*m6*u3b*sin(phi3) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) + m2*m5*u4b*sin(phi5) - 2*m2*m6*u4b*sin(phi4) - 2*m3*m5*u4b*sin(phi4) + 2*m3*m6*u3b*sin(phi4) + m4*m5*u3b*sin(phi4) - 2*m1*m6*u5b*sin(phi5) - m2*m5*u5b*sin(phi5) + 2*m2*m6*u4b*sin(phi5) + m3*m5*u4b*sin(phi5) - 2*m3*m6*u4b*sin(phi4) - m4*m5*u4b*sin(phi4) + m4*m6*u3b*sin(phi4) + m1*m6*u5b*sin(phi6) - 2*m2*m6*u5b*sin(phi5) - m3*m5*u5b*sin(phi5) + 2*m3*m6*u4b*sin(phi5) + m4*m5*u4b*sin(phi5) - m4*m6*u4b*sin(phi4) + m2*m6*u5b*sin(phi6) - 2*m3*m6*u5b*sin(phi5) - m4*m5*u5b*sin(phi5) + 2*m4*m6*u4b*sin(phi5) + m3*m6*u5b*sin(phi6) - 2*m4*m6*u5b*sin(phi5) + m4*m6*u5b*sin(phi6) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L2*m2*m5*phi2p^2*cos(phi2) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m2*m5*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 2*L3*m3*m5*phi3p^2*cos(phi3) + 2*L3*m3*m6*phi3p^2*cos(phi3) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m2*m5*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 4*L4*m3*m5*phi4p^2*cos(phi4) + 4*L4*m3*m6*phi4p^2*cos(phi4) + 2*L4*m4*m5*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 2*L4*m4*m6*phi4p^2*cos(phi4) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 2*L5*m2*m5*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 2*L5*m3*m5*phi5p^2*cos(phi5) + 4*L5*m3*m6*phi5p^2*cos(phi5) + 2*L5*m4*m5*phi5p^2*cos(phi5) + 4*L5*m4*m6*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 2*L6*m2*m6*phi6p^2*cos(phi6) + 2*L6*m3*m6*phi6p^2*cos(phi6) + 2*L6*m4*m6*phi6p^2*cos(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
          -(2*force16*m1 - 2*force4*m6 - 2*force7*m6 - 2*force10*m6 - 2*force1*m6 + 2*force16*m2 - 2*force13*m6 + 2*force16*m3 + 2*force16*m4 + 2*force16*m5 + m1*m6*u1b*cos(phi1) - 2*m1*m6*u1b*cos(phi2) + 2*m1*m6*u2b*cos(phi2) - m2*m6*u1b*cos(phi2) - 2*m1*m6*u2b*cos(phi3) + m2*m6*u2b*cos(phi2) + 2*m1*m6*u3b*cos(phi3) - 2*m2*m6*u2b*cos(phi3) - 2*m1*m6*u3b*cos(phi4) + 2*m2*m6*u3b*cos(phi3) - m3*m6*u2b*cos(phi3) + 2*m1*m6*u4b*cos(phi4) - 2*m2*m6*u3b*cos(phi4) + m3*m6*u3b*cos(phi3) - 2*m1*m6*u4b*cos(phi5) + 2*m2*m6*u4b*cos(phi4) - 2*m3*m6*u3b*cos(phi4) + 2*m1*m6*u5b*cos(phi5) - 2*m2*m6*u4b*cos(phi5) + 2*m3*m6*u4b*cos(phi4) - m4*m6*u3b*cos(phi4) - m1*m6*u5b*cos(phi6) + 2*m2*m6*u5b*cos(phi5) - 2*m3*m6*u4b*cos(phi5) + m4*m6*u4b*cos(phi4) - m2*m6*u5b*cos(phi6) + 2*m3*m6*u5b*cos(phi5) - 2*m4*m6*u4b*cos(phi5) - m3*m6*u5b*cos(phi6) + 2*m4*m6*u5b*cos(phi5) - m5*m6*u4b*cos(phi5) - m4*m6*u5b*cos(phi6) + m5*m6*u5b*cos(phi5) - m5*m6*u5b*cos(phi6) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 2*L3*m3*m6*phi3p^2*sin(phi3) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 4*L4*m3*m6*phi4p^2*sin(phi4) + 2*L4*m4*m6*phi4p^2*sin(phi4) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 4*L5*m3*m6*phi5p^2*sin(phi5) + 4*L5*m4*m6*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 2*L5*m5*m6*phi5p^2*sin(phi5) + 2*L6*m2*m6*phi6p^2*sin(phi6) + 2*L6*m3*m6*phi6p^2*sin(phi6) + 2*L6*m4*m6*phi6p^2*sin(phi6) + 2*L6*m5*m6*phi6p^2*sin(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6));...
           (2*force2*m6 + 2*force5*m6 + 2*force8*m6 + 2*force11*m6 - 2*force17*m1 - 2*force17*m2 + 2*force14*m6 - 2*force17*m3 - 2*force17*m4 - 2*force17*m5 - m1*m6*u1b*sin(phi1) + 2*m1*m6*u1b*sin(phi2) - 2*m1*m6*u2b*sin(phi2) + m2*m6*u1b*sin(phi2) + 2*m1*m6*u2b*sin(phi3) - m2*m6*u2b*sin(phi2) - 2*m1*m6*u3b*sin(phi3) + 2*m2*m6*u2b*sin(phi3) + 2*m1*m6*u3b*sin(phi4) - 2*m2*m6*u3b*sin(phi3) + m3*m6*u2b*sin(phi3) - 2*m1*m6*u4b*sin(phi4) + 2*m2*m6*u3b*sin(phi4) - m3*m6*u3b*sin(phi3) + 2*m1*m6*u4b*sin(phi5) - 2*m2*m6*u4b*sin(phi4) + 2*m3*m6*u3b*sin(phi4) - 2*m1*m6*u5b*sin(phi5) + 2*m2*m6*u4b*sin(phi5) - 2*m3*m6*u4b*sin(phi4) + m4*m6*u3b*sin(phi4) + m1*m6*u5b*sin(phi6) - 2*m2*m6*u5b*sin(phi5) + 2*m3*m6*u4b*sin(phi5) - m4*m6*u4b*sin(phi4) + m2*m6*u5b*sin(phi6) - 2*m3*m6*u5b*sin(phi5) + 2*m4*m6*u4b*sin(phi5) + m3*m6*u5b*sin(phi6) - 2*m4*m6*u5b*sin(phi5) + m5*m6*u4b*sin(phi5) + m4*m6*u5b*sin(phi6) - m5*m6*u5b*sin(phi5) + m5*m6*u5b*sin(phi6) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 2*L3*m3*m6*phi3p^2*cos(phi3) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 4*L4*m3*m6*phi4p^2*cos(phi4) + 2*L4*m4*m6*phi4p^2*cos(phi4) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 4*L5*m3*m6*phi5p^2*cos(phi5) + 4*L5*m4*m6*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 2*L5*m5*m6*phi5p^2*cos(phi5) + 2*L6*m2*m6*phi6p^2*cos(phi6) + 2*L6*m3*m6*phi6p^2*cos(phi6) + 2*L6*m4*m6*phi6p^2*cos(phi6) + 2*L6*m5*m6*phi6p^2*cos(phi6))/(2*(m1 + m2 + m3 + m4 + m5 + m6))];

Lambda = subs(Lambda, [sin(phi1),sin(phi2),sin(phi3),sin(phi4),sin(phi5),sin(phi6)], [phi1,phi2,phi3,phi4,phi5,phi6]);
Lambda = subs(Lambda, [cos(phi1),cos(phi2),cos(phi3),cos(phi4),cos(phi5),cos(phi6)], [1,1,1,1,1,1]);
Lambda

%% U VECTOR

Ui = [(2*(I2*force3 + I3*force3 - I1*force6 + I4*force3 + I5*force3 + I6*force3 - I1*force9 - I1*force12 - I1*force15 - I1*force18 + I1*lambda1*cos(phi2) - I2*lambda1*cos(phi1) - I3*lambda1*cos(phi1) + I1*lambda3*cos(phi2) - I4*lambda1*cos(phi1) + I1*lambda3*cos(phi3) - I5*lambda1*cos(phi1) - I6*lambda1*cos(phi1) + I1*lambda5*cos(phi3) + I1*lambda5*cos(phi4) + I1*lambda7*cos(phi4) + I1*lambda7*cos(phi5) + I1*lambda9*cos(phi5) + I1*lambda9*cos(phi6) + I1*lambda2*sin(phi2) - I2*lambda2*sin(phi1) - I3*lambda2*sin(phi1) + I1*lambda4*sin(phi2) - I4*lambda2*sin(phi1) + I1*lambda4*sin(phi3) - I5*lambda2*sin(phi1) - I6*lambda2*sin(phi1) + I1*lambda6*sin(phi3) + I1*lambda6*sin(phi4) + I1*lambda8*sin(phi4) + I1*lambda8*sin(phi5) + I1*lambda10*sin(phi5) + I1*lambda10*sin(phi6)))/(I1 + I2 + I3 + I4 + I5 + I6);...
              (2*(I3*force3 + I4*force3 + I5*force3 + I3*force6 + I6*force3 - I1*force9 + I4*force6 - I2*force9 + I5*force6 + I6*force6 - I1*force12 - I2*force12 - I1*force15 - I2*force15 - I1*force18 - I2*force18 - I3*lambda1*cos(phi1) - I3*lambda1*cos(phi2) - I4*lambda1*cos(phi1) + I1*lambda3*cos(phi3) - I4*lambda1*cos(phi2) - I5*lambda1*cos(phi1) + I2*lambda3*cos(phi3) - I3*lambda3*cos(phi2) - I5*lambda1*cos(phi2) - I6*lambda1*cos(phi1) + I1*lambda5*cos(phi3) - I4*lambda3*cos(phi2) - I6*lambda1*cos(phi2) + I1*lambda5*cos(phi4) + I2*lambda5*cos(phi3) - I5*lambda3*cos(phi2) + I2*lambda5*cos(phi4) - I6*lambda3*cos(phi2) + I1*lambda7*cos(phi4) + I1*lambda7*cos(phi5) + I2*lambda7*cos(phi4) + I2*lambda7*cos(phi5) + I1*lambda9*cos(phi5) + I1*lambda9*cos(phi6) + I2*lambda9*cos(phi5) + I2*lambda9*cos(phi6) - I3*lambda2*sin(phi1) - I3*lambda2*sin(phi2) - I4*lambda2*sin(phi1) + I1*lambda4*sin(phi3) - I4*lambda2*sin(phi2) - I5*lambda2*sin(phi1) + I2*lambda4*sin(phi3) - I3*lambda4*sin(phi2) - I5*lambda2*sin(phi2) - I6*lambda2*sin(phi1) + I1*lambda6*sin(phi3) - I4*lambda4*sin(phi2) - I6*lambda2*sin(phi2) + I1*lambda6*sin(phi4) + I2*lambda6*sin(phi3) - I5*lambda4*sin(phi2) + I2*lambda6*sin(phi4) - I6*lambda4*sin(phi2) + I1*lambda8*sin(phi4) + I1*lambda8*sin(phi5) + I2*lambda8*sin(phi4) + I2*lambda8*sin(phi5) + I1*lambda10*sin(phi5) + I1*lambda10*sin(phi6) + I2*lambda10*sin(phi5) + I2*lambda10*sin(phi6)))/(I1 + I2 + I3 + I4 + I5 + I6);...
              (2*(I4*force3 + I5*force3 + I6*force3 + I4*force6 + I5*force6 + I6*force6 - I1*force12 + I4*force9 - I2*force12 + I5*force9 - I3*force12 + I6*force9 - I1*force15 - I2*force15 - I3*force15 - I1*force18 - I2*force18 - I3*force18 - I4*lambda1*cos(phi1) - I4*lambda1*cos(phi2) - I5*lambda1*cos(phi1) - I5*lambda1*cos(phi2) - I6*lambda1*cos(phi1) - I4*lambda3*cos(phi2) - I6*lambda1*cos(phi2) + I1*lambda5*cos(phi4) - I4*lambda3*cos(phi3) - I5*lambda3*cos(phi2) + I2*lambda5*cos(phi4) - I5*lambda3*cos(phi3) - I6*lambda3*cos(phi2) + I1*lambda7*cos(phi4) + I3*lambda5*cos(phi4) - I4*lambda5*cos(phi3) - I6*lambda3*cos(phi3) + I1*lambda7*cos(phi5) + I2*lambda7*cos(phi4) - I5*lambda5*cos(phi3) + I2*lambda7*cos(phi5) + I3*lambda7*cos(phi4) - I6*lambda5*cos(phi3) + I1*lambda9*cos(phi5) + I3*lambda7*cos(phi5) + I1*lambda9*cos(phi6) + I2*lambda9*cos(phi5) + I2*lambda9*cos(phi6) + I3*lambda9*cos(phi5) + I3*lambda9*cos(phi6) - I4*lambda2*sin(phi1) - I4*lambda2*sin(phi2) - I5*lambda2*sin(phi1) - I5*lambda2*sin(phi2) - I6*lambda2*sin(phi1) - I4*lambda4*sin(phi2) - I6*lambda2*sin(phi2) + I1*lambda6*sin(phi4) - I4*lambda4*sin(phi3) - I5*lambda4*sin(phi2) + I2*lambda6*sin(phi4) - I5*lambda4*sin(phi3) - I6*lambda4*sin(phi2) + I1*lambda8*sin(phi4) + I3*lambda6*sin(phi4) - I4*lambda6*sin(phi3) - I6*lambda4*sin(phi3) + I1*lambda8*sin(phi5) + I2*lambda8*sin(phi4) - I5*lambda6*sin(phi3) + I2*lambda8*sin(phi5) + I3*lambda8*sin(phi4) - I6*lambda6*sin(phi3) + I1*lambda10*sin(phi5) + I3*lambda8*sin(phi5) + I1*lambda10*sin(phi6) + I2*lambda10*sin(phi5) + I2*lambda10*sin(phi6) + I3*lambda10*sin(phi5) + I3*lambda10*sin(phi6)))/(I1 + I2 + I3 + I4 + I5 + I6);...
             -(2*(I1*force15 - I6*force3 - I5*force6 - I6*force6 - I5*force9 - I6*force9 - I5*force3 + I2*force15 - I5*force12 + I3*force15 - I6*force12 + I1*force18 + I4*force15 + I2*force18 + I3*force18 + I4*force18 + I5*lambda1*cos(phi1) + I5*lambda1*cos(phi2) + I6*lambda1*cos(phi1) + I6*lambda1*cos(phi2) + I5*lambda3*cos(phi2) + I5*lambda3*cos(phi3) + I6*lambda3*cos(phi2) + I6*lambda3*cos(phi3) - I1*lambda7*cos(phi5) + I5*lambda5*cos(phi3) - I2*lambda7*cos(phi5) + I5*lambda5*cos(phi4) + I6*lambda5*cos(phi3) - I1*lambda9*cos(phi5) - I3*lambda7*cos(phi5) + I6*lambda5*cos(phi4) - I1*lambda9*cos(phi6) - I2*lambda9*cos(phi5) - I4*lambda7*cos(phi5) + I5*lambda7*cos(phi4) - I2*lambda9*cos(phi6) - I3*lambda9*cos(phi5) + I6*lambda7*cos(phi4) - I3*lambda9*cos(phi6) - I4*lambda9*cos(phi5) - I4*lambda9*cos(phi6) + I5*lambda2*sin(phi1) + I5*lambda2*sin(phi2) + I6*lambda2*sin(phi1) + I6*lambda2*sin(phi2) + I5*lambda4*sin(phi2) + I5*lambda4*sin(phi3) + I6*lambda4*sin(phi2) + I6*lambda4*sin(phi3) - I1*lambda8*sin(phi5) + I5*lambda6*sin(phi3) - I2*lambda8*sin(phi5) + I5*lambda6*sin(phi4) + I6*lambda6*sin(phi3) - I1*lambda10*sin(phi5) - I3*lambda8*sin(phi5) + I6*lambda6*sin(phi4) - I1*lambda10*sin(phi6) - I2*lambda10*sin(phi5) - I4*lambda8*sin(phi5) + I5*lambda8*sin(phi4) - I2*lambda10*sin(phi6) - I3*lambda10*sin(phi5) + I6*lambda8*sin(phi4) - I3*lambda10*sin(phi6) - I4*lambda10*sin(phi5) - I4*lambda10*sin(phi6)))/(I1 + I2 + I3 + I4 + I5 + I6);...
             -(2*(I1*force18 - I6*force6 - I6*force9 - I6*force12 - I6*force3 + I2*force18 + I3*force18 - I6*force15 + I4*force18 + I5*force18 + I6*lambda1*cos(phi1) + I6*lambda1*cos(phi2) + I6*lambda3*cos(phi2) + I6*lambda3*cos(phi3) + I6*lambda5*cos(phi3) + I6*lambda5*cos(phi4) - I1*lambda9*cos(phi6) - I2*lambda9*cos(phi6) + I6*lambda7*cos(phi4) - I3*lambda9*cos(phi6) + I6*lambda7*cos(phi5) - I4*lambda9*cos(phi6) - I5*lambda9*cos(phi6) + I6*lambda9*cos(phi5) + I6*lambda2*sin(phi1) + I6*lambda2*sin(phi2) + I6*lambda4*sin(phi2) + I6*lambda4*sin(phi3) + I6*lambda6*sin(phi3) + I6*lambda6*sin(phi4) - I1*lambda10*sin(phi6) - I2*lambda10*sin(phi6) + I6*lambda8*sin(phi4) - I3*lambda10*sin(phi6) + I6*lambda8*sin(phi5) - I4*lambda10*sin(phi6) - I5*lambda10*sin(phi6) + I6*lambda10*sin(phi5)))/(I1 + I2 + I3 + I4 + I5 + I6)];

Ui = subs(Ui, [sin(phi1),sin(phi2),sin(phi3),sin(phi4),sin(phi5),sin(phi6)], [phi1,phi2,phi3,phi4,phi5,phi6]);
Ui = subs(Ui, [cos(phi1),cos(phi2),cos(phi3),cos(phi4),cos(phi5),cos(phi6)], [1,1,1,1,1,1]);
Ui

