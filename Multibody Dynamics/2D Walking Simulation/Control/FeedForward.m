% Sets Control Input
% (The Lambda and Ui vectors are given by the Symbolics function,
%  in the Symbolics folder)

function Ui = FeedForward(Yn,n,m,M,LVec,Fpass,Ub,Go,SmallAngle)
%% Model Parameters

% Length Definitions
L1 = LVec(1);
L2 = LVec(2);
L3 = LVec(3);
L4 = LVec(4);
L5 = LVec(5);
L6 = LVec(6);
L7 = LVec(7);
L8 = LVec(8);

% Mass and Inertia Definitions
m1 = M(1,1);
m2 = M(4,4);
m3 = M(7,7);
m4 = M(10,10);
m5 = M(13,13);
m6 = M(16,16);
m7 = M(19,19);
m8 = M(22,22);
I1 = M(3,3);
I2 = M(6,6);
I3 = M(9,9);
I4 = M(12,12);
I5 = M(15,15);
I6 = M(18,18);
I7 = M(21,21);
I8 = M(24,24);

% Coordinates
nb = n/3;             % Number of bodies
q = Yn((n+m+1):end);  % Position
qp = Yn(1:n);         % Velocity

% Position Definitions
phi1 = q(3);
phi2 = q(6);
phi3 = q(9);
phi4 = q(12);
phi5 = q(15);
phi6 = q(18);
phi7 = q(21);
phi8 = q(24);

% Velocity Definitions
phi1p = qp(3);
phi2p = qp(6);
phi3p = qp(9);
phi4p = qp(12);
phi5p = qp(15);
phi6p = qp(18);
phi7p = qp(21);
phi8p = qp(24);

% Components of force vector
force1 = Fpass(1);
force2 = Fpass(2);
force3 = Fpass(3);
force4 = Fpass(4);
force5 = Fpass(5);
force6 = Fpass(6);
force7 = Fpass(7);
force8 = Fpass(8);
force9 = Fpass(9);
force10 = Fpass(10);
force11 = Fpass(11);
force12 = Fpass(12);
force13 = Fpass(13);
force14 = Fpass(14);
force15 = Fpass(15);
force16 = Fpass(16);
force17 = Fpass(17);
force18 = Fpass(18);
force19 = Fpass(19);
force20 = Fpass(20);
force21 = Fpass(21);
force22 = Fpass(22);
force23 = Fpass(23);
force24 = Fpass(24);

%% Controller

% PD Control Inputs
u1b = Ub(1);
u2b = Ub(2);
u3b = Ub(3);
u4b = Ub(4);
u5b = Ub(5);
u6b = Ub(6);
u7b = Ub(7);

% Lambda Vector (Lagrange multipliers)
if SmallAngle == 0  % Use full feedforward control
    Lambda = [-(2*force4*m1 - 2*force1*m3 - 2*force1*m4 - 2*force1*m2 - 2*force1*m5 - 2*force1*m6 - 2*force1*m7 + 2*force7*m1 - 2*force1*m8 + 2*force10*m1 + 2*force13*m1 + 2*force16*m1 + 2*force19*m1 + 2*force22*m1 + m1*m2*u1b*cos(phi1) - m1*m2*u1b*cos(phi2) + m1*m3*u1b*cos(phi1) + m1*m2*u2b*cos(phi2) - 2*m1*m3*u1b*cos(phi2) + m1*m4*u1b*cos(phi1) + 2*m1*m3*u2b*cos(phi2) - 2*m1*m4*u1b*cos(phi2) + m1*m5*u1b*cos(phi1) - m1*m3*u2b*cos(phi3) + 2*m1*m4*u2b*cos(phi2) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) + m1*m3*u3b*cos(phi3) - 2*m1*m4*u2b*cos(phi3) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) + m1*m7*u1b*cos(phi1) + 2*m1*m4*u3b*cos(phi3) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) - 2*m1*m7*u1b*cos(phi2) + m1*m8*u1b*cos(phi1) - m1*m4*u3b*cos(phi4) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) + 2*m1*m7*u2b*cos(phi2) - 2*m1*m8*u1b*cos(phi2) + m1*m4*u4b*cos(phi4) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) - 2*m1*m7*u2b*cos(phi3) + 2*m1*m8*u2b*cos(phi2) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) + 2*m1*m7*u3b*cos(phi3) - 2*m1*m8*u2b*cos(phi3) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) - 2*m1*m7*u3b*cos(phi4) + 2*m1*m8*u3b*cos(phi3) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) + 2*m1*m7*u4b*cos(phi4) - 2*m1*m8*u3b*cos(phi4) + 2*m1*m6*u5b*cos(phi5) - 2*m1*m7*u4b*cos(phi5) + 2*m1*m8*u4b*cos(phi4) - m1*m6*u5b*cos(phi6) + 2*m1*m7*u5b*cos(phi5) - 2*m1*m8*u4b*cos(phi5) + m1*m6*u6b*cos(phi6) - 2*m1*m7*u5b*cos(phi6) + 2*m1*m8*u5b*cos(phi5) + 2*m1*m7*u6b*cos(phi6) - 2*m1*m8*u5b*cos(phi6) - m1*m7*u6b*cos(phi7) + 2*m1*m8*u6b*cos(phi6) + m1*m7*u7b*cos(phi7) - 2*m1*m8*u6b*cos(phi7) + 2*m1*m8*u7b*cos(phi7) - m1*m8*u7b*cos(phi8) + 2*L1*m1*m2*phi1p^2*sin(phi1) + 2*L1*m1*m3*phi1p^2*sin(phi1) + 2*L1*m1*m4*phi1p^2*sin(phi1) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L2*m1*m2*phi2p^2*sin(phi2) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 4*L2*m1*m3*phi2p^2*sin(phi2) + 2*L1*m1*m7*phi1p^2*sin(phi1) + 4*L2*m1*m4*phi2p^2*sin(phi2) + 2*L1*m1*m8*phi1p^2*sin(phi1) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L3*m1*m3*phi3p^2*sin(phi3) + 4*L2*m1*m7*phi2p^2*sin(phi2) + 4*L3*m1*m4*phi3p^2*sin(phi3) + 4*L2*m1*m8*phi2p^2*sin(phi2) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m1*m7*phi3p^2*sin(phi3) + 2*L4*m1*m4*phi4p^2*sin(phi4) + 4*L3*m1*m8*phi3p^2*sin(phi3) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m1*m7*phi4p^2*sin(phi4) + 4*L4*m1*m8*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 4*L5*m1*m7*phi5p^2*sin(phi5) + 4*L5*m1*m8*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 4*L6*m1*m7*phi6p^2*sin(phi6) + 4*L6*m1*m8*phi6p^2*sin(phi6) + 2*L7*m1*m7*phi7p^2*sin(phi7) + 4*L7*m1*m8*phi7p^2*sin(phi7) + 2*L8*m1*m8*phi8p^2*sin(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
               (2*force2*m2 + 2*force2*m3 + 2*force2*m4 - 2*force5*m1 + 2*force2*m5 + 2*force2*m6 + 2*force2*m7 - 2*force8*m1 + 2*force2*m8 - 2*force11*m1 - 2*force14*m1 - 2*force17*m1 - 2*force20*m1 - 2*force23*m1 - m1*m2*u1b*sin(phi1) + m1*m2*u1b*sin(phi2) - m1*m3*u1b*sin(phi1) - m1*m2*u2b*sin(phi2) + 2*m1*m3*u1b*sin(phi2) - m1*m4*u1b*sin(phi1) - 2*m1*m3*u2b*sin(phi2) + 2*m1*m4*u1b*sin(phi2) - m1*m5*u1b*sin(phi1) + m1*m3*u2b*sin(phi3) - 2*m1*m4*u2b*sin(phi2) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) - m1*m3*u3b*sin(phi3) + 2*m1*m4*u2b*sin(phi3) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) - m1*m7*u1b*sin(phi1) - 2*m1*m4*u3b*sin(phi3) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) + 2*m1*m7*u1b*sin(phi2) - m1*m8*u1b*sin(phi1) + m1*m4*u3b*sin(phi4) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) - 2*m1*m7*u2b*sin(phi2) + 2*m1*m8*u1b*sin(phi2) - m1*m4*u4b*sin(phi4) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) + 2*m1*m7*u2b*sin(phi3) - 2*m1*m8*u2b*sin(phi2) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) - 2*m1*m7*u3b*sin(phi3) + 2*m1*m8*u2b*sin(phi3) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) + 2*m1*m7*u3b*sin(phi4) - 2*m1*m8*u3b*sin(phi3) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) - 2*m1*m7*u4b*sin(phi4) + 2*m1*m8*u3b*sin(phi4) - 2*m1*m6*u5b*sin(phi5) + 2*m1*m7*u4b*sin(phi5) - 2*m1*m8*u4b*sin(phi4) + m1*m6*u5b*sin(phi6) - 2*m1*m7*u5b*sin(phi5) + 2*m1*m8*u4b*sin(phi5) - m1*m6*u6b*sin(phi6) + 2*m1*m7*u5b*sin(phi6) - 2*m1*m8*u5b*sin(phi5) - 2*m1*m7*u6b*sin(phi6) + 2*m1*m8*u5b*sin(phi6) + m1*m7*u6b*sin(phi7) - 2*m1*m8*u6b*sin(phi6) - m1*m7*u7b*sin(phi7) + 2*m1*m8*u6b*sin(phi7) - 2*m1*m8*u7b*sin(phi7) + m1*m8*u7b*sin(phi8) + 2*L1*m1*m2*phi1p^2*cos(phi1) + 2*L1*m1*m3*phi1p^2*cos(phi1) + 2*L1*m1*m4*phi1p^2*cos(phi1) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L2*m1*m2*phi2p^2*cos(phi2) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 4*L2*m1*m3*phi2p^2*cos(phi2) + 2*L1*m1*m7*phi1p^2*cos(phi1) + 4*L2*m1*m4*phi2p^2*cos(phi2) + 2*L1*m1*m8*phi1p^2*cos(phi1) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L3*m1*m3*phi3p^2*cos(phi3) + 4*L2*m1*m7*phi2p^2*cos(phi2) + 4*L3*m1*m4*phi3p^2*cos(phi3) + 4*L2*m1*m8*phi2p^2*cos(phi2) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m1*m7*phi3p^2*cos(phi3) + 2*L4*m1*m4*phi4p^2*cos(phi4) + 4*L3*m1*m8*phi3p^2*cos(phi3) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m1*m7*phi4p^2*cos(phi4) + 4*L4*m1*m8*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 4*L5*m1*m7*phi5p^2*cos(phi5) + 4*L5*m1*m8*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 4*L6*m1*m7*phi6p^2*cos(phi6) + 4*L6*m1*m8*phi6p^2*cos(phi6) + 2*L7*m1*m7*phi7p^2*cos(phi7) + 4*L7*m1*m8*phi7p^2*cos(phi7) + 2*L8*m1*m8*phi8p^2*cos(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
              -(2*force7*m1 - 2*force1*m4 - 2*force1*m5 - 2*force1*m6 - 2*force4*m3 - 2*force1*m7 - 2*force4*m4 - 2*force1*m3 - 2*force1*m8 - 2*force4*m5 + 2*force7*m2 - 2*force4*m6 - 2*force4*m7 + 2*force10*m1 - 2*force4*m8 + 2*force10*m2 + 2*force13*m1 + 2*force13*m2 + 2*force16*m1 + 2*force16*m2 + 2*force19*m1 + 2*force19*m2 + 2*force22*m1 + 2*force22*m2 + m1*m3*u1b*cos(phi1) - 2*m1*m3*u1b*cos(phi2) + m1*m4*u1b*cos(phi1) + 2*m1*m3*u2b*cos(phi2) - 2*m1*m4*u1b*cos(phi2) + m1*m5*u1b*cos(phi1) - m2*m3*u1b*cos(phi2) - m1*m3*u2b*cos(phi3) + 2*m1*m4*u2b*cos(phi2) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) + m2*m3*u2b*cos(phi2) - m2*m4*u1b*cos(phi2) + m1*m3*u3b*cos(phi3) - 2*m1*m4*u2b*cos(phi3) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) + m1*m7*u1b*cos(phi1) - m2*m3*u2b*cos(phi3) + m2*m4*u2b*cos(phi2) - m2*m5*u1b*cos(phi2) + 2*m1*m4*u3b*cos(phi3) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) - 2*m1*m7*u1b*cos(phi2) + m1*m8*u1b*cos(phi1) + m2*m3*u3b*cos(phi3) - 2*m2*m4*u2b*cos(phi3) + m2*m5*u2b*cos(phi2) - m2*m6*u1b*cos(phi2) - m1*m4*u3b*cos(phi4) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) + 2*m1*m7*u2b*cos(phi2) - 2*m1*m8*u1b*cos(phi2) + 2*m2*m4*u3b*cos(phi3) - 2*m2*m5*u2b*cos(phi3) + m2*m6*u2b*cos(phi2) - m2*m7*u1b*cos(phi2) + m1*m4*u4b*cos(phi4) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) - 2*m1*m7*u2b*cos(phi3) + 2*m1*m8*u2b*cos(phi2) - m2*m4*u3b*cos(phi4) + 2*m2*m5*u3b*cos(phi3) - 2*m2*m6*u2b*cos(phi3) + m2*m7*u2b*cos(phi2) - m2*m8*u1b*cos(phi2) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) + 2*m1*m7*u3b*cos(phi3) - 2*m1*m8*u2b*cos(phi3) + m2*m4*u4b*cos(phi4) - 2*m2*m5*u3b*cos(phi4) + 2*m2*m6*u3b*cos(phi3) - 2*m2*m7*u2b*cos(phi3) + m2*m8*u2b*cos(phi2) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) - 2*m1*m7*u3b*cos(phi4) + 2*m1*m8*u3b*cos(phi3) + 2*m2*m5*u4b*cos(phi4) - 2*m2*m6*u3b*cos(phi4) + 2*m2*m7*u3b*cos(phi3) - 2*m2*m8*u2b*cos(phi3) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) + 2*m1*m7*u4b*cos(phi4) - 2*m1*m8*u3b*cos(phi4) - m2*m5*u4b*cos(phi5) + 2*m2*m6*u4b*cos(phi4) - 2*m2*m7*u3b*cos(phi4) + 2*m2*m8*u3b*cos(phi3) + 2*m1*m6*u5b*cos(phi5) - 2*m1*m7*u4b*cos(phi5) + 2*m1*m8*u4b*cos(phi4) + m2*m5*u5b*cos(phi5) - 2*m2*m6*u4b*cos(phi5) + 2*m2*m7*u4b*cos(phi4) - 2*m2*m8*u3b*cos(phi4) - m1*m6*u5b*cos(phi6) + 2*m1*m7*u5b*cos(phi5) - 2*m1*m8*u4b*cos(phi5) + 2*m2*m6*u5b*cos(phi5) - 2*m2*m7*u4b*cos(phi5) + 2*m2*m8*u4b*cos(phi4) + m1*m6*u6b*cos(phi6) - 2*m1*m7*u5b*cos(phi6) + 2*m1*m8*u5b*cos(phi5) - m2*m6*u5b*cos(phi6) + 2*m2*m7*u5b*cos(phi5) - 2*m2*m8*u4b*cos(phi5) + 2*m1*m7*u6b*cos(phi6) - 2*m1*m8*u5b*cos(phi6) + m2*m6*u6b*cos(phi6) - 2*m2*m7*u5b*cos(phi6) + 2*m2*m8*u5b*cos(phi5) - m1*m7*u6b*cos(phi7) + 2*m1*m8*u6b*cos(phi6) + 2*m2*m7*u6b*cos(phi6) - 2*m2*m8*u5b*cos(phi6) + m1*m7*u7b*cos(phi7) - 2*m1*m8*u6b*cos(phi7) - m2*m7*u6b*cos(phi7) + 2*m2*m8*u6b*cos(phi6) + 2*m1*m8*u7b*cos(phi7) + m2*m7*u7b*cos(phi7) - 2*m2*m8*u6b*cos(phi7) - m1*m8*u7b*cos(phi8) + 2*m2*m8*u7b*cos(phi7) - m2*m8*u7b*cos(phi8) + 2*L1*m1*m3*phi1p^2*sin(phi1) + 2*L1*m1*m4*phi1p^2*sin(phi1) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 4*L2*m1*m3*phi2p^2*sin(phi2) + 2*L1*m1*m7*phi1p^2*sin(phi1) + 4*L2*m1*m4*phi2p^2*sin(phi2) + 2*L2*m2*m3*phi2p^2*sin(phi2) + 2*L1*m1*m8*phi1p^2*sin(phi1) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 2*L2*m2*m4*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L2*m2*m5*phi2p^2*sin(phi2) + 2*L3*m1*m3*phi3p^2*sin(phi3) + 4*L2*m1*m7*phi2p^2*sin(phi2) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L3*m1*m4*phi3p^2*sin(phi3) + 2*L3*m2*m3*phi3p^2*sin(phi3) + 4*L2*m1*m8*phi2p^2*sin(phi2) + 2*L2*m2*m7*phi2p^2*sin(phi2) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 4*L3*m2*m4*phi3p^2*sin(phi3) + 2*L2*m2*m8*phi2p^2*sin(phi2) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m2*m5*phi3p^2*sin(phi3) + 4*L3*m1*m7*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 2*L4*m1*m4*phi4p^2*sin(phi4) + 4*L3*m1*m8*phi3p^2*sin(phi3) + 4*L3*m2*m7*phi3p^2*sin(phi3) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 2*L4*m2*m4*phi4p^2*sin(phi4) + 4*L3*m2*m8*phi3p^2*sin(phi3) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m2*m5*phi4p^2*sin(phi4) + 4*L4*m1*m7*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 4*L4*m1*m8*phi4p^2*sin(phi4) + 4*L4*m2*m7*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 4*L4*m2*m8*phi4p^2*sin(phi4) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 2*L5*m2*m5*phi5p^2*sin(phi5) + 4*L5*m1*m7*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 4*L5*m1*m8*phi5p^2*sin(phi5) + 4*L5*m2*m7*phi5p^2*sin(phi5) + 4*L5*m2*m8*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 4*L6*m1*m7*phi6p^2*sin(phi6) + 2*L6*m2*m6*phi6p^2*sin(phi6) + 4*L6*m1*m8*phi6p^2*sin(phi6) + 4*L6*m2*m7*phi6p^2*sin(phi6) + 4*L6*m2*m8*phi6p^2*sin(phi6) + 2*L7*m1*m7*phi7p^2*sin(phi7) + 4*L7*m1*m8*phi7p^2*sin(phi7) + 2*L7*m2*m7*phi7p^2*sin(phi7) + 4*L7*m2*m8*phi7p^2*sin(phi7) + 2*L8*m1*m8*phi8p^2*sin(phi8) + 2*L8*m2*m8*phi8p^2*sin(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
               (2*force2*m3 + 2*force2*m4 + 2*force2*m5 + 2*force2*m6 + 2*force5*m3 + 2*force2*m7 + 2*force5*m4 - 2*force8*m1 + 2*force2*m8 + 2*force5*m5 - 2*force8*m2 + 2*force5*m6 + 2*force5*m7 - 2*force11*m1 + 2*force5*m8 - 2*force11*m2 - 2*force14*m1 - 2*force14*m2 - 2*force17*m1 - 2*force17*m2 - 2*force20*m1 - 2*force20*m2 - 2*force23*m1 - 2*force23*m2 - m1*m3*u1b*sin(phi1) + 2*m1*m3*u1b*sin(phi2) - m1*m4*u1b*sin(phi1) - 2*m1*m3*u2b*sin(phi2) + 2*m1*m4*u1b*sin(phi2) - m1*m5*u1b*sin(phi1) + m2*m3*u1b*sin(phi2) + m1*m3*u2b*sin(phi3) - 2*m1*m4*u2b*sin(phi2) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) - m2*m3*u2b*sin(phi2) + m2*m4*u1b*sin(phi2) - m1*m3*u3b*sin(phi3) + 2*m1*m4*u2b*sin(phi3) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) - m1*m7*u1b*sin(phi1) + m2*m3*u2b*sin(phi3) - m2*m4*u2b*sin(phi2) + m2*m5*u1b*sin(phi2) - 2*m1*m4*u3b*sin(phi3) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) + 2*m1*m7*u1b*sin(phi2) - m1*m8*u1b*sin(phi1) - m2*m3*u3b*sin(phi3) + 2*m2*m4*u2b*sin(phi3) - m2*m5*u2b*sin(phi2) + m2*m6*u1b*sin(phi2) + m1*m4*u3b*sin(phi4) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) - 2*m1*m7*u2b*sin(phi2) + 2*m1*m8*u1b*sin(phi2) - 2*m2*m4*u3b*sin(phi3) + 2*m2*m5*u2b*sin(phi3) - m2*m6*u2b*sin(phi2) + m2*m7*u1b*sin(phi2) - m1*m4*u4b*sin(phi4) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) + 2*m1*m7*u2b*sin(phi3) - 2*m1*m8*u2b*sin(phi2) + m2*m4*u3b*sin(phi4) - 2*m2*m5*u3b*sin(phi3) + 2*m2*m6*u2b*sin(phi3) - m2*m7*u2b*sin(phi2) + m2*m8*u1b*sin(phi2) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) - 2*m1*m7*u3b*sin(phi3) + 2*m1*m8*u2b*sin(phi3) - m2*m4*u4b*sin(phi4) + 2*m2*m5*u3b*sin(phi4) - 2*m2*m6*u3b*sin(phi3) + 2*m2*m7*u2b*sin(phi3) - m2*m8*u2b*sin(phi2) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) + 2*m1*m7*u3b*sin(phi4) - 2*m1*m8*u3b*sin(phi3) - 2*m2*m5*u4b*sin(phi4) + 2*m2*m6*u3b*sin(phi4) - 2*m2*m7*u3b*sin(phi3) + 2*m2*m8*u2b*sin(phi3) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) - 2*m1*m7*u4b*sin(phi4) + 2*m1*m8*u3b*sin(phi4) + m2*m5*u4b*sin(phi5) - 2*m2*m6*u4b*sin(phi4) + 2*m2*m7*u3b*sin(phi4) - 2*m2*m8*u3b*sin(phi3) - 2*m1*m6*u5b*sin(phi5) + 2*m1*m7*u4b*sin(phi5) - 2*m1*m8*u4b*sin(phi4) - m2*m5*u5b*sin(phi5) + 2*m2*m6*u4b*sin(phi5) - 2*m2*m7*u4b*sin(phi4) + 2*m2*m8*u3b*sin(phi4) + m1*m6*u5b*sin(phi6) - 2*m1*m7*u5b*sin(phi5) + 2*m1*m8*u4b*sin(phi5) - 2*m2*m6*u5b*sin(phi5) + 2*m2*m7*u4b*sin(phi5) - 2*m2*m8*u4b*sin(phi4) - m1*m6*u6b*sin(phi6) + 2*m1*m7*u5b*sin(phi6) - 2*m1*m8*u5b*sin(phi5) + m2*m6*u5b*sin(phi6) - 2*m2*m7*u5b*sin(phi5) + 2*m2*m8*u4b*sin(phi5) - 2*m1*m7*u6b*sin(phi6) + 2*m1*m8*u5b*sin(phi6) - m2*m6*u6b*sin(phi6) + 2*m2*m7*u5b*sin(phi6) - 2*m2*m8*u5b*sin(phi5) + m1*m7*u6b*sin(phi7) - 2*m1*m8*u6b*sin(phi6) - 2*m2*m7*u6b*sin(phi6) + 2*m2*m8*u5b*sin(phi6) - m1*m7*u7b*sin(phi7) + 2*m1*m8*u6b*sin(phi7) + m2*m7*u6b*sin(phi7) - 2*m2*m8*u6b*sin(phi6) - 2*m1*m8*u7b*sin(phi7) - m2*m7*u7b*sin(phi7) + 2*m2*m8*u6b*sin(phi7) + m1*m8*u7b*sin(phi8) - 2*m2*m8*u7b*sin(phi7) + m2*m8*u7b*sin(phi8) + 2*L1*m1*m3*phi1p^2*cos(phi1) + 2*L1*m1*m4*phi1p^2*cos(phi1) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 4*L2*m1*m3*phi2p^2*cos(phi2) + 2*L1*m1*m7*phi1p^2*cos(phi1) + 4*L2*m1*m4*phi2p^2*cos(phi2) + 2*L2*m2*m3*phi2p^2*cos(phi2) + 2*L1*m1*m8*phi1p^2*cos(phi1) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 2*L2*m2*m4*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L2*m2*m5*phi2p^2*cos(phi2) + 2*L3*m1*m3*phi3p^2*cos(phi3) + 4*L2*m1*m7*phi2p^2*cos(phi2) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L3*m1*m4*phi3p^2*cos(phi3) + 2*L3*m2*m3*phi3p^2*cos(phi3) + 4*L2*m1*m8*phi2p^2*cos(phi2) + 2*L2*m2*m7*phi2p^2*cos(phi2) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 4*L3*m2*m4*phi3p^2*cos(phi3) + 2*L2*m2*m8*phi2p^2*cos(phi2) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m2*m5*phi3p^2*cos(phi3) + 4*L3*m1*m7*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 2*L4*m1*m4*phi4p^2*cos(phi4) + 4*L3*m1*m8*phi3p^2*cos(phi3) + 4*L3*m2*m7*phi3p^2*cos(phi3) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 2*L4*m2*m4*phi4p^2*cos(phi4) + 4*L3*m2*m8*phi3p^2*cos(phi3) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m2*m5*phi4p^2*cos(phi4) + 4*L4*m1*m7*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 4*L4*m1*m8*phi4p^2*cos(phi4) + 4*L4*m2*m7*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 4*L4*m2*m8*phi4p^2*cos(phi4) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 2*L5*m2*m5*phi5p^2*cos(phi5) + 4*L5*m1*m7*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 4*L5*m1*m8*phi5p^2*cos(phi5) + 4*L5*m2*m7*phi5p^2*cos(phi5) + 4*L5*m2*m8*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 4*L6*m1*m7*phi6p^2*cos(phi6) + 2*L6*m2*m6*phi6p^2*cos(phi6) + 4*L6*m1*m8*phi6p^2*cos(phi6) + 4*L6*m2*m7*phi6p^2*cos(phi6) + 4*L6*m2*m8*phi6p^2*cos(phi6) + 2*L7*m1*m7*phi7p^2*cos(phi7) + 4*L7*m1*m8*phi7p^2*cos(phi7) + 2*L7*m2*m7*phi7p^2*cos(phi7) + 4*L7*m2*m8*phi7p^2*cos(phi7) + 2*L8*m1*m8*phi8p^2*cos(phi8) + 2*L8*m2*m8*phi8p^2*cos(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
              -(2*force10*m1 - 2*force1*m5 - 2*force1*m6 - 2*force1*m7 - 2*force4*m4 - 2*force1*m8 - 2*force4*m5 - 2*force4*m6 - 2*force4*m7 - 2*force7*m4 - 2*force1*m4 - 2*force4*m8 - 2*force7*m5 + 2*force10*m2 - 2*force7*m6 + 2*force10*m3 - 2*force7*m7 + 2*force13*m1 - 2*force7*m8 + 2*force13*m2 + 2*force13*m3 + 2*force16*m1 + 2*force16*m2 + 2*force16*m3 + 2*force19*m1 + 2*force19*m2 + 2*force19*m3 + 2*force22*m1 + 2*force22*m2 + 2*force22*m3 + m1*m4*u1b*cos(phi1) - 2*m1*m4*u1b*cos(phi2) + m1*m5*u1b*cos(phi1) + 2*m1*m4*u2b*cos(phi2) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) - m2*m4*u1b*cos(phi2) - 2*m1*m4*u2b*cos(phi3) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) + m1*m7*u1b*cos(phi1) + m2*m4*u2b*cos(phi2) - m2*m5*u1b*cos(phi2) + 2*m1*m4*u3b*cos(phi3) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) - 2*m1*m7*u1b*cos(phi2) + m1*m8*u1b*cos(phi1) - 2*m2*m4*u2b*cos(phi3) + m2*m5*u2b*cos(phi2) - m2*m6*u1b*cos(phi2) - m1*m4*u3b*cos(phi4) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) + 2*m1*m7*u2b*cos(phi2) - 2*m1*m8*u1b*cos(phi2) + 2*m2*m4*u3b*cos(phi3) - 2*m2*m5*u2b*cos(phi3) + m2*m6*u2b*cos(phi2) - m2*m7*u1b*cos(phi2) - m3*m4*u2b*cos(phi3) + m1*m4*u4b*cos(phi4) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) - 2*m1*m7*u2b*cos(phi3) + 2*m1*m8*u2b*cos(phi2) - m2*m4*u3b*cos(phi4) + 2*m2*m5*u3b*cos(phi3) - 2*m2*m6*u2b*cos(phi3) + m2*m7*u2b*cos(phi2) - m2*m8*u1b*cos(phi2) + m3*m4*u3b*cos(phi3) - m3*m5*u2b*cos(phi3) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) + 2*m1*m7*u3b*cos(phi3) - 2*m1*m8*u2b*cos(phi3) + m2*m4*u4b*cos(phi4) - 2*m2*m5*u3b*cos(phi4) + 2*m2*m6*u3b*cos(phi3) - 2*m2*m7*u2b*cos(phi3) + m2*m8*u2b*cos(phi2) - m3*m4*u3b*cos(phi4) + m3*m5*u3b*cos(phi3) - m3*m6*u2b*cos(phi3) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) - 2*m1*m7*u3b*cos(phi4) + 2*m1*m8*u3b*cos(phi3) + 2*m2*m5*u4b*cos(phi4) - 2*m2*m6*u3b*cos(phi4) + 2*m2*m7*u3b*cos(phi3) - 2*m2*m8*u2b*cos(phi3) + m3*m4*u4b*cos(phi4) - 2*m3*m5*u3b*cos(phi4) + m3*m6*u3b*cos(phi3) - m3*m7*u2b*cos(phi3) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) + 2*m1*m7*u4b*cos(phi4) - 2*m1*m8*u3b*cos(phi4) - m2*m5*u4b*cos(phi5) + 2*m2*m6*u4b*cos(phi4) - 2*m2*m7*u3b*cos(phi4) + 2*m2*m8*u3b*cos(phi3) + 2*m3*m5*u4b*cos(phi4) - 2*m3*m6*u3b*cos(phi4) + m3*m7*u3b*cos(phi3) - m3*m8*u2b*cos(phi3) + 2*m1*m6*u5b*cos(phi5) - 2*m1*m7*u4b*cos(phi5) + 2*m1*m8*u4b*cos(phi4) + m2*m5*u5b*cos(phi5) - 2*m2*m6*u4b*cos(phi5) + 2*m2*m7*u4b*cos(phi4) - 2*m2*m8*u3b*cos(phi4) - m3*m5*u4b*cos(phi5) + 2*m3*m6*u4b*cos(phi4) - 2*m3*m7*u3b*cos(phi4) + m3*m8*u3b*cos(phi3) - m1*m6*u5b*cos(phi6) + 2*m1*m7*u5b*cos(phi5) - 2*m1*m8*u4b*cos(phi5) + 2*m2*m6*u5b*cos(phi5) - 2*m2*m7*u4b*cos(phi5) + 2*m2*m8*u4b*cos(phi4) + m3*m5*u5b*cos(phi5) - 2*m3*m6*u4b*cos(phi5) + 2*m3*m7*u4b*cos(phi4) - 2*m3*m8*u3b*cos(phi4) + m1*m6*u6b*cos(phi6) - 2*m1*m7*u5b*cos(phi6) + 2*m1*m8*u5b*cos(phi5) - m2*m6*u5b*cos(phi6) + 2*m2*m7*u5b*cos(phi5) - 2*m2*m8*u4b*cos(phi5) + 2*m3*m6*u5b*cos(phi5) - 2*m3*m7*u4b*cos(phi5) + 2*m3*m8*u4b*cos(phi4) + 2*m1*m7*u6b*cos(phi6) - 2*m1*m8*u5b*cos(phi6) + m2*m6*u6b*cos(phi6) - 2*m2*m7*u5b*cos(phi6) + 2*m2*m8*u5b*cos(phi5) - m3*m6*u5b*cos(phi6) + 2*m3*m7*u5b*cos(phi5) - 2*m3*m8*u4b*cos(phi5) - m1*m7*u6b*cos(phi7) + 2*m1*m8*u6b*cos(phi6) + 2*m2*m7*u6b*cos(phi6) - 2*m2*m8*u5b*cos(phi6) + m3*m6*u6b*cos(phi6) - 2*m3*m7*u5b*cos(phi6) + 2*m3*m8*u5b*cos(phi5) + m1*m7*u7b*cos(phi7) - 2*m1*m8*u6b*cos(phi7) - m2*m7*u6b*cos(phi7) + 2*m2*m8*u6b*cos(phi6) + 2*m3*m7*u6b*cos(phi6) - 2*m3*m8*u5b*cos(phi6) + 2*m1*m8*u7b*cos(phi7) + m2*m7*u7b*cos(phi7) - 2*m2*m8*u6b*cos(phi7) - m3*m7*u6b*cos(phi7) + 2*m3*m8*u6b*cos(phi6) - m1*m8*u7b*cos(phi8) + 2*m2*m8*u7b*cos(phi7) + m3*m7*u7b*cos(phi7) - 2*m3*m8*u6b*cos(phi7) - m2*m8*u7b*cos(phi8) + 2*m3*m8*u7b*cos(phi7) - m3*m8*u7b*cos(phi8) + 2*L1*m1*m4*phi1p^2*sin(phi1) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 2*L1*m1*m7*phi1p^2*sin(phi1) + 4*L2*m1*m4*phi2p^2*sin(phi2) + 2*L1*m1*m8*phi1p^2*sin(phi1) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 2*L2*m2*m4*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L2*m2*m5*phi2p^2*sin(phi2) + 4*L2*m1*m7*phi2p^2*sin(phi2) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L3*m1*m4*phi3p^2*sin(phi3) + 4*L2*m1*m8*phi2p^2*sin(phi2) + 2*L2*m2*m7*phi2p^2*sin(phi2) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 4*L3*m2*m4*phi3p^2*sin(phi3) + 2*L2*m2*m8*phi2p^2*sin(phi2) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m2*m5*phi3p^2*sin(phi3) + 2*L3*m3*m4*phi3p^2*sin(phi3) + 4*L3*m1*m7*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 2*L3*m3*m5*phi3p^2*sin(phi3) + 2*L4*m1*m4*phi4p^2*sin(phi4) + 4*L3*m1*m8*phi3p^2*sin(phi3) + 4*L3*m2*m7*phi3p^2*sin(phi3) + 2*L3*m3*m6*phi3p^2*sin(phi3) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 2*L4*m2*m4*phi4p^2*sin(phi4) + 4*L3*m2*m8*phi3p^2*sin(phi3) + 2*L3*m3*m7*phi3p^2*sin(phi3) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m2*m5*phi4p^2*sin(phi4) + 2*L4*m3*m4*phi4p^2*sin(phi4) + 2*L3*m3*m8*phi3p^2*sin(phi3) + 4*L4*m1*m7*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 4*L4*m3*m5*phi4p^2*sin(phi4) + 4*L4*m1*m8*phi4p^2*sin(phi4) + 4*L4*m2*m7*phi4p^2*sin(phi4) + 4*L4*m3*m6*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 4*L4*m2*m8*phi4p^2*sin(phi4) + 4*L4*m3*m7*phi4p^2*sin(phi4) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 2*L5*m2*m5*phi5p^2*sin(phi5) + 4*L4*m3*m8*phi4p^2*sin(phi4) + 4*L5*m1*m7*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 2*L5*m3*m5*phi5p^2*sin(phi5) + 4*L5*m1*m8*phi5p^2*sin(phi5) + 4*L5*m2*m7*phi5p^2*sin(phi5) + 4*L5*m3*m6*phi5p^2*sin(phi5) + 4*L5*m2*m8*phi5p^2*sin(phi5) + 4*L5*m3*m7*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 4*L5*m3*m8*phi5p^2*sin(phi5) + 4*L6*m1*m7*phi6p^2*sin(phi6) + 2*L6*m2*m6*phi6p^2*sin(phi6) + 4*L6*m1*m8*phi6p^2*sin(phi6) + 4*L6*m2*m7*phi6p^2*sin(phi6) + 2*L6*m3*m6*phi6p^2*sin(phi6) + 4*L6*m2*m8*phi6p^2*sin(phi6) + 4*L6*m3*m7*phi6p^2*sin(phi6) + 4*L6*m3*m8*phi6p^2*sin(phi6) + 2*L7*m1*m7*phi7p^2*sin(phi7) + 4*L7*m1*m8*phi7p^2*sin(phi7) + 2*L7*m2*m7*phi7p^2*sin(phi7) + 4*L7*m2*m8*phi7p^2*sin(phi7) + 2*L7*m3*m7*phi7p^2*sin(phi7) + 4*L7*m3*m8*phi7p^2*sin(phi7) + 2*L8*m1*m8*phi8p^2*sin(phi8) + 2*L8*m2*m8*phi8p^2*sin(phi8) + 2*L8*m3*m8*phi8p^2*sin(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
               (2*force2*m4 + 2*force2*m5 + 2*force2*m6 + 2*force2*m7 + 2*force5*m4 + 2*force2*m8 + 2*force5*m5 + 2*force5*m6 + 2*force5*m7 + 2*force8*m4 - 2*force11*m1 + 2*force5*m8 + 2*force8*m5 - 2*force11*m2 + 2*force8*m6 - 2*force11*m3 + 2*force8*m7 - 2*force14*m1 + 2*force8*m8 - 2*force14*m2 - 2*force14*m3 - 2*force17*m1 - 2*force17*m2 - 2*force17*m3 - 2*force20*m1 - 2*force20*m2 - 2*force20*m3 - 2*force23*m1 - 2*force23*m2 - 2*force23*m3 - m1*m4*u1b*sin(phi1) + 2*m1*m4*u1b*sin(phi2) - m1*m5*u1b*sin(phi1) - 2*m1*m4*u2b*sin(phi2) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) + m2*m4*u1b*sin(phi2) + 2*m1*m4*u2b*sin(phi3) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) - m1*m7*u1b*sin(phi1) - m2*m4*u2b*sin(phi2) + m2*m5*u1b*sin(phi2) - 2*m1*m4*u3b*sin(phi3) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) + 2*m1*m7*u1b*sin(phi2) - m1*m8*u1b*sin(phi1) + 2*m2*m4*u2b*sin(phi3) - m2*m5*u2b*sin(phi2) + m2*m6*u1b*sin(phi2) + m1*m4*u3b*sin(phi4) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) - 2*m1*m7*u2b*sin(phi2) + 2*m1*m8*u1b*sin(phi2) - 2*m2*m4*u3b*sin(phi3) + 2*m2*m5*u2b*sin(phi3) - m2*m6*u2b*sin(phi2) + m2*m7*u1b*sin(phi2) + m3*m4*u2b*sin(phi3) - m1*m4*u4b*sin(phi4) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) + 2*m1*m7*u2b*sin(phi3) - 2*m1*m8*u2b*sin(phi2) + m2*m4*u3b*sin(phi4) - 2*m2*m5*u3b*sin(phi3) + 2*m2*m6*u2b*sin(phi3) - m2*m7*u2b*sin(phi2) + m2*m8*u1b*sin(phi2) - m3*m4*u3b*sin(phi3) + m3*m5*u2b*sin(phi3) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) - 2*m1*m7*u3b*sin(phi3) + 2*m1*m8*u2b*sin(phi3) - m2*m4*u4b*sin(phi4) + 2*m2*m5*u3b*sin(phi4) - 2*m2*m6*u3b*sin(phi3) + 2*m2*m7*u2b*sin(phi3) - m2*m8*u2b*sin(phi2) + m3*m4*u3b*sin(phi4) - m3*m5*u3b*sin(phi3) + m3*m6*u2b*sin(phi3) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) + 2*m1*m7*u3b*sin(phi4) - 2*m1*m8*u3b*sin(phi3) - 2*m2*m5*u4b*sin(phi4) + 2*m2*m6*u3b*sin(phi4) - 2*m2*m7*u3b*sin(phi3) + 2*m2*m8*u2b*sin(phi3) - m3*m4*u4b*sin(phi4) + 2*m3*m5*u3b*sin(phi4) - m3*m6*u3b*sin(phi3) + m3*m7*u2b*sin(phi3) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) - 2*m1*m7*u4b*sin(phi4) + 2*m1*m8*u3b*sin(phi4) + m2*m5*u4b*sin(phi5) - 2*m2*m6*u4b*sin(phi4) + 2*m2*m7*u3b*sin(phi4) - 2*m2*m8*u3b*sin(phi3) - 2*m3*m5*u4b*sin(phi4) + 2*m3*m6*u3b*sin(phi4) - m3*m7*u3b*sin(phi3) + m3*m8*u2b*sin(phi3) - 2*m1*m6*u5b*sin(phi5) + 2*m1*m7*u4b*sin(phi5) - 2*m1*m8*u4b*sin(phi4) - m2*m5*u5b*sin(phi5) + 2*m2*m6*u4b*sin(phi5) - 2*m2*m7*u4b*sin(phi4) + 2*m2*m8*u3b*sin(phi4) + m3*m5*u4b*sin(phi5) - 2*m3*m6*u4b*sin(phi4) + 2*m3*m7*u3b*sin(phi4) - m3*m8*u3b*sin(phi3) + m1*m6*u5b*sin(phi6) - 2*m1*m7*u5b*sin(phi5) + 2*m1*m8*u4b*sin(phi5) - 2*m2*m6*u5b*sin(phi5) + 2*m2*m7*u4b*sin(phi5) - 2*m2*m8*u4b*sin(phi4) - m3*m5*u5b*sin(phi5) + 2*m3*m6*u4b*sin(phi5) - 2*m3*m7*u4b*sin(phi4) + 2*m3*m8*u3b*sin(phi4) - m1*m6*u6b*sin(phi6) + 2*m1*m7*u5b*sin(phi6) - 2*m1*m8*u5b*sin(phi5) + m2*m6*u5b*sin(phi6) - 2*m2*m7*u5b*sin(phi5) + 2*m2*m8*u4b*sin(phi5) - 2*m3*m6*u5b*sin(phi5) + 2*m3*m7*u4b*sin(phi5) - 2*m3*m8*u4b*sin(phi4) - 2*m1*m7*u6b*sin(phi6) + 2*m1*m8*u5b*sin(phi6) - m2*m6*u6b*sin(phi6) + 2*m2*m7*u5b*sin(phi6) - 2*m2*m8*u5b*sin(phi5) + m3*m6*u5b*sin(phi6) - 2*m3*m7*u5b*sin(phi5) + 2*m3*m8*u4b*sin(phi5) + m1*m7*u6b*sin(phi7) - 2*m1*m8*u6b*sin(phi6) - 2*m2*m7*u6b*sin(phi6) + 2*m2*m8*u5b*sin(phi6) - m3*m6*u6b*sin(phi6) + 2*m3*m7*u5b*sin(phi6) - 2*m3*m8*u5b*sin(phi5) - m1*m7*u7b*sin(phi7) + 2*m1*m8*u6b*sin(phi7) + m2*m7*u6b*sin(phi7) - 2*m2*m8*u6b*sin(phi6) - 2*m3*m7*u6b*sin(phi6) + 2*m3*m8*u5b*sin(phi6) - 2*m1*m8*u7b*sin(phi7) - m2*m7*u7b*sin(phi7) + 2*m2*m8*u6b*sin(phi7) + m3*m7*u6b*sin(phi7) - 2*m3*m8*u6b*sin(phi6) + m1*m8*u7b*sin(phi8) - 2*m2*m8*u7b*sin(phi7) - m3*m7*u7b*sin(phi7) + 2*m3*m8*u6b*sin(phi7) + m2*m8*u7b*sin(phi8) - 2*m3*m8*u7b*sin(phi7) + m3*m8*u7b*sin(phi8) + 2*L1*m1*m4*phi1p^2*cos(phi1) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 2*L1*m1*m7*phi1p^2*cos(phi1) + 4*L2*m1*m4*phi2p^2*cos(phi2) + 2*L1*m1*m8*phi1p^2*cos(phi1) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 2*L2*m2*m4*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L2*m2*m5*phi2p^2*cos(phi2) + 4*L2*m1*m7*phi2p^2*cos(phi2) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L3*m1*m4*phi3p^2*cos(phi3) + 4*L2*m1*m8*phi2p^2*cos(phi2) + 2*L2*m2*m7*phi2p^2*cos(phi2) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 4*L3*m2*m4*phi3p^2*cos(phi3) + 2*L2*m2*m8*phi2p^2*cos(phi2) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m2*m5*phi3p^2*cos(phi3) + 2*L3*m3*m4*phi3p^2*cos(phi3) + 4*L3*m1*m7*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 2*L3*m3*m5*phi3p^2*cos(phi3) + 2*L4*m1*m4*phi4p^2*cos(phi4) + 4*L3*m1*m8*phi3p^2*cos(phi3) + 4*L3*m2*m7*phi3p^2*cos(phi3) + 2*L3*m3*m6*phi3p^2*cos(phi3) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 2*L4*m2*m4*phi4p^2*cos(phi4) + 4*L3*m2*m8*phi3p^2*cos(phi3) + 2*L3*m3*m7*phi3p^2*cos(phi3) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m2*m5*phi4p^2*cos(phi4) + 2*L4*m3*m4*phi4p^2*cos(phi4) + 2*L3*m3*m8*phi3p^2*cos(phi3) + 4*L4*m1*m7*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 4*L4*m3*m5*phi4p^2*cos(phi4) + 4*L4*m1*m8*phi4p^2*cos(phi4) + 4*L4*m2*m7*phi4p^2*cos(phi4) + 4*L4*m3*m6*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 4*L4*m2*m8*phi4p^2*cos(phi4) + 4*L4*m3*m7*phi4p^2*cos(phi4) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 2*L5*m2*m5*phi5p^2*cos(phi5) + 4*L4*m3*m8*phi4p^2*cos(phi4) + 4*L5*m1*m7*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 2*L5*m3*m5*phi5p^2*cos(phi5) + 4*L5*m1*m8*phi5p^2*cos(phi5) + 4*L5*m2*m7*phi5p^2*cos(phi5) + 4*L5*m3*m6*phi5p^2*cos(phi5) + 4*L5*m2*m8*phi5p^2*cos(phi5) + 4*L5*m3*m7*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 4*L5*m3*m8*phi5p^2*cos(phi5) + 4*L6*m1*m7*phi6p^2*cos(phi6) + 2*L6*m2*m6*phi6p^2*cos(phi6) + 4*L6*m1*m8*phi6p^2*cos(phi6) + 4*L6*m2*m7*phi6p^2*cos(phi6) + 2*L6*m3*m6*phi6p^2*cos(phi6) + 4*L6*m2*m8*phi6p^2*cos(phi6) + 4*L6*m3*m7*phi6p^2*cos(phi6) + 4*L6*m3*m8*phi6p^2*cos(phi6) + 2*L7*m1*m7*phi7p^2*cos(phi7) + 4*L7*m1*m8*phi7p^2*cos(phi7) + 2*L7*m2*m7*phi7p^2*cos(phi7) + 4*L7*m2*m8*phi7p^2*cos(phi7) + 2*L7*m3*m7*phi7p^2*cos(phi7) + 4*L7*m3*m8*phi7p^2*cos(phi7) + 2*L8*m1*m8*phi8p^2*cos(phi8) + 2*L8*m2*m8*phi8p^2*cos(phi8) + 2*L8*m3*m8*phi8p^2*cos(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
              -(2*force13*m1 - 2*force1*m6 - 2*force1*m7 - 2*force1*m8 - 2*force4*m5 - 2*force4*m6 - 2*force4*m7 - 2*force4*m8 - 2*force7*m5 - 2*force7*m6 - 2*force7*m7 - 2*force1*m5 - 2*force7*m8 - 2*force10*m5 + 2*force13*m2 - 2*force10*m6 + 2*force13*m3 - 2*force10*m7 + 2*force13*m4 + 2*force16*m1 - 2*force10*m8 + 2*force16*m2 + 2*force16*m3 + 2*force16*m4 + 2*force19*m1 + 2*force19*m2 + 2*force19*m3 + 2*force19*m4 + 2*force22*m1 + 2*force22*m2 + 2*force22*m3 + 2*force22*m4 + m1*m5*u1b*cos(phi1) - 2*m1*m5*u1b*cos(phi2) + m1*m6*u1b*cos(phi1) + 2*m1*m5*u2b*cos(phi2) - 2*m1*m6*u1b*cos(phi2) + m1*m7*u1b*cos(phi1) - m2*m5*u1b*cos(phi2) - 2*m1*m5*u2b*cos(phi3) + 2*m1*m6*u2b*cos(phi2) - 2*m1*m7*u1b*cos(phi2) + m1*m8*u1b*cos(phi1) + m2*m5*u2b*cos(phi2) - m2*m6*u1b*cos(phi2) + 2*m1*m5*u3b*cos(phi3) - 2*m1*m6*u2b*cos(phi3) + 2*m1*m7*u2b*cos(phi2) - 2*m1*m8*u1b*cos(phi2) - 2*m2*m5*u2b*cos(phi3) + m2*m6*u2b*cos(phi2) - m2*m7*u1b*cos(phi2) - 2*m1*m5*u3b*cos(phi4) + 2*m1*m6*u3b*cos(phi3) - 2*m1*m7*u2b*cos(phi3) + 2*m1*m8*u2b*cos(phi2) + 2*m2*m5*u3b*cos(phi3) - 2*m2*m6*u2b*cos(phi3) + m2*m7*u2b*cos(phi2) - m2*m8*u1b*cos(phi2) - m3*m5*u2b*cos(phi3) + 2*m1*m5*u4b*cos(phi4) - 2*m1*m6*u3b*cos(phi4) + 2*m1*m7*u3b*cos(phi3) - 2*m1*m8*u2b*cos(phi3) - 2*m2*m5*u3b*cos(phi4) + 2*m2*m6*u3b*cos(phi3) - 2*m2*m7*u2b*cos(phi3) + m2*m8*u2b*cos(phi2) + m3*m5*u3b*cos(phi3) - m3*m6*u2b*cos(phi3) - m1*m5*u4b*cos(phi5) + 2*m1*m6*u4b*cos(phi4) - 2*m1*m7*u3b*cos(phi4) + 2*m1*m8*u3b*cos(phi3) + 2*m2*m5*u4b*cos(phi4) - 2*m2*m6*u3b*cos(phi4) + 2*m2*m7*u3b*cos(phi3) - 2*m2*m8*u2b*cos(phi3) - 2*m3*m5*u3b*cos(phi4) + m3*m6*u3b*cos(phi3) - m3*m7*u2b*cos(phi3) + m1*m5*u5b*cos(phi5) - 2*m1*m6*u4b*cos(phi5) + 2*m1*m7*u4b*cos(phi4) - 2*m1*m8*u3b*cos(phi4) - m2*m5*u4b*cos(phi5) + 2*m2*m6*u4b*cos(phi4) - 2*m2*m7*u3b*cos(phi4) + 2*m2*m8*u3b*cos(phi3) + 2*m3*m5*u4b*cos(phi4) - 2*m3*m6*u3b*cos(phi4) + m3*m7*u3b*cos(phi3) - m3*m8*u2b*cos(phi3) - m4*m5*u3b*cos(phi4) + 2*m1*m6*u5b*cos(phi5) - 2*m1*m7*u4b*cos(phi5) + 2*m1*m8*u4b*cos(phi4) + m2*m5*u5b*cos(phi5) - 2*m2*m6*u4b*cos(phi5) + 2*m2*m7*u4b*cos(phi4) - 2*m2*m8*u3b*cos(phi4) - m3*m5*u4b*cos(phi5) + 2*m3*m6*u4b*cos(phi4) - 2*m3*m7*u3b*cos(phi4) + m3*m8*u3b*cos(phi3) + m4*m5*u4b*cos(phi4) - m4*m6*u3b*cos(phi4) - m1*m6*u5b*cos(phi6) + 2*m1*m7*u5b*cos(phi5) - 2*m1*m8*u4b*cos(phi5) + 2*m2*m6*u5b*cos(phi5) - 2*m2*m7*u4b*cos(phi5) + 2*m2*m8*u4b*cos(phi4) + m3*m5*u5b*cos(phi5) - 2*m3*m6*u4b*cos(phi5) + 2*m3*m7*u4b*cos(phi4) - 2*m3*m8*u3b*cos(phi4) - m4*m5*u4b*cos(phi5) + m4*m6*u4b*cos(phi4) - m4*m7*u3b*cos(phi4) + m1*m6*u6b*cos(phi6) - 2*m1*m7*u5b*cos(phi6) + 2*m1*m8*u5b*cos(phi5) - m2*m6*u5b*cos(phi6) + 2*m2*m7*u5b*cos(phi5) - 2*m2*m8*u4b*cos(phi5) + 2*m3*m6*u5b*cos(phi5) - 2*m3*m7*u4b*cos(phi5) + 2*m3*m8*u4b*cos(phi4) + m4*m5*u5b*cos(phi5) - 2*m4*m6*u4b*cos(phi5) + m4*m7*u4b*cos(phi4) - m4*m8*u3b*cos(phi4) + 2*m1*m7*u6b*cos(phi6) - 2*m1*m8*u5b*cos(phi6) + m2*m6*u6b*cos(phi6) - 2*m2*m7*u5b*cos(phi6) + 2*m2*m8*u5b*cos(phi5) - m3*m6*u5b*cos(phi6) + 2*m3*m7*u5b*cos(phi5) - 2*m3*m8*u4b*cos(phi5) + 2*m4*m6*u5b*cos(phi5) - 2*m4*m7*u4b*cos(phi5) + m4*m8*u4b*cos(phi4) - m1*m7*u6b*cos(phi7) + 2*m1*m8*u6b*cos(phi6) + 2*m2*m7*u6b*cos(phi6) - 2*m2*m8*u5b*cos(phi6) + m3*m6*u6b*cos(phi6) - 2*m3*m7*u5b*cos(phi6) + 2*m3*m8*u5b*cos(phi5) - m4*m6*u5b*cos(phi6) + 2*m4*m7*u5b*cos(phi5) - 2*m4*m8*u4b*cos(phi5) + m1*m7*u7b*cos(phi7) - 2*m1*m8*u6b*cos(phi7) - m2*m7*u6b*cos(phi7) + 2*m2*m8*u6b*cos(phi6) + 2*m3*m7*u6b*cos(phi6) - 2*m3*m8*u5b*cos(phi6) + m4*m6*u6b*cos(phi6) - 2*m4*m7*u5b*cos(phi6) + 2*m4*m8*u5b*cos(phi5) + 2*m1*m8*u7b*cos(phi7) + m2*m7*u7b*cos(phi7) - 2*m2*m8*u6b*cos(phi7) - m3*m7*u6b*cos(phi7) + 2*m3*m8*u6b*cos(phi6) + 2*m4*m7*u6b*cos(phi6) - 2*m4*m8*u5b*cos(phi6) - m1*m8*u7b*cos(phi8) + 2*m2*m8*u7b*cos(phi7) + m3*m7*u7b*cos(phi7) - 2*m3*m8*u6b*cos(phi7) - m4*m7*u6b*cos(phi7) + 2*m4*m8*u6b*cos(phi6) - m2*m8*u7b*cos(phi8) + 2*m3*m8*u7b*cos(phi7) + m4*m7*u7b*cos(phi7) - 2*m4*m8*u6b*cos(phi7) - m3*m8*u7b*cos(phi8) + 2*m4*m8*u7b*cos(phi7) - m4*m8*u7b*cos(phi8) + 2*L1*m1*m5*phi1p^2*sin(phi1) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 2*L1*m1*m7*phi1p^2*sin(phi1) + 2*L1*m1*m8*phi1p^2*sin(phi1) + 4*L2*m1*m5*phi2p^2*sin(phi2) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 2*L2*m2*m5*phi2p^2*sin(phi2) + 4*L2*m1*m7*phi2p^2*sin(phi2) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L2*m1*m8*phi2p^2*sin(phi2) + 2*L2*m2*m7*phi2p^2*sin(phi2) + 4*L3*m1*m5*phi3p^2*sin(phi3) + 2*L2*m2*m8*phi2p^2*sin(phi2) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m2*m5*phi3p^2*sin(phi3) + 4*L3*m1*m7*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 2*L3*m3*m5*phi3p^2*sin(phi3) + 4*L3*m1*m8*phi3p^2*sin(phi3) + 4*L3*m2*m7*phi3p^2*sin(phi3) + 2*L3*m3*m6*phi3p^2*sin(phi3) + 4*L4*m1*m5*phi4p^2*sin(phi4) + 4*L3*m2*m8*phi3p^2*sin(phi3) + 2*L3*m3*m7*phi3p^2*sin(phi3) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 4*L4*m2*m5*phi4p^2*sin(phi4) + 2*L3*m3*m8*phi3p^2*sin(phi3) + 4*L4*m1*m7*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 4*L4*m3*m5*phi4p^2*sin(phi4) + 4*L4*m1*m8*phi4p^2*sin(phi4) + 4*L4*m2*m7*phi4p^2*sin(phi4) + 4*L4*m3*m6*phi4p^2*sin(phi4) + 2*L4*m4*m5*phi4p^2*sin(phi4) + 2*L5*m1*m5*phi5p^2*sin(phi5) + 4*L4*m2*m8*phi4p^2*sin(phi4) + 4*L4*m3*m7*phi4p^2*sin(phi4) + 2*L4*m4*m6*phi4p^2*sin(phi4) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 2*L5*m2*m5*phi5p^2*sin(phi5) + 4*L4*m3*m8*phi4p^2*sin(phi4) + 2*L4*m4*m7*phi4p^2*sin(phi4) + 4*L5*m1*m7*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 2*L5*m3*m5*phi5p^2*sin(phi5) + 2*L4*m4*m8*phi4p^2*sin(phi4) + 4*L5*m1*m8*phi5p^2*sin(phi5) + 4*L5*m2*m7*phi5p^2*sin(phi5) + 4*L5*m3*m6*phi5p^2*sin(phi5) + 2*L5*m4*m5*phi5p^2*sin(phi5) + 4*L5*m2*m8*phi5p^2*sin(phi5) + 4*L5*m3*m7*phi5p^2*sin(phi5) + 4*L5*m4*m6*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 4*L5*m3*m8*phi5p^2*sin(phi5) + 4*L5*m4*m7*phi5p^2*sin(phi5) + 4*L6*m1*m7*phi6p^2*sin(phi6) + 2*L6*m2*m6*phi6p^2*sin(phi6) + 4*L5*m4*m8*phi5p^2*sin(phi5) + 4*L6*m1*m8*phi6p^2*sin(phi6) + 4*L6*m2*m7*phi6p^2*sin(phi6) + 2*L6*m3*m6*phi6p^2*sin(phi6) + 4*L6*m2*m8*phi6p^2*sin(phi6) + 4*L6*m3*m7*phi6p^2*sin(phi6) + 2*L6*m4*m6*phi6p^2*sin(phi6) + 4*L6*m3*m8*phi6p^2*sin(phi6) + 4*L6*m4*m7*phi6p^2*sin(phi6) + 2*L7*m1*m7*phi7p^2*sin(phi7) + 4*L6*m4*m8*phi6p^2*sin(phi6) + 4*L7*m1*m8*phi7p^2*sin(phi7) + 2*L7*m2*m7*phi7p^2*sin(phi7) + 4*L7*m2*m8*phi7p^2*sin(phi7) + 2*L7*m3*m7*phi7p^2*sin(phi7) + 4*L7*m3*m8*phi7p^2*sin(phi7) + 2*L7*m4*m7*phi7p^2*sin(phi7) + 4*L7*m4*m8*phi7p^2*sin(phi7) + 2*L8*m1*m8*phi8p^2*sin(phi8) + 2*L8*m2*m8*phi8p^2*sin(phi8) + 2*L8*m3*m8*phi8p^2*sin(phi8) + 2*L8*m4*m8*phi8p^2*sin(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
               (2*force2*m5 + 2*force2*m6 + 2*force2*m7 + 2*force2*m8 + 2*force5*m5 + 2*force5*m6 + 2*force5*m7 + 2*force5*m8 + 2*force8*m5 + 2*force8*m6 + 2*force8*m7 - 2*force14*m1 + 2*force8*m8 + 2*force11*m5 - 2*force14*m2 + 2*force11*m6 - 2*force14*m3 + 2*force11*m7 - 2*force14*m4 - 2*force17*m1 + 2*force11*m8 - 2*force17*m2 - 2*force17*m3 - 2*force17*m4 - 2*force20*m1 - 2*force20*m2 - 2*force20*m3 - 2*force20*m4 - 2*force23*m1 - 2*force23*m2 - 2*force23*m3 - 2*force23*m4 - m1*m5*u1b*sin(phi1) + 2*m1*m5*u1b*sin(phi2) - m1*m6*u1b*sin(phi1) - 2*m1*m5*u2b*sin(phi2) + 2*m1*m6*u1b*sin(phi2) - m1*m7*u1b*sin(phi1) + m2*m5*u1b*sin(phi2) + 2*m1*m5*u2b*sin(phi3) - 2*m1*m6*u2b*sin(phi2) + 2*m1*m7*u1b*sin(phi2) - m1*m8*u1b*sin(phi1) - m2*m5*u2b*sin(phi2) + m2*m6*u1b*sin(phi2) - 2*m1*m5*u3b*sin(phi3) + 2*m1*m6*u2b*sin(phi3) - 2*m1*m7*u2b*sin(phi2) + 2*m1*m8*u1b*sin(phi2) + 2*m2*m5*u2b*sin(phi3) - m2*m6*u2b*sin(phi2) + m2*m7*u1b*sin(phi2) + 2*m1*m5*u3b*sin(phi4) - 2*m1*m6*u3b*sin(phi3) + 2*m1*m7*u2b*sin(phi3) - 2*m1*m8*u2b*sin(phi2) - 2*m2*m5*u3b*sin(phi3) + 2*m2*m6*u2b*sin(phi3) - m2*m7*u2b*sin(phi2) + m2*m8*u1b*sin(phi2) + m3*m5*u2b*sin(phi3) - 2*m1*m5*u4b*sin(phi4) + 2*m1*m6*u3b*sin(phi4) - 2*m1*m7*u3b*sin(phi3) + 2*m1*m8*u2b*sin(phi3) + 2*m2*m5*u3b*sin(phi4) - 2*m2*m6*u3b*sin(phi3) + 2*m2*m7*u2b*sin(phi3) - m2*m8*u2b*sin(phi2) - m3*m5*u3b*sin(phi3) + m3*m6*u2b*sin(phi3) + m1*m5*u4b*sin(phi5) - 2*m1*m6*u4b*sin(phi4) + 2*m1*m7*u3b*sin(phi4) - 2*m1*m8*u3b*sin(phi3) - 2*m2*m5*u4b*sin(phi4) + 2*m2*m6*u3b*sin(phi4) - 2*m2*m7*u3b*sin(phi3) + 2*m2*m8*u2b*sin(phi3) + 2*m3*m5*u3b*sin(phi4) - m3*m6*u3b*sin(phi3) + m3*m7*u2b*sin(phi3) - m1*m5*u5b*sin(phi5) + 2*m1*m6*u4b*sin(phi5) - 2*m1*m7*u4b*sin(phi4) + 2*m1*m8*u3b*sin(phi4) + m2*m5*u4b*sin(phi5) - 2*m2*m6*u4b*sin(phi4) + 2*m2*m7*u3b*sin(phi4) - 2*m2*m8*u3b*sin(phi3) - 2*m3*m5*u4b*sin(phi4) + 2*m3*m6*u3b*sin(phi4) - m3*m7*u3b*sin(phi3) + m3*m8*u2b*sin(phi3) + m4*m5*u3b*sin(phi4) - 2*m1*m6*u5b*sin(phi5) + 2*m1*m7*u4b*sin(phi5) - 2*m1*m8*u4b*sin(phi4) - m2*m5*u5b*sin(phi5) + 2*m2*m6*u4b*sin(phi5) - 2*m2*m7*u4b*sin(phi4) + 2*m2*m8*u3b*sin(phi4) + m3*m5*u4b*sin(phi5) - 2*m3*m6*u4b*sin(phi4) + 2*m3*m7*u3b*sin(phi4) - m3*m8*u3b*sin(phi3) - m4*m5*u4b*sin(phi4) + m4*m6*u3b*sin(phi4) + m1*m6*u5b*sin(phi6) - 2*m1*m7*u5b*sin(phi5) + 2*m1*m8*u4b*sin(phi5) - 2*m2*m6*u5b*sin(phi5) + 2*m2*m7*u4b*sin(phi5) - 2*m2*m8*u4b*sin(phi4) - m3*m5*u5b*sin(phi5) + 2*m3*m6*u4b*sin(phi5) - 2*m3*m7*u4b*sin(phi4) + 2*m3*m8*u3b*sin(phi4) + m4*m5*u4b*sin(phi5) - m4*m6*u4b*sin(phi4) + m4*m7*u3b*sin(phi4) - m1*m6*u6b*sin(phi6) + 2*m1*m7*u5b*sin(phi6) - 2*m1*m8*u5b*sin(phi5) + m2*m6*u5b*sin(phi6) - 2*m2*m7*u5b*sin(phi5) + 2*m2*m8*u4b*sin(phi5) - 2*m3*m6*u5b*sin(phi5) + 2*m3*m7*u4b*sin(phi5) - 2*m3*m8*u4b*sin(phi4) - m4*m5*u5b*sin(phi5) + 2*m4*m6*u4b*sin(phi5) - m4*m7*u4b*sin(phi4) + m4*m8*u3b*sin(phi4) - 2*m1*m7*u6b*sin(phi6) + 2*m1*m8*u5b*sin(phi6) - m2*m6*u6b*sin(phi6) + 2*m2*m7*u5b*sin(phi6) - 2*m2*m8*u5b*sin(phi5) + m3*m6*u5b*sin(phi6) - 2*m3*m7*u5b*sin(phi5) + 2*m3*m8*u4b*sin(phi5) - 2*m4*m6*u5b*sin(phi5) + 2*m4*m7*u4b*sin(phi5) - m4*m8*u4b*sin(phi4) + m1*m7*u6b*sin(phi7) - 2*m1*m8*u6b*sin(phi6) - 2*m2*m7*u6b*sin(phi6) + 2*m2*m8*u5b*sin(phi6) - m3*m6*u6b*sin(phi6) + 2*m3*m7*u5b*sin(phi6) - 2*m3*m8*u5b*sin(phi5) + m4*m6*u5b*sin(phi6) - 2*m4*m7*u5b*sin(phi5) + 2*m4*m8*u4b*sin(phi5) - m1*m7*u7b*sin(phi7) + 2*m1*m8*u6b*sin(phi7) + m2*m7*u6b*sin(phi7) - 2*m2*m8*u6b*sin(phi6) - 2*m3*m7*u6b*sin(phi6) + 2*m3*m8*u5b*sin(phi6) - m4*m6*u6b*sin(phi6) + 2*m4*m7*u5b*sin(phi6) - 2*m4*m8*u5b*sin(phi5) - 2*m1*m8*u7b*sin(phi7) - m2*m7*u7b*sin(phi7) + 2*m2*m8*u6b*sin(phi7) + m3*m7*u6b*sin(phi7) - 2*m3*m8*u6b*sin(phi6) - 2*m4*m7*u6b*sin(phi6) + 2*m4*m8*u5b*sin(phi6) + m1*m8*u7b*sin(phi8) - 2*m2*m8*u7b*sin(phi7) - m3*m7*u7b*sin(phi7) + 2*m3*m8*u6b*sin(phi7) + m4*m7*u6b*sin(phi7) - 2*m4*m8*u6b*sin(phi6) + m2*m8*u7b*sin(phi8) - 2*m3*m8*u7b*sin(phi7) - m4*m7*u7b*sin(phi7) + 2*m4*m8*u6b*sin(phi7) + m3*m8*u7b*sin(phi8) - 2*m4*m8*u7b*sin(phi7) + m4*m8*u7b*sin(phi8) + 2*L1*m1*m5*phi1p^2*cos(phi1) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 2*L1*m1*m7*phi1p^2*cos(phi1) + 2*L1*m1*m8*phi1p^2*cos(phi1) + 4*L2*m1*m5*phi2p^2*cos(phi2) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 2*L2*m2*m5*phi2p^2*cos(phi2) + 4*L2*m1*m7*phi2p^2*cos(phi2) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L2*m1*m8*phi2p^2*cos(phi2) + 2*L2*m2*m7*phi2p^2*cos(phi2) + 4*L3*m1*m5*phi3p^2*cos(phi3) + 2*L2*m2*m8*phi2p^2*cos(phi2) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m2*m5*phi3p^2*cos(phi3) + 4*L3*m1*m7*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 2*L3*m3*m5*phi3p^2*cos(phi3) + 4*L3*m1*m8*phi3p^2*cos(phi3) + 4*L3*m2*m7*phi3p^2*cos(phi3) + 2*L3*m3*m6*phi3p^2*cos(phi3) + 4*L4*m1*m5*phi4p^2*cos(phi4) + 4*L3*m2*m8*phi3p^2*cos(phi3) + 2*L3*m3*m7*phi3p^2*cos(phi3) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 4*L4*m2*m5*phi4p^2*cos(phi4) + 2*L3*m3*m8*phi3p^2*cos(phi3) + 4*L4*m1*m7*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 4*L4*m3*m5*phi4p^2*cos(phi4) + 4*L4*m1*m8*phi4p^2*cos(phi4) + 4*L4*m2*m7*phi4p^2*cos(phi4) + 4*L4*m3*m6*phi4p^2*cos(phi4) + 2*L4*m4*m5*phi4p^2*cos(phi4) + 2*L5*m1*m5*phi5p^2*cos(phi5) + 4*L4*m2*m8*phi4p^2*cos(phi4) + 4*L4*m3*m7*phi4p^2*cos(phi4) + 2*L4*m4*m6*phi4p^2*cos(phi4) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 2*L5*m2*m5*phi5p^2*cos(phi5) + 4*L4*m3*m8*phi4p^2*cos(phi4) + 2*L4*m4*m7*phi4p^2*cos(phi4) + 4*L5*m1*m7*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 2*L5*m3*m5*phi5p^2*cos(phi5) + 2*L4*m4*m8*phi4p^2*cos(phi4) + 4*L5*m1*m8*phi5p^2*cos(phi5) + 4*L5*m2*m7*phi5p^2*cos(phi5) + 4*L5*m3*m6*phi5p^2*cos(phi5) + 2*L5*m4*m5*phi5p^2*cos(phi5) + 4*L5*m2*m8*phi5p^2*cos(phi5) + 4*L5*m3*m7*phi5p^2*cos(phi5) + 4*L5*m4*m6*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 4*L5*m3*m8*phi5p^2*cos(phi5) + 4*L5*m4*m7*phi5p^2*cos(phi5) + 4*L6*m1*m7*phi6p^2*cos(phi6) + 2*L6*m2*m6*phi6p^2*cos(phi6) + 4*L5*m4*m8*phi5p^2*cos(phi5) + 4*L6*m1*m8*phi6p^2*cos(phi6) + 4*L6*m2*m7*phi6p^2*cos(phi6) + 2*L6*m3*m6*phi6p^2*cos(phi6) + 4*L6*m2*m8*phi6p^2*cos(phi6) + 4*L6*m3*m7*phi6p^2*cos(phi6) + 2*L6*m4*m6*phi6p^2*cos(phi6) + 4*L6*m3*m8*phi6p^2*cos(phi6) + 4*L6*m4*m7*phi6p^2*cos(phi6) + 2*L7*m1*m7*phi7p^2*cos(phi7) + 4*L6*m4*m8*phi6p^2*cos(phi6) + 4*L7*m1*m8*phi7p^2*cos(phi7) + 2*L7*m2*m7*phi7p^2*cos(phi7) + 4*L7*m2*m8*phi7p^2*cos(phi7) + 2*L7*m3*m7*phi7p^2*cos(phi7) + 4*L7*m3*m8*phi7p^2*cos(phi7) + 2*L7*m4*m7*phi7p^2*cos(phi7) + 4*L7*m4*m8*phi7p^2*cos(phi7) + 2*L8*m1*m8*phi8p^2*cos(phi8) + 2*L8*m2*m8*phi8p^2*cos(phi8) + 2*L8*m3*m8*phi8p^2*cos(phi8) + 2*L8*m4*m8*phi8p^2*cos(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
              -(2*force16*m1 - 2*force1*m7 - 2*force1*m8 - 2*force4*m6 - 2*force4*m7 - 2*force4*m8 - 2*force7*m6 - 2*force7*m7 - 2*force7*m8 - 2*force10*m6 - 2*force10*m7 - 2*force1*m6 - 2*force10*m8 + 2*force16*m2 - 2*force13*m6 + 2*force16*m3 - 2*force13*m7 + 2*force16*m4 + 2*force19*m1 - 2*force13*m8 + 2*force16*m5 + 2*force19*m2 + 2*force19*m3 + 2*force19*m4 + 2*force22*m1 + 2*force19*m5 + 2*force22*m2 + 2*force22*m3 + 2*force22*m4 + 2*force22*m5 + m1*m6*u1b*cos(phi1) - 2*m1*m6*u1b*cos(phi2) + m1*m7*u1b*cos(phi1) + 2*m1*m6*u2b*cos(phi2) - 2*m1*m7*u1b*cos(phi2) + m1*m8*u1b*cos(phi1) - m2*m6*u1b*cos(phi2) - 2*m1*m6*u2b*cos(phi3) + 2*m1*m7*u2b*cos(phi2) - 2*m1*m8*u1b*cos(phi2) + m2*m6*u2b*cos(phi2) - m2*m7*u1b*cos(phi2) + 2*m1*m6*u3b*cos(phi3) - 2*m1*m7*u2b*cos(phi3) + 2*m1*m8*u2b*cos(phi2) - 2*m2*m6*u2b*cos(phi3) + m2*m7*u2b*cos(phi2) - m2*m8*u1b*cos(phi2) - 2*m1*m6*u3b*cos(phi4) + 2*m1*m7*u3b*cos(phi3) - 2*m1*m8*u2b*cos(phi3) + 2*m2*m6*u3b*cos(phi3) - 2*m2*m7*u2b*cos(phi3) + m2*m8*u2b*cos(phi2) - m3*m6*u2b*cos(phi3) + 2*m1*m6*u4b*cos(phi4) - 2*m1*m7*u3b*cos(phi4) + 2*m1*m8*u3b*cos(phi3) - 2*m2*m6*u3b*cos(phi4) + 2*m2*m7*u3b*cos(phi3) - 2*m2*m8*u2b*cos(phi3) + m3*m6*u3b*cos(phi3) - m3*m7*u2b*cos(phi3) - 2*m1*m6*u4b*cos(phi5) + 2*m1*m7*u4b*cos(phi4) - 2*m1*m8*u3b*cos(phi4) + 2*m2*m6*u4b*cos(phi4) - 2*m2*m7*u3b*cos(phi4) + 2*m2*m8*u3b*cos(phi3) - 2*m3*m6*u3b*cos(phi4) + m3*m7*u3b*cos(phi3) - m3*m8*u2b*cos(phi3) + 2*m1*m6*u5b*cos(phi5) - 2*m1*m7*u4b*cos(phi5) + 2*m1*m8*u4b*cos(phi4) - 2*m2*m6*u4b*cos(phi5) + 2*m2*m7*u4b*cos(phi4) - 2*m2*m8*u3b*cos(phi4) + 2*m3*m6*u4b*cos(phi4) - 2*m3*m7*u3b*cos(phi4) + m3*m8*u3b*cos(phi3) - m4*m6*u3b*cos(phi4) - m1*m6*u5b*cos(phi6) + 2*m1*m7*u5b*cos(phi5) - 2*m1*m8*u4b*cos(phi5) + 2*m2*m6*u5b*cos(phi5) - 2*m2*m7*u4b*cos(phi5) + 2*m2*m8*u4b*cos(phi4) - 2*m3*m6*u4b*cos(phi5) + 2*m3*m7*u4b*cos(phi4) - 2*m3*m8*u3b*cos(phi4) + m4*m6*u4b*cos(phi4) - m4*m7*u3b*cos(phi4) + m1*m6*u6b*cos(phi6) - 2*m1*m7*u5b*cos(phi6) + 2*m1*m8*u5b*cos(phi5) - m2*m6*u5b*cos(phi6) + 2*m2*m7*u5b*cos(phi5) - 2*m2*m8*u4b*cos(phi5) + 2*m3*m6*u5b*cos(phi5) - 2*m3*m7*u4b*cos(phi5) + 2*m3*m8*u4b*cos(phi4) - 2*m4*m6*u4b*cos(phi5) + m4*m7*u4b*cos(phi4) - m4*m8*u3b*cos(phi4) + 2*m1*m7*u6b*cos(phi6) - 2*m1*m8*u5b*cos(phi6) + m2*m6*u6b*cos(phi6) - 2*m2*m7*u5b*cos(phi6) + 2*m2*m8*u5b*cos(phi5) - m3*m6*u5b*cos(phi6) + 2*m3*m7*u5b*cos(phi5) - 2*m3*m8*u4b*cos(phi5) + 2*m4*m6*u5b*cos(phi5) - 2*m4*m7*u4b*cos(phi5) + m4*m8*u4b*cos(phi4) - m5*m6*u4b*cos(phi5) - m1*m7*u6b*cos(phi7) + 2*m1*m8*u6b*cos(phi6) + 2*m2*m7*u6b*cos(phi6) - 2*m2*m8*u5b*cos(phi6) + m3*m6*u6b*cos(phi6) - 2*m3*m7*u5b*cos(phi6) + 2*m3*m8*u5b*cos(phi5) - m4*m6*u5b*cos(phi6) + 2*m4*m7*u5b*cos(phi5) - 2*m4*m8*u4b*cos(phi5) + m5*m6*u5b*cos(phi5) - m5*m7*u4b*cos(phi5) + m1*m7*u7b*cos(phi7) - 2*m1*m8*u6b*cos(phi7) - m2*m7*u6b*cos(phi7) + 2*m2*m8*u6b*cos(phi6) + 2*m3*m7*u6b*cos(phi6) - 2*m3*m8*u5b*cos(phi6) + m4*m6*u6b*cos(phi6) - 2*m4*m7*u5b*cos(phi6) + 2*m4*m8*u5b*cos(phi5) - m5*m6*u5b*cos(phi6) + m5*m7*u5b*cos(phi5) - m5*m8*u4b*cos(phi5) + 2*m1*m8*u7b*cos(phi7) + m2*m7*u7b*cos(phi7) - 2*m2*m8*u6b*cos(phi7) - m3*m7*u6b*cos(phi7) + 2*m3*m8*u6b*cos(phi6) + 2*m4*m7*u6b*cos(phi6) - 2*m4*m8*u5b*cos(phi6) + m5*m6*u6b*cos(phi6) - 2*m5*m7*u5b*cos(phi6) + m5*m8*u5b*cos(phi5) - m1*m8*u7b*cos(phi8) + 2*m2*m8*u7b*cos(phi7) + m3*m7*u7b*cos(phi7) - 2*m3*m8*u6b*cos(phi7) - m4*m7*u6b*cos(phi7) + 2*m4*m8*u6b*cos(phi6) + 2*m5*m7*u6b*cos(phi6) - 2*m5*m8*u5b*cos(phi6) - m2*m8*u7b*cos(phi8) + 2*m3*m8*u7b*cos(phi7) + m4*m7*u7b*cos(phi7) - 2*m4*m8*u6b*cos(phi7) - m5*m7*u6b*cos(phi7) + 2*m5*m8*u6b*cos(phi6) - m3*m8*u7b*cos(phi8) + 2*m4*m8*u7b*cos(phi7) + m5*m7*u7b*cos(phi7) - 2*m5*m8*u6b*cos(phi7) - m4*m8*u7b*cos(phi8) + 2*m5*m8*u7b*cos(phi7) - m5*m8*u7b*cos(phi8) + 2*L1*m1*m6*phi1p^2*sin(phi1) + 2*L1*m1*m7*phi1p^2*sin(phi1) + 2*L1*m1*m8*phi1p^2*sin(phi1) + 4*L2*m1*m6*phi2p^2*sin(phi2) + 4*L2*m1*m7*phi2p^2*sin(phi2) + 2*L2*m2*m6*phi2p^2*sin(phi2) + 4*L2*m1*m8*phi2p^2*sin(phi2) + 2*L2*m2*m7*phi2p^2*sin(phi2) + 2*L2*m2*m8*phi2p^2*sin(phi2) + 4*L3*m1*m6*phi3p^2*sin(phi3) + 4*L3*m1*m7*phi3p^2*sin(phi3) + 4*L3*m2*m6*phi3p^2*sin(phi3) + 4*L3*m1*m8*phi3p^2*sin(phi3) + 4*L3*m2*m7*phi3p^2*sin(phi3) + 2*L3*m3*m6*phi3p^2*sin(phi3) + 4*L3*m2*m8*phi3p^2*sin(phi3) + 2*L3*m3*m7*phi3p^2*sin(phi3) + 4*L4*m1*m6*phi4p^2*sin(phi4) + 2*L3*m3*m8*phi3p^2*sin(phi3) + 4*L4*m1*m7*phi4p^2*sin(phi4) + 4*L4*m2*m6*phi4p^2*sin(phi4) + 4*L4*m1*m8*phi4p^2*sin(phi4) + 4*L4*m2*m7*phi4p^2*sin(phi4) + 4*L4*m3*m6*phi4p^2*sin(phi4) + 4*L4*m2*m8*phi4p^2*sin(phi4) + 4*L4*m3*m7*phi4p^2*sin(phi4) + 2*L4*m4*m6*phi4p^2*sin(phi4) + 4*L5*m1*m6*phi5p^2*sin(phi5) + 4*L4*m3*m8*phi4p^2*sin(phi4) + 2*L4*m4*m7*phi4p^2*sin(phi4) + 4*L5*m1*m7*phi5p^2*sin(phi5) + 4*L5*m2*m6*phi5p^2*sin(phi5) + 2*L4*m4*m8*phi4p^2*sin(phi4) + 4*L5*m1*m8*phi5p^2*sin(phi5) + 4*L5*m2*m7*phi5p^2*sin(phi5) + 4*L5*m3*m6*phi5p^2*sin(phi5) + 4*L5*m2*m8*phi5p^2*sin(phi5) + 4*L5*m3*m7*phi5p^2*sin(phi5) + 4*L5*m4*m6*phi5p^2*sin(phi5) + 2*L6*m1*m6*phi6p^2*sin(phi6) + 4*L5*m3*m8*phi5p^2*sin(phi5) + 4*L5*m4*m7*phi5p^2*sin(phi5) + 2*L5*m5*m6*phi5p^2*sin(phi5) + 4*L6*m1*m7*phi6p^2*sin(phi6) + 2*L6*m2*m6*phi6p^2*sin(phi6) + 4*L5*m4*m8*phi5p^2*sin(phi5) + 2*L5*m5*m7*phi5p^2*sin(phi5) + 4*L6*m1*m8*phi6p^2*sin(phi6) + 4*L6*m2*m7*phi6p^2*sin(phi6) + 2*L6*m3*m6*phi6p^2*sin(phi6) + 2*L5*m5*m8*phi5p^2*sin(phi5) + 4*L6*m2*m8*phi6p^2*sin(phi6) + 4*L6*m3*m7*phi6p^2*sin(phi6) + 2*L6*m4*m6*phi6p^2*sin(phi6) + 4*L6*m3*m8*phi6p^2*sin(phi6) + 4*L6*m4*m7*phi6p^2*sin(phi6) + 2*L6*m5*m6*phi6p^2*sin(phi6) + 2*L7*m1*m7*phi7p^2*sin(phi7) + 4*L6*m4*m8*phi6p^2*sin(phi6) + 4*L6*m5*m7*phi6p^2*sin(phi6) + 4*L7*m1*m8*phi7p^2*sin(phi7) + 2*L7*m2*m7*phi7p^2*sin(phi7) + 4*L6*m5*m8*phi6p^2*sin(phi6) + 4*L7*m2*m8*phi7p^2*sin(phi7) + 2*L7*m3*m7*phi7p^2*sin(phi7) + 4*L7*m3*m8*phi7p^2*sin(phi7) + 2*L7*m4*m7*phi7p^2*sin(phi7) + 4*L7*m4*m8*phi7p^2*sin(phi7) + 2*L7*m5*m7*phi7p^2*sin(phi7) + 2*L8*m1*m8*phi8p^2*sin(phi8) + 4*L7*m5*m8*phi7p^2*sin(phi7) + 2*L8*m2*m8*phi8p^2*sin(phi8) + 2*L8*m3*m8*phi8p^2*sin(phi8) + 2*L8*m4*m8*phi8p^2*sin(phi8) + 2*L8*m5*m8*phi8p^2*sin(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
               (2*force2*m6 + 2*force2*m7 + 2*force2*m8 + 2*force5*m6 + 2*force5*m7 + 2*force5*m8 + 2*force8*m6 + 2*force8*m7 + 2*force8*m8 + 2*force11*m6 + 2*force11*m7 - 2*force17*m1 + 2*force11*m8 - 2*force17*m2 + 2*force14*m6 - 2*force17*m3 + 2*force14*m7 - 2*force17*m4 - 2*force20*m1 + 2*force14*m8 - 2*force17*m5 - 2*force20*m2 - 2*force20*m3 - 2*force20*m4 - 2*force23*m1 - 2*force20*m5 - 2*force23*m2 - 2*force23*m3 - 2*force23*m4 - 2*force23*m5 - m1*m6*u1b*sin(phi1) + 2*m1*m6*u1b*sin(phi2) - m1*m7*u1b*sin(phi1) - 2*m1*m6*u2b*sin(phi2) + 2*m1*m7*u1b*sin(phi2) - m1*m8*u1b*sin(phi1) + m2*m6*u1b*sin(phi2) + 2*m1*m6*u2b*sin(phi3) - 2*m1*m7*u2b*sin(phi2) + 2*m1*m8*u1b*sin(phi2) - m2*m6*u2b*sin(phi2) + m2*m7*u1b*sin(phi2) - 2*m1*m6*u3b*sin(phi3) + 2*m1*m7*u2b*sin(phi3) - 2*m1*m8*u2b*sin(phi2) + 2*m2*m6*u2b*sin(phi3) - m2*m7*u2b*sin(phi2) + m2*m8*u1b*sin(phi2) + 2*m1*m6*u3b*sin(phi4) - 2*m1*m7*u3b*sin(phi3) + 2*m1*m8*u2b*sin(phi3) - 2*m2*m6*u3b*sin(phi3) + 2*m2*m7*u2b*sin(phi3) - m2*m8*u2b*sin(phi2) + m3*m6*u2b*sin(phi3) - 2*m1*m6*u4b*sin(phi4) + 2*m1*m7*u3b*sin(phi4) - 2*m1*m8*u3b*sin(phi3) + 2*m2*m6*u3b*sin(phi4) - 2*m2*m7*u3b*sin(phi3) + 2*m2*m8*u2b*sin(phi3) - m3*m6*u3b*sin(phi3) + m3*m7*u2b*sin(phi3) + 2*m1*m6*u4b*sin(phi5) - 2*m1*m7*u4b*sin(phi4) + 2*m1*m8*u3b*sin(phi4) - 2*m2*m6*u4b*sin(phi4) + 2*m2*m7*u3b*sin(phi4) - 2*m2*m8*u3b*sin(phi3) + 2*m3*m6*u3b*sin(phi4) - m3*m7*u3b*sin(phi3) + m3*m8*u2b*sin(phi3) - 2*m1*m6*u5b*sin(phi5) + 2*m1*m7*u4b*sin(phi5) - 2*m1*m8*u4b*sin(phi4) + 2*m2*m6*u4b*sin(phi5) - 2*m2*m7*u4b*sin(phi4) + 2*m2*m8*u3b*sin(phi4) - 2*m3*m6*u4b*sin(phi4) + 2*m3*m7*u3b*sin(phi4) - m3*m8*u3b*sin(phi3) + m4*m6*u3b*sin(phi4) + m1*m6*u5b*sin(phi6) - 2*m1*m7*u5b*sin(phi5) + 2*m1*m8*u4b*sin(phi5) - 2*m2*m6*u5b*sin(phi5) + 2*m2*m7*u4b*sin(phi5) - 2*m2*m8*u4b*sin(phi4) + 2*m3*m6*u4b*sin(phi5) - 2*m3*m7*u4b*sin(phi4) + 2*m3*m8*u3b*sin(phi4) - m4*m6*u4b*sin(phi4) + m4*m7*u3b*sin(phi4) - m1*m6*u6b*sin(phi6) + 2*m1*m7*u5b*sin(phi6) - 2*m1*m8*u5b*sin(phi5) + m2*m6*u5b*sin(phi6) - 2*m2*m7*u5b*sin(phi5) + 2*m2*m8*u4b*sin(phi5) - 2*m3*m6*u5b*sin(phi5) + 2*m3*m7*u4b*sin(phi5) - 2*m3*m8*u4b*sin(phi4) + 2*m4*m6*u4b*sin(phi5) - m4*m7*u4b*sin(phi4) + m4*m8*u3b*sin(phi4) - 2*m1*m7*u6b*sin(phi6) + 2*m1*m8*u5b*sin(phi6) - m2*m6*u6b*sin(phi6) + 2*m2*m7*u5b*sin(phi6) - 2*m2*m8*u5b*sin(phi5) + m3*m6*u5b*sin(phi6) - 2*m3*m7*u5b*sin(phi5) + 2*m3*m8*u4b*sin(phi5) - 2*m4*m6*u5b*sin(phi5) + 2*m4*m7*u4b*sin(phi5) - m4*m8*u4b*sin(phi4) + m5*m6*u4b*sin(phi5) + m1*m7*u6b*sin(phi7) - 2*m1*m8*u6b*sin(phi6) - 2*m2*m7*u6b*sin(phi6) + 2*m2*m8*u5b*sin(phi6) - m3*m6*u6b*sin(phi6) + 2*m3*m7*u5b*sin(phi6) - 2*m3*m8*u5b*sin(phi5) + m4*m6*u5b*sin(phi6) - 2*m4*m7*u5b*sin(phi5) + 2*m4*m8*u4b*sin(phi5) - m5*m6*u5b*sin(phi5) + m5*m7*u4b*sin(phi5) - m1*m7*u7b*sin(phi7) + 2*m1*m8*u6b*sin(phi7) + m2*m7*u6b*sin(phi7) - 2*m2*m8*u6b*sin(phi6) - 2*m3*m7*u6b*sin(phi6) + 2*m3*m8*u5b*sin(phi6) - m4*m6*u6b*sin(phi6) + 2*m4*m7*u5b*sin(phi6) - 2*m4*m8*u5b*sin(phi5) + m5*m6*u5b*sin(phi6) - m5*m7*u5b*sin(phi5) + m5*m8*u4b*sin(phi5) - 2*m1*m8*u7b*sin(phi7) - m2*m7*u7b*sin(phi7) + 2*m2*m8*u6b*sin(phi7) + m3*m7*u6b*sin(phi7) - 2*m3*m8*u6b*sin(phi6) - 2*m4*m7*u6b*sin(phi6) + 2*m4*m8*u5b*sin(phi6) - m5*m6*u6b*sin(phi6) + 2*m5*m7*u5b*sin(phi6) - m5*m8*u5b*sin(phi5) + m1*m8*u7b*sin(phi8) - 2*m2*m8*u7b*sin(phi7) - m3*m7*u7b*sin(phi7) + 2*m3*m8*u6b*sin(phi7) + m4*m7*u6b*sin(phi7) - 2*m4*m8*u6b*sin(phi6) - 2*m5*m7*u6b*sin(phi6) + 2*m5*m8*u5b*sin(phi6) + m2*m8*u7b*sin(phi8) - 2*m3*m8*u7b*sin(phi7) - m4*m7*u7b*sin(phi7) + 2*m4*m8*u6b*sin(phi7) + m5*m7*u6b*sin(phi7) - 2*m5*m8*u6b*sin(phi6) + m3*m8*u7b*sin(phi8) - 2*m4*m8*u7b*sin(phi7) - m5*m7*u7b*sin(phi7) + 2*m5*m8*u6b*sin(phi7) + m4*m8*u7b*sin(phi8) - 2*m5*m8*u7b*sin(phi7) + m5*m8*u7b*sin(phi8) + 2*L1*m1*m6*phi1p^2*cos(phi1) + 2*L1*m1*m7*phi1p^2*cos(phi1) + 2*L1*m1*m8*phi1p^2*cos(phi1) + 4*L2*m1*m6*phi2p^2*cos(phi2) + 4*L2*m1*m7*phi2p^2*cos(phi2) + 2*L2*m2*m6*phi2p^2*cos(phi2) + 4*L2*m1*m8*phi2p^2*cos(phi2) + 2*L2*m2*m7*phi2p^2*cos(phi2) + 2*L2*m2*m8*phi2p^2*cos(phi2) + 4*L3*m1*m6*phi3p^2*cos(phi3) + 4*L3*m1*m7*phi3p^2*cos(phi3) + 4*L3*m2*m6*phi3p^2*cos(phi3) + 4*L3*m1*m8*phi3p^2*cos(phi3) + 4*L3*m2*m7*phi3p^2*cos(phi3) + 2*L3*m3*m6*phi3p^2*cos(phi3) + 4*L3*m2*m8*phi3p^2*cos(phi3) + 2*L3*m3*m7*phi3p^2*cos(phi3) + 4*L4*m1*m6*phi4p^2*cos(phi4) + 2*L3*m3*m8*phi3p^2*cos(phi3) + 4*L4*m1*m7*phi4p^2*cos(phi4) + 4*L4*m2*m6*phi4p^2*cos(phi4) + 4*L4*m1*m8*phi4p^2*cos(phi4) + 4*L4*m2*m7*phi4p^2*cos(phi4) + 4*L4*m3*m6*phi4p^2*cos(phi4) + 4*L4*m2*m8*phi4p^2*cos(phi4) + 4*L4*m3*m7*phi4p^2*cos(phi4) + 2*L4*m4*m6*phi4p^2*cos(phi4) + 4*L5*m1*m6*phi5p^2*cos(phi5) + 4*L4*m3*m8*phi4p^2*cos(phi4) + 2*L4*m4*m7*phi4p^2*cos(phi4) + 4*L5*m1*m7*phi5p^2*cos(phi5) + 4*L5*m2*m6*phi5p^2*cos(phi5) + 2*L4*m4*m8*phi4p^2*cos(phi4) + 4*L5*m1*m8*phi5p^2*cos(phi5) + 4*L5*m2*m7*phi5p^2*cos(phi5) + 4*L5*m3*m6*phi5p^2*cos(phi5) + 4*L5*m2*m8*phi5p^2*cos(phi5) + 4*L5*m3*m7*phi5p^2*cos(phi5) + 4*L5*m4*m6*phi5p^2*cos(phi5) + 2*L6*m1*m6*phi6p^2*cos(phi6) + 4*L5*m3*m8*phi5p^2*cos(phi5) + 4*L5*m4*m7*phi5p^2*cos(phi5) + 2*L5*m5*m6*phi5p^2*cos(phi5) + 4*L6*m1*m7*phi6p^2*cos(phi6) + 2*L6*m2*m6*phi6p^2*cos(phi6) + 4*L5*m4*m8*phi5p^2*cos(phi5) + 2*L5*m5*m7*phi5p^2*cos(phi5) + 4*L6*m1*m8*phi6p^2*cos(phi6) + 4*L6*m2*m7*phi6p^2*cos(phi6) + 2*L6*m3*m6*phi6p^2*cos(phi6) + 2*L5*m5*m8*phi5p^2*cos(phi5) + 4*L6*m2*m8*phi6p^2*cos(phi6) + 4*L6*m3*m7*phi6p^2*cos(phi6) + 2*L6*m4*m6*phi6p^2*cos(phi6) + 4*L6*m3*m8*phi6p^2*cos(phi6) + 4*L6*m4*m7*phi6p^2*cos(phi6) + 2*L6*m5*m6*phi6p^2*cos(phi6) + 2*L7*m1*m7*phi7p^2*cos(phi7) + 4*L6*m4*m8*phi6p^2*cos(phi6) + 4*L6*m5*m7*phi6p^2*cos(phi6) + 4*L7*m1*m8*phi7p^2*cos(phi7) + 2*L7*m2*m7*phi7p^2*cos(phi7) + 4*L6*m5*m8*phi6p^2*cos(phi6) + 4*L7*m2*m8*phi7p^2*cos(phi7) + 2*L7*m3*m7*phi7p^2*cos(phi7) + 4*L7*m3*m8*phi7p^2*cos(phi7) + 2*L7*m4*m7*phi7p^2*cos(phi7) + 4*L7*m4*m8*phi7p^2*cos(phi7) + 2*L7*m5*m7*phi7p^2*cos(phi7) + 2*L8*m1*m8*phi8p^2*cos(phi8) + 4*L7*m5*m8*phi7p^2*cos(phi7) + 2*L8*m2*m8*phi8p^2*cos(phi8) + 2*L8*m3*m8*phi8p^2*cos(phi8) + 2*L8*m4*m8*phi8p^2*cos(phi8) + 2*L8*m5*m8*phi8p^2*cos(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
              -(2*force19*m1 - 2*force1*m8 - 2*force4*m7 - 2*force4*m8 - 2*force7*m7 - 2*force7*m8 - 2*force10*m7 - 2*force10*m8 - 2*force13*m7 - 2*force1*m7 - 2*force13*m8 + 2*force19*m2 + 2*force19*m3 - 2*force16*m7 + 2*force19*m4 + 2*force22*m1 - 2*force16*m8 + 2*force19*m5 + 2*force22*m2 + 2*force19*m6 + 2*force22*m3 + 2*force22*m4 + 2*force22*m5 + 2*force22*m6 + m1*m7*u1b*cos(phi1) - 2*m1*m7*u1b*cos(phi2) + m1*m8*u1b*cos(phi1) + 2*m1*m7*u2b*cos(phi2) - 2*m1*m8*u1b*cos(phi2) - m2*m7*u1b*cos(phi2) - 2*m1*m7*u2b*cos(phi3) + 2*m1*m8*u2b*cos(phi2) + m2*m7*u2b*cos(phi2) - m2*m8*u1b*cos(phi2) + 2*m1*m7*u3b*cos(phi3) - 2*m1*m8*u2b*cos(phi3) - 2*m2*m7*u2b*cos(phi3) + m2*m8*u2b*cos(phi2) - 2*m1*m7*u3b*cos(phi4) + 2*m1*m8*u3b*cos(phi3) + 2*m2*m7*u3b*cos(phi3) - 2*m2*m8*u2b*cos(phi3) - m3*m7*u2b*cos(phi3) + 2*m1*m7*u4b*cos(phi4) - 2*m1*m8*u3b*cos(phi4) - 2*m2*m7*u3b*cos(phi4) + 2*m2*m8*u3b*cos(phi3) + m3*m7*u3b*cos(phi3) - m3*m8*u2b*cos(phi3) - 2*m1*m7*u4b*cos(phi5) + 2*m1*m8*u4b*cos(phi4) + 2*m2*m7*u4b*cos(phi4) - 2*m2*m8*u3b*cos(phi4) - 2*m3*m7*u3b*cos(phi4) + m3*m8*u3b*cos(phi3) + 2*m1*m7*u5b*cos(phi5) - 2*m1*m8*u4b*cos(phi5) - 2*m2*m7*u4b*cos(phi5) + 2*m2*m8*u4b*cos(phi4) + 2*m3*m7*u4b*cos(phi4) - 2*m3*m8*u3b*cos(phi4) - m4*m7*u3b*cos(phi4) - 2*m1*m7*u5b*cos(phi6) + 2*m1*m8*u5b*cos(phi5) + 2*m2*m7*u5b*cos(phi5) - 2*m2*m8*u4b*cos(phi5) - 2*m3*m7*u4b*cos(phi5) + 2*m3*m8*u4b*cos(phi4) + m4*m7*u4b*cos(phi4) - m4*m8*u3b*cos(phi4) + 2*m1*m7*u6b*cos(phi6) - 2*m1*m8*u5b*cos(phi6) - 2*m2*m7*u5b*cos(phi6) + 2*m2*m8*u5b*cos(phi5) + 2*m3*m7*u5b*cos(phi5) - 2*m3*m8*u4b*cos(phi5) - 2*m4*m7*u4b*cos(phi5) + m4*m8*u4b*cos(phi4) - m1*m7*u6b*cos(phi7) + 2*m1*m8*u6b*cos(phi6) + 2*m2*m7*u6b*cos(phi6) - 2*m2*m8*u5b*cos(phi6) - 2*m3*m7*u5b*cos(phi6) + 2*m3*m8*u5b*cos(phi5) + 2*m4*m7*u5b*cos(phi5) - 2*m4*m8*u4b*cos(phi5) - m5*m7*u4b*cos(phi5) + m1*m7*u7b*cos(phi7) - 2*m1*m8*u6b*cos(phi7) - m2*m7*u6b*cos(phi7) + 2*m2*m8*u6b*cos(phi6) + 2*m3*m7*u6b*cos(phi6) - 2*m3*m8*u5b*cos(phi6) - 2*m4*m7*u5b*cos(phi6) + 2*m4*m8*u5b*cos(phi5) + m5*m7*u5b*cos(phi5) - m5*m8*u4b*cos(phi5) + 2*m1*m8*u7b*cos(phi7) + m2*m7*u7b*cos(phi7) - 2*m2*m8*u6b*cos(phi7) - m3*m7*u6b*cos(phi7) + 2*m3*m8*u6b*cos(phi6) + 2*m4*m7*u6b*cos(phi6) - 2*m4*m8*u5b*cos(phi6) - 2*m5*m7*u5b*cos(phi6) + m5*m8*u5b*cos(phi5) - m1*m8*u7b*cos(phi8) + 2*m2*m8*u7b*cos(phi7) + m3*m7*u7b*cos(phi7) - 2*m3*m8*u6b*cos(phi7) - m4*m7*u6b*cos(phi7) + 2*m4*m8*u6b*cos(phi6) + 2*m5*m7*u6b*cos(phi6) - 2*m5*m8*u5b*cos(phi6) - m6*m7*u5b*cos(phi6) - m2*m8*u7b*cos(phi8) + 2*m3*m8*u7b*cos(phi7) + m4*m7*u7b*cos(phi7) - 2*m4*m8*u6b*cos(phi7) - m5*m7*u6b*cos(phi7) + 2*m5*m8*u6b*cos(phi6) + m6*m7*u6b*cos(phi6) - m6*m8*u5b*cos(phi6) - m3*m8*u7b*cos(phi8) + 2*m4*m8*u7b*cos(phi7) + m5*m7*u7b*cos(phi7) - 2*m5*m8*u6b*cos(phi7) - m6*m7*u6b*cos(phi7) + m6*m8*u6b*cos(phi6) - m4*m8*u7b*cos(phi8) + 2*m5*m8*u7b*cos(phi7) + m6*m7*u7b*cos(phi7) - 2*m6*m8*u6b*cos(phi7) - m5*m8*u7b*cos(phi8) + 2*m6*m8*u7b*cos(phi7) - m6*m8*u7b*cos(phi8) + 2*L1*m1*m7*phi1p^2*sin(phi1) + 2*L1*m1*m8*phi1p^2*sin(phi1) + 4*L2*m1*m7*phi2p^2*sin(phi2) + 4*L2*m1*m8*phi2p^2*sin(phi2) + 2*L2*m2*m7*phi2p^2*sin(phi2) + 2*L2*m2*m8*phi2p^2*sin(phi2) + 4*L3*m1*m7*phi3p^2*sin(phi3) + 4*L3*m1*m8*phi3p^2*sin(phi3) + 4*L3*m2*m7*phi3p^2*sin(phi3) + 4*L3*m2*m8*phi3p^2*sin(phi3) + 2*L3*m3*m7*phi3p^2*sin(phi3) + 2*L3*m3*m8*phi3p^2*sin(phi3) + 4*L4*m1*m7*phi4p^2*sin(phi4) + 4*L4*m1*m8*phi4p^2*sin(phi4) + 4*L4*m2*m7*phi4p^2*sin(phi4) + 4*L4*m2*m8*phi4p^2*sin(phi4) + 4*L4*m3*m7*phi4p^2*sin(phi4) + 4*L4*m3*m8*phi4p^2*sin(phi4) + 2*L4*m4*m7*phi4p^2*sin(phi4) + 4*L5*m1*m7*phi5p^2*sin(phi5) + 2*L4*m4*m8*phi4p^2*sin(phi4) + 4*L5*m1*m8*phi5p^2*sin(phi5) + 4*L5*m2*m7*phi5p^2*sin(phi5) + 4*L5*m2*m8*phi5p^2*sin(phi5) + 4*L5*m3*m7*phi5p^2*sin(phi5) + 4*L5*m3*m8*phi5p^2*sin(phi5) + 4*L5*m4*m7*phi5p^2*sin(phi5) + 4*L6*m1*m7*phi6p^2*sin(phi6) + 4*L5*m4*m8*phi5p^2*sin(phi5) + 2*L5*m5*m7*phi5p^2*sin(phi5) + 4*L6*m1*m8*phi6p^2*sin(phi6) + 4*L6*m2*m7*phi6p^2*sin(phi6) + 2*L5*m5*m8*phi5p^2*sin(phi5) + 4*L6*m2*m8*phi6p^2*sin(phi6) + 4*L6*m3*m7*phi6p^2*sin(phi6) + 4*L6*m3*m8*phi6p^2*sin(phi6) + 4*L6*m4*m7*phi6p^2*sin(phi6) + 2*L7*m1*m7*phi7p^2*sin(phi7) + 4*L6*m4*m8*phi6p^2*sin(phi6) + 4*L6*m5*m7*phi6p^2*sin(phi6) + 4*L7*m1*m8*phi7p^2*sin(phi7) + 2*L7*m2*m7*phi7p^2*sin(phi7) + 4*L6*m5*m8*phi6p^2*sin(phi6) + 2*L6*m6*m7*phi6p^2*sin(phi6) + 4*L7*m2*m8*phi7p^2*sin(phi7) + 2*L7*m3*m7*phi7p^2*sin(phi7) + 2*L6*m6*m8*phi6p^2*sin(phi6) + 4*L7*m3*m8*phi7p^2*sin(phi7) + 2*L7*m4*m7*phi7p^2*sin(phi7) + 4*L7*m4*m8*phi7p^2*sin(phi7) + 2*L7*m5*m7*phi7p^2*sin(phi7) + 2*L8*m1*m8*phi8p^2*sin(phi8) + 4*L7*m5*m8*phi7p^2*sin(phi7) + 2*L7*m6*m7*phi7p^2*sin(phi7) + 2*L8*m2*m8*phi8p^2*sin(phi8) + 4*L7*m6*m8*phi7p^2*sin(phi7) + 2*L8*m3*m8*phi8p^2*sin(phi8) + 2*L8*m4*m8*phi8p^2*sin(phi8) + 2*L8*m5*m8*phi8p^2*sin(phi8) + 2*L8*m6*m8*phi8p^2*sin(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
               (2*force2*m7 + 2*force2*m8 + 2*force5*m7 + 2*force5*m8 + 2*force8*m7 + 2*force8*m8 + 2*force11*m7 + 2*force11*m8 + 2*force14*m7 - 2*force20*m1 + 2*force14*m8 - 2*force20*m2 - 2*force20*m3 + 2*force17*m7 - 2*force20*m4 - 2*force23*m1 + 2*force17*m8 - 2*force20*m5 - 2*force23*m2 - 2*force20*m6 - 2*force23*m3 - 2*force23*m4 - 2*force23*m5 - 2*force23*m6 - m1*m7*u1b*sin(phi1) + 2*m1*m7*u1b*sin(phi2) - m1*m8*u1b*sin(phi1) - 2*m1*m7*u2b*sin(phi2) + 2*m1*m8*u1b*sin(phi2) + m2*m7*u1b*sin(phi2) + 2*m1*m7*u2b*sin(phi3) - 2*m1*m8*u2b*sin(phi2) - m2*m7*u2b*sin(phi2) + m2*m8*u1b*sin(phi2) - 2*m1*m7*u3b*sin(phi3) + 2*m1*m8*u2b*sin(phi3) + 2*m2*m7*u2b*sin(phi3) - m2*m8*u2b*sin(phi2) + 2*m1*m7*u3b*sin(phi4) - 2*m1*m8*u3b*sin(phi3) - 2*m2*m7*u3b*sin(phi3) + 2*m2*m8*u2b*sin(phi3) + m3*m7*u2b*sin(phi3) - 2*m1*m7*u4b*sin(phi4) + 2*m1*m8*u3b*sin(phi4) + 2*m2*m7*u3b*sin(phi4) - 2*m2*m8*u3b*sin(phi3) - m3*m7*u3b*sin(phi3) + m3*m8*u2b*sin(phi3) + 2*m1*m7*u4b*sin(phi5) - 2*m1*m8*u4b*sin(phi4) - 2*m2*m7*u4b*sin(phi4) + 2*m2*m8*u3b*sin(phi4) + 2*m3*m7*u3b*sin(phi4) - m3*m8*u3b*sin(phi3) - 2*m1*m7*u5b*sin(phi5) + 2*m1*m8*u4b*sin(phi5) + 2*m2*m7*u4b*sin(phi5) - 2*m2*m8*u4b*sin(phi4) - 2*m3*m7*u4b*sin(phi4) + 2*m3*m8*u3b*sin(phi4) + m4*m7*u3b*sin(phi4) + 2*m1*m7*u5b*sin(phi6) - 2*m1*m8*u5b*sin(phi5) - 2*m2*m7*u5b*sin(phi5) + 2*m2*m8*u4b*sin(phi5) + 2*m3*m7*u4b*sin(phi5) - 2*m3*m8*u4b*sin(phi4) - m4*m7*u4b*sin(phi4) + m4*m8*u3b*sin(phi4) - 2*m1*m7*u6b*sin(phi6) + 2*m1*m8*u5b*sin(phi6) + 2*m2*m7*u5b*sin(phi6) - 2*m2*m8*u5b*sin(phi5) - 2*m3*m7*u5b*sin(phi5) + 2*m3*m8*u4b*sin(phi5) + 2*m4*m7*u4b*sin(phi5) - m4*m8*u4b*sin(phi4) + m1*m7*u6b*sin(phi7) - 2*m1*m8*u6b*sin(phi6) - 2*m2*m7*u6b*sin(phi6) + 2*m2*m8*u5b*sin(phi6) + 2*m3*m7*u5b*sin(phi6) - 2*m3*m8*u5b*sin(phi5) - 2*m4*m7*u5b*sin(phi5) + 2*m4*m8*u4b*sin(phi5) + m5*m7*u4b*sin(phi5) - m1*m7*u7b*sin(phi7) + 2*m1*m8*u6b*sin(phi7) + m2*m7*u6b*sin(phi7) - 2*m2*m8*u6b*sin(phi6) - 2*m3*m7*u6b*sin(phi6) + 2*m3*m8*u5b*sin(phi6) + 2*m4*m7*u5b*sin(phi6) - 2*m4*m8*u5b*sin(phi5) - m5*m7*u5b*sin(phi5) + m5*m8*u4b*sin(phi5) - 2*m1*m8*u7b*sin(phi7) - m2*m7*u7b*sin(phi7) + 2*m2*m8*u6b*sin(phi7) + m3*m7*u6b*sin(phi7) - 2*m3*m8*u6b*sin(phi6) - 2*m4*m7*u6b*sin(phi6) + 2*m4*m8*u5b*sin(phi6) + 2*m5*m7*u5b*sin(phi6) - m5*m8*u5b*sin(phi5) + m1*m8*u7b*sin(phi8) - 2*m2*m8*u7b*sin(phi7) - m3*m7*u7b*sin(phi7) + 2*m3*m8*u6b*sin(phi7) + m4*m7*u6b*sin(phi7) - 2*m4*m8*u6b*sin(phi6) - 2*m5*m7*u6b*sin(phi6) + 2*m5*m8*u5b*sin(phi6) + m6*m7*u5b*sin(phi6) + m2*m8*u7b*sin(phi8) - 2*m3*m8*u7b*sin(phi7) - m4*m7*u7b*sin(phi7) + 2*m4*m8*u6b*sin(phi7) + m5*m7*u6b*sin(phi7) - 2*m5*m8*u6b*sin(phi6) - m6*m7*u6b*sin(phi6) + m6*m8*u5b*sin(phi6) + m3*m8*u7b*sin(phi8) - 2*m4*m8*u7b*sin(phi7) - m5*m7*u7b*sin(phi7) + 2*m5*m8*u6b*sin(phi7) + m6*m7*u6b*sin(phi7) - m6*m8*u6b*sin(phi6) + m4*m8*u7b*sin(phi8) - 2*m5*m8*u7b*sin(phi7) - m6*m7*u7b*sin(phi7) + 2*m6*m8*u6b*sin(phi7) + m5*m8*u7b*sin(phi8) - 2*m6*m8*u7b*sin(phi7) + m6*m8*u7b*sin(phi8) + 2*L1*m1*m7*phi1p^2*cos(phi1) + 2*L1*m1*m8*phi1p^2*cos(phi1) + 4*L2*m1*m7*phi2p^2*cos(phi2) + 4*L2*m1*m8*phi2p^2*cos(phi2) + 2*L2*m2*m7*phi2p^2*cos(phi2) + 2*L2*m2*m8*phi2p^2*cos(phi2) + 4*L3*m1*m7*phi3p^2*cos(phi3) + 4*L3*m1*m8*phi3p^2*cos(phi3) + 4*L3*m2*m7*phi3p^2*cos(phi3) + 4*L3*m2*m8*phi3p^2*cos(phi3) + 2*L3*m3*m7*phi3p^2*cos(phi3) + 2*L3*m3*m8*phi3p^2*cos(phi3) + 4*L4*m1*m7*phi4p^2*cos(phi4) + 4*L4*m1*m8*phi4p^2*cos(phi4) + 4*L4*m2*m7*phi4p^2*cos(phi4) + 4*L4*m2*m8*phi4p^2*cos(phi4) + 4*L4*m3*m7*phi4p^2*cos(phi4) + 4*L4*m3*m8*phi4p^2*cos(phi4) + 2*L4*m4*m7*phi4p^2*cos(phi4) + 4*L5*m1*m7*phi5p^2*cos(phi5) + 2*L4*m4*m8*phi4p^2*cos(phi4) + 4*L5*m1*m8*phi5p^2*cos(phi5) + 4*L5*m2*m7*phi5p^2*cos(phi5) + 4*L5*m2*m8*phi5p^2*cos(phi5) + 4*L5*m3*m7*phi5p^2*cos(phi5) + 4*L5*m3*m8*phi5p^2*cos(phi5) + 4*L5*m4*m7*phi5p^2*cos(phi5) + 4*L6*m1*m7*phi6p^2*cos(phi6) + 4*L5*m4*m8*phi5p^2*cos(phi5) + 2*L5*m5*m7*phi5p^2*cos(phi5) + 4*L6*m1*m8*phi6p^2*cos(phi6) + 4*L6*m2*m7*phi6p^2*cos(phi6) + 2*L5*m5*m8*phi5p^2*cos(phi5) + 4*L6*m2*m8*phi6p^2*cos(phi6) + 4*L6*m3*m7*phi6p^2*cos(phi6) + 4*L6*m3*m8*phi6p^2*cos(phi6) + 4*L6*m4*m7*phi6p^2*cos(phi6) + 2*L7*m1*m7*phi7p^2*cos(phi7) + 4*L6*m4*m8*phi6p^2*cos(phi6) + 4*L6*m5*m7*phi6p^2*cos(phi6) + 4*L7*m1*m8*phi7p^2*cos(phi7) + 2*L7*m2*m7*phi7p^2*cos(phi7) + 4*L6*m5*m8*phi6p^2*cos(phi6) + 2*L6*m6*m7*phi6p^2*cos(phi6) + 4*L7*m2*m8*phi7p^2*cos(phi7) + 2*L7*m3*m7*phi7p^2*cos(phi7) + 2*L6*m6*m8*phi6p^2*cos(phi6) + 4*L7*m3*m8*phi7p^2*cos(phi7) + 2*L7*m4*m7*phi7p^2*cos(phi7) + 4*L7*m4*m8*phi7p^2*cos(phi7) + 2*L7*m5*m7*phi7p^2*cos(phi7) + 2*L8*m1*m8*phi8p^2*cos(phi8) + 4*L7*m5*m8*phi7p^2*cos(phi7) + 2*L7*m6*m7*phi7p^2*cos(phi7) + 2*L8*m2*m8*phi8p^2*cos(phi8) + 4*L7*m6*m8*phi7p^2*cos(phi7) + 2*L8*m3*m8*phi8p^2*cos(phi8) + 2*L8*m4*m8*phi8p^2*cos(phi8) + 2*L8*m5*m8*phi8p^2*cos(phi8) + 2*L8*m6*m8*phi8p^2*cos(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
              -(2*force22*m1 - 2*force4*m8 - 2*force7*m8 - 2*force10*m8 - 2*force13*m8 - 2*force1*m8 - 2*force16*m8 + 2*force22*m2 + 2*force22*m3 + 2*force22*m4 - 2*force19*m8 + 2*force22*m5 + 2*force22*m6 + 2*force22*m7 + m1*m8*u1b*cos(phi1) - 2*m1*m8*u1b*cos(phi2) + 2*m1*m8*u2b*cos(phi2) - m2*m8*u1b*cos(phi2) - 2*m1*m8*u2b*cos(phi3) + m2*m8*u2b*cos(phi2) + 2*m1*m8*u3b*cos(phi3) - 2*m2*m8*u2b*cos(phi3) - 2*m1*m8*u3b*cos(phi4) + 2*m2*m8*u3b*cos(phi3) - m3*m8*u2b*cos(phi3) + 2*m1*m8*u4b*cos(phi4) - 2*m2*m8*u3b*cos(phi4) + m3*m8*u3b*cos(phi3) - 2*m1*m8*u4b*cos(phi5) + 2*m2*m8*u4b*cos(phi4) - 2*m3*m8*u3b*cos(phi4) + 2*m1*m8*u5b*cos(phi5) - 2*m2*m8*u4b*cos(phi5) + 2*m3*m8*u4b*cos(phi4) - m4*m8*u3b*cos(phi4) - 2*m1*m8*u5b*cos(phi6) + 2*m2*m8*u5b*cos(phi5) - 2*m3*m8*u4b*cos(phi5) + m4*m8*u4b*cos(phi4) + 2*m1*m8*u6b*cos(phi6) - 2*m2*m8*u5b*cos(phi6) + 2*m3*m8*u5b*cos(phi5) - 2*m4*m8*u4b*cos(phi5) - 2*m1*m8*u6b*cos(phi7) + 2*m2*m8*u6b*cos(phi6) - 2*m3*m8*u5b*cos(phi6) + 2*m4*m8*u5b*cos(phi5) - m5*m8*u4b*cos(phi5) + 2*m1*m8*u7b*cos(phi7) - 2*m2*m8*u6b*cos(phi7) + 2*m3*m8*u6b*cos(phi6) - 2*m4*m8*u5b*cos(phi6) + m5*m8*u5b*cos(phi5) - m1*m8*u7b*cos(phi8) + 2*m2*m8*u7b*cos(phi7) - 2*m3*m8*u6b*cos(phi7) + 2*m4*m8*u6b*cos(phi6) - 2*m5*m8*u5b*cos(phi6) - m2*m8*u7b*cos(phi8) + 2*m3*m8*u7b*cos(phi7) - 2*m4*m8*u6b*cos(phi7) + 2*m5*m8*u6b*cos(phi6) - m6*m8*u5b*cos(phi6) - m3*m8*u7b*cos(phi8) + 2*m4*m8*u7b*cos(phi7) - 2*m5*m8*u6b*cos(phi7) + m6*m8*u6b*cos(phi6) - m4*m8*u7b*cos(phi8) + 2*m5*m8*u7b*cos(phi7) - 2*m6*m8*u6b*cos(phi7) - m5*m8*u7b*cos(phi8) + 2*m6*m8*u7b*cos(phi7) - m7*m8*u6b*cos(phi7) - m6*m8*u7b*cos(phi8) + m7*m8*u7b*cos(phi7) - m7*m8*u7b*cos(phi8) + 2*L1*m1*m8*phi1p^2*sin(phi1) + 4*L2*m1*m8*phi2p^2*sin(phi2) + 2*L2*m2*m8*phi2p^2*sin(phi2) + 4*L3*m1*m8*phi3p^2*sin(phi3) + 4*L3*m2*m8*phi3p^2*sin(phi3) + 2*L3*m3*m8*phi3p^2*sin(phi3) + 4*L4*m1*m8*phi4p^2*sin(phi4) + 4*L4*m2*m8*phi4p^2*sin(phi4) + 4*L4*m3*m8*phi4p^2*sin(phi4) + 2*L4*m4*m8*phi4p^2*sin(phi4) + 4*L5*m1*m8*phi5p^2*sin(phi5) + 4*L5*m2*m8*phi5p^2*sin(phi5) + 4*L5*m3*m8*phi5p^2*sin(phi5) + 4*L5*m4*m8*phi5p^2*sin(phi5) + 4*L6*m1*m8*phi6p^2*sin(phi6) + 2*L5*m5*m8*phi5p^2*sin(phi5) + 4*L6*m2*m8*phi6p^2*sin(phi6) + 4*L6*m3*m8*phi6p^2*sin(phi6) + 4*L6*m4*m8*phi6p^2*sin(phi6) + 4*L7*m1*m8*phi7p^2*sin(phi7) + 4*L6*m5*m8*phi6p^2*sin(phi6) + 4*L7*m2*m8*phi7p^2*sin(phi7) + 2*L6*m6*m8*phi6p^2*sin(phi6) + 4*L7*m3*m8*phi7p^2*sin(phi7) + 4*L7*m4*m8*phi7p^2*sin(phi7) + 2*L8*m1*m8*phi8p^2*sin(phi8) + 4*L7*m5*m8*phi7p^2*sin(phi7) + 2*L8*m2*m8*phi8p^2*sin(phi8) + 4*L7*m6*m8*phi7p^2*sin(phi7) + 2*L8*m3*m8*phi8p^2*sin(phi8) + 2*L7*m7*m8*phi7p^2*sin(phi7) + 2*L8*m4*m8*phi8p^2*sin(phi8) + 2*L8*m5*m8*phi8p^2*sin(phi8) + 2*L8*m6*m8*phi8p^2*sin(phi8) + 2*L8*m7*m8*phi8p^2*sin(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8));...
               (2*force2*m8 + 2*force5*m8 + 2*force8*m8 + 2*force11*m8 + 2*force14*m8 - 2*force23*m1 + 2*force17*m8 - 2*force23*m2 - 2*force23*m3 - 2*force23*m4 + 2*force20*m8 - 2*force23*m5 - 2*force23*m6 - 2*force23*m7 - m1*m8*u1b*sin(phi1) + 2*m1*m8*u1b*sin(phi2) - 2*m1*m8*u2b*sin(phi2) + m2*m8*u1b*sin(phi2) + 2*m1*m8*u2b*sin(phi3) - m2*m8*u2b*sin(phi2) - 2*m1*m8*u3b*sin(phi3) + 2*m2*m8*u2b*sin(phi3) + 2*m1*m8*u3b*sin(phi4) - 2*m2*m8*u3b*sin(phi3) + m3*m8*u2b*sin(phi3) - 2*m1*m8*u4b*sin(phi4) + 2*m2*m8*u3b*sin(phi4) - m3*m8*u3b*sin(phi3) + 2*m1*m8*u4b*sin(phi5) - 2*m2*m8*u4b*sin(phi4) + 2*m3*m8*u3b*sin(phi4) - 2*m1*m8*u5b*sin(phi5) + 2*m2*m8*u4b*sin(phi5) - 2*m3*m8*u4b*sin(phi4) + m4*m8*u3b*sin(phi4) + 2*m1*m8*u5b*sin(phi6) - 2*m2*m8*u5b*sin(phi5) + 2*m3*m8*u4b*sin(phi5) - m4*m8*u4b*sin(phi4) - 2*m1*m8*u6b*sin(phi6) + 2*m2*m8*u5b*sin(phi6) - 2*m3*m8*u5b*sin(phi5) + 2*m4*m8*u4b*sin(phi5) + 2*m1*m8*u6b*sin(phi7) - 2*m2*m8*u6b*sin(phi6) + 2*m3*m8*u5b*sin(phi6) - 2*m4*m8*u5b*sin(phi5) + m5*m8*u4b*sin(phi5) - 2*m1*m8*u7b*sin(phi7) + 2*m2*m8*u6b*sin(phi7) - 2*m3*m8*u6b*sin(phi6) + 2*m4*m8*u5b*sin(phi6) - m5*m8*u5b*sin(phi5) + m1*m8*u7b*sin(phi8) - 2*m2*m8*u7b*sin(phi7) + 2*m3*m8*u6b*sin(phi7) - 2*m4*m8*u6b*sin(phi6) + 2*m5*m8*u5b*sin(phi6) + m2*m8*u7b*sin(phi8) - 2*m3*m8*u7b*sin(phi7) + 2*m4*m8*u6b*sin(phi7) - 2*m5*m8*u6b*sin(phi6) + m6*m8*u5b*sin(phi6) + m3*m8*u7b*sin(phi8) - 2*m4*m8*u7b*sin(phi7) + 2*m5*m8*u6b*sin(phi7) - m6*m8*u6b*sin(phi6) + m4*m8*u7b*sin(phi8) - 2*m5*m8*u7b*sin(phi7) + 2*m6*m8*u6b*sin(phi7) + m5*m8*u7b*sin(phi8) - 2*m6*m8*u7b*sin(phi7) + m7*m8*u6b*sin(phi7) + m6*m8*u7b*sin(phi8) - m7*m8*u7b*sin(phi7) + m7*m8*u7b*sin(phi8) + 2*L1*m1*m8*phi1p^2*cos(phi1) + 4*L2*m1*m8*phi2p^2*cos(phi2) + 2*L2*m2*m8*phi2p^2*cos(phi2) + 4*L3*m1*m8*phi3p^2*cos(phi3) + 4*L3*m2*m8*phi3p^2*cos(phi3) + 2*L3*m3*m8*phi3p^2*cos(phi3) + 4*L4*m1*m8*phi4p^2*cos(phi4) + 4*L4*m2*m8*phi4p^2*cos(phi4) + 4*L4*m3*m8*phi4p^2*cos(phi4) + 2*L4*m4*m8*phi4p^2*cos(phi4) + 4*L5*m1*m8*phi5p^2*cos(phi5) + 4*L5*m2*m8*phi5p^2*cos(phi5) + 4*L5*m3*m8*phi5p^2*cos(phi5) + 4*L5*m4*m8*phi5p^2*cos(phi5) + 4*L6*m1*m8*phi6p^2*cos(phi6) + 2*L5*m5*m8*phi5p^2*cos(phi5) + 4*L6*m2*m8*phi6p^2*cos(phi6) + 4*L6*m3*m8*phi6p^2*cos(phi6) + 4*L6*m4*m8*phi6p^2*cos(phi6) + 4*L7*m1*m8*phi7p^2*cos(phi7) + 4*L6*m5*m8*phi6p^2*cos(phi6) + 4*L7*m2*m8*phi7p^2*cos(phi7) + 2*L6*m6*m8*phi6p^2*cos(phi6) + 4*L7*m3*m8*phi7p^2*cos(phi7) + 4*L7*m4*m8*phi7p^2*cos(phi7) + 2*L8*m1*m8*phi8p^2*cos(phi8) + 4*L7*m5*m8*phi7p^2*cos(phi7) + 2*L8*m2*m8*phi8p^2*cos(phi8) + 4*L7*m6*m8*phi7p^2*cos(phi7) + 2*L8*m3*m8*phi8p^2*cos(phi8) + 2*L7*m7*m8*phi7p^2*cos(phi7) + 2*L8*m4*m8*phi8p^2*cos(phi8) + 2*L8*m5*m8*phi8p^2*cos(phi8) + 2*L8*m6*m8*phi8p^2*cos(phi8) + 2*L8*m7*m8*phi8p^2*cos(phi8))/(2*(m1 + m2 + m3 + m4 + m5 + m6 + m7 + m8))];
elseif SmallAngle == 1  % Use small angle approximation
    Lambda = [-(2*force4*m1 - 2*force1*m3 - 2*force1*m4 - 2*force1*m2 - 2*force1*m5 - 2*force1*m6 - 2*force1*m7 + 2*force7*m1 - 2*force1*m8 + 2*force10*m1 + 2*force13*m1 + 2*force16*m1 + 2*force19*m1 + 2*force22*m1 + m1*m2*u2b - m1*m3*u1b + m1*m3*u2b - m1*m4*u1b + m1*m3*u3b - m1*m5*u1b + m1*m4*u3b - m1*m6*u1b + m1*m4*u4b - m1*m7*u1b + m1*m5*u4b - m1*m8*u1b + m1*m5*u5b + m1*m6*u5b + m1*m6*u6b + m1*m7*u6b + m1*m7*u7b + m1*m8*u7b + 2*L1*m1*m2*phi1*phi1p^2 + 2*L1*m1*m3*phi1*phi1p^2 + 2*L1*m1*m4*phi1*phi1p^2 + 2*L1*m1*m5*phi1*phi1p^2 + 2*L2*m1*m2*phi2*phi2p^2 + 2*L1*m1*m6*phi1*phi1p^2 + 4*L2*m1*m3*phi2*phi2p^2 + 2*L1*m1*m7*phi1*phi1p^2 + 4*L2*m1*m4*phi2*phi2p^2 + 2*L1*m1*m8*phi1*phi1p^2 + 4*L2*m1*m5*phi2*phi2p^2 + 4*L2*m1*m6*phi2*phi2p^2 + 2*L3*m1*m3*phi3*phi3p^2 + 4*L2*m1*m7*phi2*phi2p^2 + 4*L3*m1*m4*phi3*phi3p^2 + 4*L2*m1*m8*phi2*phi2p^2 + 4*L3*m1*m5*phi3*phi3p^2 + 4*L3*m1*m6*phi3*phi3p^2 + 4*L3*m1*m7*phi3*phi3p^2 + 2*L4*m1*m4*phi4*phi4p^2 + 4*L3*m1*m8*phi3*phi3p^2 + 4*L4*m1*m5*phi4*phi4p^2 + 4*L4*m1*m6*phi4*phi4p^2 + 4*L4*m1*m7*phi4*phi4p^2 + 4*L4*m1*m8*phi4*phi4p^2 + 2*L5*m1*m5*phi5*phi5p^2 + 4*L5*m1*m6*phi5*phi5p^2 + 4*L5*m1*m7*phi5*phi5p^2 + 4*L5*m1*m8*phi5*phi5p^2 + 2*L6*m1*m6*phi6*phi6p^2 + 4*L6*m1*m7*phi6*phi6p^2 + 4*L6*m1*m8*phi6*phi6p^2 + 2*L7*m1*m7*phi7*phi7p^2 + 4*L7*m1*m8*phi7*phi7p^2 + 2*L8*m1*m8*phi8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
               (2*force2*m2 + 2*force2*m3 + 2*force2*m4 - 2*force5*m1 + 2*force2*m5 + 2*force2*m6 + 2*force2*m7 - 2*force8*m1 + 2*force2*m8 - 2*force11*m1 - 2*force14*m1 - 2*force17*m1 - 2*force20*m1 - 2*force23*m1 - m1*m2*phi1*u1b + m1*m2*phi2*u1b - m1*m3*phi1*u1b - m1*m2*phi2*u2b + 2*m1*m3*phi2*u1b - m1*m4*phi1*u1b - 2*m1*m3*phi2*u2b + 2*m1*m4*phi2*u1b - m1*m5*phi1*u1b + m1*m3*phi3*u2b - 2*m1*m4*phi2*u2b + 2*m1*m5*phi2*u1b - m1*m6*phi1*u1b - m1*m3*phi3*u3b + 2*m1*m4*phi3*u2b - 2*m1*m5*phi2*u2b + 2*m1*m6*phi2*u1b - m1*m7*phi1*u1b - 2*m1*m4*phi3*u3b + 2*m1*m5*phi3*u2b - 2*m1*m6*phi2*u2b + 2*m1*m7*phi2*u1b - m1*m8*phi1*u1b + m1*m4*phi4*u3b - 2*m1*m5*phi3*u3b + 2*m1*m6*phi3*u2b - 2*m1*m7*phi2*u2b + 2*m1*m8*phi2*u1b - m1*m4*phi4*u4b + 2*m1*m5*phi4*u3b - 2*m1*m6*phi3*u3b + 2*m1*m7*phi3*u2b - 2*m1*m8*phi2*u2b - 2*m1*m5*phi4*u4b + 2*m1*m6*phi4*u3b - 2*m1*m7*phi3*u3b + 2*m1*m8*phi3*u2b + m1*m5*phi5*u4b - 2*m1*m6*phi4*u4b + 2*m1*m7*phi4*u3b - 2*m1*m8*phi3*u3b - m1*m5*phi5*u5b + 2*m1*m6*phi5*u4b - 2*m1*m7*phi4*u4b + 2*m1*m8*phi4*u3b - 2*m1*m6*phi5*u5b + 2*m1*m7*phi5*u4b - 2*m1*m8*phi4*u4b + m1*m6*phi6*u5b - 2*m1*m7*phi5*u5b + 2*m1*m8*phi5*u4b - m1*m6*phi6*u6b + 2*m1*m7*phi6*u5b - 2*m1*m8*phi5*u5b - 2*m1*m7*phi6*u6b + 2*m1*m8*phi6*u5b + m1*m7*phi7*u6b - 2*m1*m8*phi6*u6b - m1*m7*phi7*u7b + 2*m1*m8*phi7*u6b - 2*m1*m8*phi7*u7b + m1*m8*phi8*u7b + 2*L1*m1*m2*phi1p^2 + 2*L1*m1*m3*phi1p^2 + 2*L1*m1*m4*phi1p^2 + 2*L2*m1*m2*phi2p^2 + 2*L1*m1*m5*phi1p^2 + 4*L2*m1*m3*phi2p^2 + 2*L1*m1*m6*phi1p^2 + 4*L2*m1*m4*phi2p^2 + 2*L1*m1*m7*phi1p^2 + 4*L2*m1*m5*phi2p^2 + 2*L3*m1*m3*phi3p^2 + 2*L1*m1*m8*phi1p^2 + 4*L2*m1*m6*phi2p^2 + 4*L3*m1*m4*phi3p^2 + 4*L2*m1*m7*phi2p^2 + 4*L3*m1*m5*phi3p^2 + 4*L2*m1*m8*phi2p^2 + 4*L3*m1*m6*phi3p^2 + 2*L4*m1*m4*phi4p^2 + 4*L3*m1*m7*phi3p^2 + 4*L4*m1*m5*phi4p^2 + 4*L3*m1*m8*phi3p^2 + 4*L4*m1*m6*phi4p^2 + 4*L4*m1*m7*phi4p^2 + 2*L5*m1*m5*phi5p^2 + 4*L4*m1*m8*phi4p^2 + 4*L5*m1*m6*phi5p^2 + 4*L5*m1*m7*phi5p^2 + 4*L5*m1*m8*phi5p^2 + 2*L6*m1*m6*phi6p^2 + 4*L6*m1*m7*phi6p^2 + 4*L6*m1*m8*phi6p^2 + 2*L7*m1*m7*phi7p^2 + 4*L7*m1*m8*phi7p^2 + 2*L8*m1*m8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
              -(2*force7*m1 - 2*force1*m4 - 2*force1*m5 - 2*force1*m6 - 2*force4*m3 - 2*force1*m7 - 2*force4*m4 - 2*force1*m3 - 2*force1*m8 - 2*force4*m5 + 2*force7*m2 - 2*force4*m6 - 2*force4*m7 + 2*force10*m1 - 2*force4*m8 + 2*force10*m2 + 2*force13*m1 + 2*force13*m2 + 2*force16*m1 + 2*force16*m2 + 2*force19*m1 + 2*force19*m2 + 2*force22*m1 + 2*force22*m2 - m1*m3*u1b + m1*m3*u2b - m1*m4*u1b - m2*m3*u1b + m1*m3*u3b - m1*m5*u1b - m2*m4*u1b + m1*m4*u3b - m1*m6*u1b + m2*m3*u3b - m2*m4*u2b - m2*m5*u1b + m1*m4*u4b - m1*m7*u1b + m2*m4*u3b - m2*m5*u2b - m2*m6*u1b + m1*m5*u4b - m1*m8*u1b + m2*m4*u4b - m2*m6*u2b - m2*m7*u1b + m1*m5*u5b + m2*m5*u4b - m2*m7*u2b - m2*m8*u1b + m1*m6*u5b + m2*m5*u5b - m2*m8*u2b + m1*m6*u6b + m2*m6*u5b + m1*m7*u6b + m2*m6*u6b + m1*m7*u7b + m2*m7*u6b + m1*m8*u7b + m2*m7*u7b + m2*m8*u7b + 2*L1*m1*m3*phi1*phi1p^2 + 2*L1*m1*m4*phi1*phi1p^2 + 2*L1*m1*m5*phi1*phi1p^2 + 2*L1*m1*m6*phi1*phi1p^2 + 4*L2*m1*m3*phi2*phi2p^2 + 2*L1*m1*m7*phi1*phi1p^2 + 4*L2*m1*m4*phi2*phi2p^2 + 2*L2*m2*m3*phi2*phi2p^2 + 2*L1*m1*m8*phi1*phi1p^2 + 4*L2*m1*m5*phi2*phi2p^2 + 2*L2*m2*m4*phi2*phi2p^2 + 4*L2*m1*m6*phi2*phi2p^2 + 2*L2*m2*m5*phi2*phi2p^2 + 2*L3*m1*m3*phi3*phi3p^2 + 4*L2*m1*m7*phi2*phi2p^2 + 2*L2*m2*m6*phi2*phi2p^2 + 4*L3*m1*m4*phi3*phi3p^2 + 2*L3*m2*m3*phi3*phi3p^2 + 4*L2*m1*m8*phi2*phi2p^2 + 2*L2*m2*m7*phi2*phi2p^2 + 4*L3*m1*m5*phi3*phi3p^2 + 4*L3*m2*m4*phi3*phi3p^2 + 2*L2*m2*m8*phi2*phi2p^2 + 4*L3*m1*m6*phi3*phi3p^2 + 4*L3*m2*m5*phi3*phi3p^2 + 4*L3*m1*m7*phi3*phi3p^2 + 4*L3*m2*m6*phi3*phi3p^2 + 2*L4*m1*m4*phi4*phi4p^2 + 4*L3*m1*m8*phi3*phi3p^2 + 4*L3*m2*m7*phi3*phi3p^2 + 4*L4*m1*m5*phi4*phi4p^2 + 2*L4*m2*m4*phi4*phi4p^2 + 4*L3*m2*m8*phi3*phi3p^2 + 4*L4*m1*m6*phi4*phi4p^2 + 4*L4*m2*m5*phi4*phi4p^2 + 4*L4*m1*m7*phi4*phi4p^2 + 4*L4*m2*m6*phi4*phi4p^2 + 4*L4*m1*m8*phi4*phi4p^2 + 4*L4*m2*m7*phi4*phi4p^2 + 2*L5*m1*m5*phi5*phi5p^2 + 4*L4*m2*m8*phi4*phi4p^2 + 4*L5*m1*m6*phi5*phi5p^2 + 2*L5*m2*m5*phi5*phi5p^2 + 4*L5*m1*m7*phi5*phi5p^2 + 4*L5*m2*m6*phi5*phi5p^2 + 4*L5*m1*m8*phi5*phi5p^2 + 4*L5*m2*m7*phi5*phi5p^2 + 4*L5*m2*m8*phi5*phi5p^2 + 2*L6*m1*m6*phi6*phi6p^2 + 4*L6*m1*m7*phi6*phi6p^2 + 2*L6*m2*m6*phi6*phi6p^2 + 4*L6*m1*m8*phi6*phi6p^2 + 4*L6*m2*m7*phi6*phi6p^2 + 4*L6*m2*m8*phi6*phi6p^2 + 2*L7*m1*m7*phi7*phi7p^2 + 4*L7*m1*m8*phi7*phi7p^2 + 2*L7*m2*m7*phi7*phi7p^2 + 4*L7*m2*m8*phi7*phi7p^2 + 2*L8*m1*m8*phi8*phi8p^2 + 2*L8*m2*m8*phi8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
               (2*force2*m3 + 2*force2*m4 + 2*force2*m5 + 2*force2*m6 + 2*force5*m3 + 2*force2*m7 + 2*force5*m4 - 2*force8*m1 + 2*force2*m8 + 2*force5*m5 - 2*force8*m2 + 2*force5*m6 + 2*force5*m7 - 2*force11*m1 + 2*force5*m8 - 2*force11*m2 - 2*force14*m1 - 2*force14*m2 - 2*force17*m1 - 2*force17*m2 - 2*force20*m1 - 2*force20*m2 - 2*force23*m1 - 2*force23*m2 - m1*m3*phi1*u1b + 2*m1*m3*phi2*u1b - m1*m4*phi1*u1b - 2*m1*m3*phi2*u2b + 2*m1*m4*phi2*u1b - m1*m5*phi1*u1b + m2*m3*phi2*u1b + m1*m3*phi3*u2b - 2*m1*m4*phi2*u2b + 2*m1*m5*phi2*u1b - m1*m6*phi1*u1b - m2*m3*phi2*u2b + m2*m4*phi2*u1b - m1*m3*phi3*u3b + 2*m1*m4*phi3*u2b - 2*m1*m5*phi2*u2b + 2*m1*m6*phi2*u1b - m1*m7*phi1*u1b + m2*m3*phi3*u2b - m2*m4*phi2*u2b + m2*m5*phi2*u1b - 2*m1*m4*phi3*u3b + 2*m1*m5*phi3*u2b - 2*m1*m6*phi2*u2b + 2*m1*m7*phi2*u1b - m1*m8*phi1*u1b - m2*m3*phi3*u3b + 2*m2*m4*phi3*u2b - m2*m5*phi2*u2b + m2*m6*phi2*u1b + m1*m4*phi4*u3b - 2*m1*m5*phi3*u3b + 2*m1*m6*phi3*u2b - 2*m1*m7*phi2*u2b + 2*m1*m8*phi2*u1b - 2*m2*m4*phi3*u3b + 2*m2*m5*phi3*u2b - m2*m6*phi2*u2b + m2*m7*phi2*u1b - m1*m4*phi4*u4b + 2*m1*m5*phi4*u3b - 2*m1*m6*phi3*u3b + 2*m1*m7*phi3*u2b - 2*m1*m8*phi2*u2b + m2*m4*phi4*u3b - 2*m2*m5*phi3*u3b + 2*m2*m6*phi3*u2b - m2*m7*phi2*u2b + m2*m8*phi2*u1b - 2*m1*m5*phi4*u4b + 2*m1*m6*phi4*u3b - 2*m1*m7*phi3*u3b + 2*m1*m8*phi3*u2b - m2*m4*phi4*u4b + 2*m2*m5*phi4*u3b - 2*m2*m6*phi3*u3b + 2*m2*m7*phi3*u2b - m2*m8*phi2*u2b + m1*m5*phi5*u4b - 2*m1*m6*phi4*u4b + 2*m1*m7*phi4*u3b - 2*m1*m8*phi3*u3b - 2*m2*m5*phi4*u4b + 2*m2*m6*phi4*u3b - 2*m2*m7*phi3*u3b + 2*m2*m8*phi3*u2b - m1*m5*phi5*u5b + 2*m1*m6*phi5*u4b - 2*m1*m7*phi4*u4b + 2*m1*m8*phi4*u3b + m2*m5*phi5*u4b - 2*m2*m6*phi4*u4b + 2*m2*m7*phi4*u3b - 2*m2*m8*phi3*u3b - 2*m1*m6*phi5*u5b + 2*m1*m7*phi5*u4b - 2*m1*m8*phi4*u4b - m2*m5*phi5*u5b + 2*m2*m6*phi5*u4b - 2*m2*m7*phi4*u4b + 2*m2*m8*phi4*u3b + m1*m6*phi6*u5b - 2*m1*m7*phi5*u5b + 2*m1*m8*phi5*u4b - 2*m2*m6*phi5*u5b + 2*m2*m7*phi5*u4b - 2*m2*m8*phi4*u4b - m1*m6*phi6*u6b + 2*m1*m7*phi6*u5b - 2*m1*m8*phi5*u5b + m2*m6*phi6*u5b - 2*m2*m7*phi5*u5b + 2*m2*m8*phi5*u4b - 2*m1*m7*phi6*u6b + 2*m1*m8*phi6*u5b - m2*m6*phi6*u6b + 2*m2*m7*phi6*u5b - 2*m2*m8*phi5*u5b + m1*m7*phi7*u6b - 2*m1*m8*phi6*u6b - 2*m2*m7*phi6*u6b + 2*m2*m8*phi6*u5b - m1*m7*phi7*u7b + 2*m1*m8*phi7*u6b + m2*m7*phi7*u6b - 2*m2*m8*phi6*u6b - 2*m1*m8*phi7*u7b - m2*m7*phi7*u7b + 2*m2*m8*phi7*u6b + m1*m8*phi8*u7b - 2*m2*m8*phi7*u7b + m2*m8*phi8*u7b + 2*L1*m1*m3*phi1p^2 + 2*L1*m1*m4*phi1p^2 + 2*L1*m1*m5*phi1p^2 + 4*L2*m1*m3*phi2p^2 + 2*L1*m1*m6*phi1p^2 + 4*L2*m1*m4*phi2p^2 + 2*L2*m2*m3*phi2p^2 + 2*L1*m1*m7*phi1p^2 + 4*L2*m1*m5*phi2p^2 + 2*L2*m2*m4*phi2p^2 + 2*L3*m1*m3*phi3p^2 + 2*L1*m1*m8*phi1p^2 + 4*L2*m1*m6*phi2p^2 + 2*L2*m2*m5*phi2p^2 + 4*L3*m1*m4*phi3p^2 + 2*L3*m2*m3*phi3p^2 + 4*L2*m1*m7*phi2p^2 + 2*L2*m2*m6*phi2p^2 + 4*L3*m1*m5*phi3p^2 + 4*L3*m2*m4*phi3p^2 + 4*L2*m1*m8*phi2p^2 + 2*L2*m2*m7*phi2p^2 + 4*L3*m1*m6*phi3p^2 + 4*L3*m2*m5*phi3p^2 + 2*L4*m1*m4*phi4p^2 + 2*L2*m2*m8*phi2p^2 + 4*L3*m1*m7*phi3p^2 + 4*L3*m2*m6*phi3p^2 + 4*L4*m1*m5*phi4p^2 + 2*L4*m2*m4*phi4p^2 + 4*L3*m1*m8*phi3p^2 + 4*L3*m2*m7*phi3p^2 + 4*L4*m1*m6*phi4p^2 + 4*L4*m2*m5*phi4p^2 + 4*L3*m2*m8*phi3p^2 + 4*L4*m1*m7*phi4p^2 + 4*L4*m2*m6*phi4p^2 + 2*L5*m1*m5*phi5p^2 + 4*L4*m1*m8*phi4p^2 + 4*L4*m2*m7*phi4p^2 + 4*L5*m1*m6*phi5p^2 + 2*L5*m2*m5*phi5p^2 + 4*L4*m2*m8*phi4p^2 + 4*L5*m1*m7*phi5p^2 + 4*L5*m2*m6*phi5p^2 + 4*L5*m1*m8*phi5p^2 + 4*L5*m2*m7*phi5p^2 + 2*L6*m1*m6*phi6p^2 + 4*L5*m2*m8*phi5p^2 + 4*L6*m1*m7*phi6p^2 + 2*L6*m2*m6*phi6p^2 + 4*L6*m1*m8*phi6p^2 + 4*L6*m2*m7*phi6p^2 + 4*L6*m2*m8*phi6p^2 + 2*L7*m1*m7*phi7p^2 + 4*L7*m1*m8*phi7p^2 + 2*L7*m2*m7*phi7p^2 + 4*L7*m2*m8*phi7p^2 + 2*L8*m1*m8*phi8p^2 + 2*L8*m2*m8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
              -(2*force10*m1 - 2*force1*m5 - 2*force1*m6 - 2*force1*m7 - 2*force4*m4 - 2*force1*m8 - 2*force4*m5 - 2*force4*m6 - 2*force4*m7 - 2*force7*m4 - 2*force1*m4 - 2*force4*m8 - 2*force7*m5 + 2*force10*m2 - 2*force7*m6 + 2*force10*m3 - 2*force7*m7 + 2*force13*m1 - 2*force7*m8 + 2*force13*m2 + 2*force13*m3 + 2*force16*m1 + 2*force16*m2 + 2*force16*m3 + 2*force19*m1 + 2*force19*m2 + 2*force19*m3 + 2*force22*m1 + 2*force22*m2 + 2*force22*m3 - m1*m4*u1b - m1*m5*u1b - m2*m4*u1b + m1*m4*u3b - m1*m6*u1b - m2*m4*u2b - m2*m5*u1b + m1*m4*u4b - m1*m7*u1b + m2*m4*u3b - m2*m5*u2b - m2*m6*u1b - m3*m4*u2b + m1*m5*u4b - m1*m8*u1b + m2*m4*u4b - m2*m6*u2b - m2*m7*u1b - m3*m5*u2b + m1*m5*u5b + m2*m5*u4b - m2*m7*u2b - m2*m8*u1b + m3*m4*u4b - m3*m5*u3b - m3*m6*u2b + m1*m6*u5b + m2*m5*u5b - m2*m8*u2b + m3*m5*u4b - m3*m6*u3b - m3*m7*u2b + m1*m6*u6b + m2*m6*u5b + m3*m5*u5b - m3*m7*u3b - m3*m8*u2b + m1*m7*u6b + m2*m6*u6b + m3*m6*u5b - m3*m8*u3b + m1*m7*u7b + m2*m7*u6b + m3*m6*u6b + m1*m8*u7b + m2*m7*u7b + m3*m7*u6b + m2*m8*u7b + m3*m7*u7b + m3*m8*u7b + 2*L1*m1*m4*phi1*phi1p^2 + 2*L1*m1*m5*phi1*phi1p^2 + 2*L1*m1*m6*phi1*phi1p^2 + 2*L1*m1*m7*phi1*phi1p^2 + 4*L2*m1*m4*phi2*phi2p^2 + 2*L1*m1*m8*phi1*phi1p^2 + 4*L2*m1*m5*phi2*phi2p^2 + 2*L2*m2*m4*phi2*phi2p^2 + 4*L2*m1*m6*phi2*phi2p^2 + 2*L2*m2*m5*phi2*phi2p^2 + 4*L2*m1*m7*phi2*phi2p^2 + 2*L2*m2*m6*phi2*phi2p^2 + 4*L3*m1*m4*phi3*phi3p^2 + 4*L2*m1*m8*phi2*phi2p^2 + 2*L2*m2*m7*phi2*phi2p^2 + 4*L3*m1*m5*phi3*phi3p^2 + 4*L3*m2*m4*phi3*phi3p^2 + 2*L2*m2*m8*phi2*phi2p^2 + 4*L3*m1*m6*phi3*phi3p^2 + 4*L3*m2*m5*phi3*phi3p^2 + 2*L3*m3*m4*phi3*phi3p^2 + 4*L3*m1*m7*phi3*phi3p^2 + 4*L3*m2*m6*phi3*phi3p^2 + 2*L3*m3*m5*phi3*phi3p^2 + 2*L4*m1*m4*phi4*phi4p^2 + 4*L3*m1*m8*phi3*phi3p^2 + 4*L3*m2*m7*phi3*phi3p^2 + 2*L3*m3*m6*phi3*phi3p^2 + 4*L4*m1*m5*phi4*phi4p^2 + 2*L4*m2*m4*phi4*phi4p^2 + 4*L3*m2*m8*phi3*phi3p^2 + 2*L3*m3*m7*phi3*phi3p^2 + 4*L4*m1*m6*phi4*phi4p^2 + 4*L4*m2*m5*phi4*phi4p^2 + 2*L4*m3*m4*phi4*phi4p^2 + 2*L3*m3*m8*phi3*phi3p^2 + 4*L4*m1*m7*phi4*phi4p^2 + 4*L4*m2*m6*phi4*phi4p^2 + 4*L4*m3*m5*phi4*phi4p^2 + 4*L4*m1*m8*phi4*phi4p^2 + 4*L4*m2*m7*phi4*phi4p^2 + 4*L4*m3*m6*phi4*phi4p^2 + 2*L5*m1*m5*phi5*phi5p^2 + 4*L4*m2*m8*phi4*phi4p^2 + 4*L4*m3*m7*phi4*phi4p^2 + 4*L5*m1*m6*phi5*phi5p^2 + 2*L5*m2*m5*phi5*phi5p^2 + 4*L4*m3*m8*phi4*phi4p^2 + 4*L5*m1*m7*phi5*phi5p^2 + 4*L5*m2*m6*phi5*phi5p^2 + 2*L5*m3*m5*phi5*phi5p^2 + 4*L5*m1*m8*phi5*phi5p^2 + 4*L5*m2*m7*phi5*phi5p^2 + 4*L5*m3*m6*phi5*phi5p^2 + 4*L5*m2*m8*phi5*phi5p^2 + 4*L5*m3*m7*phi5*phi5p^2 + 2*L6*m1*m6*phi6*phi6p^2 + 4*L5*m3*m8*phi5*phi5p^2 + 4*L6*m1*m7*phi6*phi6p^2 + 2*L6*m2*m6*phi6*phi6p^2 + 4*L6*m1*m8*phi6*phi6p^2 + 4*L6*m2*m7*phi6*phi6p^2 + 2*L6*m3*m6*phi6*phi6p^2 + 4*L6*m2*m8*phi6*phi6p^2 + 4*L6*m3*m7*phi6*phi6p^2 + 4*L6*m3*m8*phi6*phi6p^2 + 2*L7*m1*m7*phi7*phi7p^2 + 4*L7*m1*m8*phi7*phi7p^2 + 2*L7*m2*m7*phi7*phi7p^2 + 4*L7*m2*m8*phi7*phi7p^2 + 2*L7*m3*m7*phi7*phi7p^2 + 4*L7*m3*m8*phi7*phi7p^2 + 2*L8*m1*m8*phi8*phi8p^2 + 2*L8*m2*m8*phi8*phi8p^2 + 2*L8*m3*m8*phi8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
               (2*force2*m4 + 2*force2*m5 + 2*force2*m6 + 2*force2*m7 + 2*force5*m4 + 2*force2*m8 + 2*force5*m5 + 2*force5*m6 + 2*force5*m7 + 2*force8*m4 - 2*force11*m1 + 2*force5*m8 + 2*force8*m5 - 2*force11*m2 + 2*force8*m6 - 2*force11*m3 + 2*force8*m7 - 2*force14*m1 + 2*force8*m8 - 2*force14*m2 - 2*force14*m3 - 2*force17*m1 - 2*force17*m2 - 2*force17*m3 - 2*force20*m1 - 2*force20*m2 - 2*force20*m3 - 2*force23*m1 - 2*force23*m2 - 2*force23*m3 - m1*m4*phi1*u1b + 2*m1*m4*phi2*u1b - m1*m5*phi1*u1b - 2*m1*m4*phi2*u2b + 2*m1*m5*phi2*u1b - m1*m6*phi1*u1b + m2*m4*phi2*u1b + 2*m1*m4*phi3*u2b - 2*m1*m5*phi2*u2b + 2*m1*m6*phi2*u1b - m1*m7*phi1*u1b - m2*m4*phi2*u2b + m2*m5*phi2*u1b - 2*m1*m4*phi3*u3b + 2*m1*m5*phi3*u2b - 2*m1*m6*phi2*u2b + 2*m1*m7*phi2*u1b - m1*m8*phi1*u1b + 2*m2*m4*phi3*u2b - m2*m5*phi2*u2b + m2*m6*phi2*u1b + m1*m4*phi4*u3b - 2*m1*m5*phi3*u3b + 2*m1*m6*phi3*u2b - 2*m1*m7*phi2*u2b + 2*m1*m8*phi2*u1b - 2*m2*m4*phi3*u3b + 2*m2*m5*phi3*u2b - m2*m6*phi2*u2b + m2*m7*phi2*u1b + m3*m4*phi3*u2b - m1*m4*phi4*u4b + 2*m1*m5*phi4*u3b - 2*m1*m6*phi3*u3b + 2*m1*m7*phi3*u2b - 2*m1*m8*phi2*u2b + m2*m4*phi4*u3b - 2*m2*m5*phi3*u3b + 2*m2*m6*phi3*u2b - m2*m7*phi2*u2b + m2*m8*phi2*u1b - m3*m4*phi3*u3b + m3*m5*phi3*u2b - 2*m1*m5*phi4*u4b + 2*m1*m6*phi4*u3b - 2*m1*m7*phi3*u3b + 2*m1*m8*phi3*u2b - m2*m4*phi4*u4b + 2*m2*m5*phi4*u3b - 2*m2*m6*phi3*u3b + 2*m2*m7*phi3*u2b - m2*m8*phi2*u2b + m3*m4*phi4*u3b - m3*m5*phi3*u3b + m3*m6*phi3*u2b + m1*m5*phi5*u4b - 2*m1*m6*phi4*u4b + 2*m1*m7*phi4*u3b - 2*m1*m8*phi3*u3b - 2*m2*m5*phi4*u4b + 2*m2*m6*phi4*u3b - 2*m2*m7*phi3*u3b + 2*m2*m8*phi3*u2b - m3*m4*phi4*u4b + 2*m3*m5*phi4*u3b - m3*m6*phi3*u3b + m3*m7*phi3*u2b - m1*m5*phi5*u5b + 2*m1*m6*phi5*u4b - 2*m1*m7*phi4*u4b + 2*m1*m8*phi4*u3b + m2*m5*phi5*u4b - 2*m2*m6*phi4*u4b + 2*m2*m7*phi4*u3b - 2*m2*m8*phi3*u3b - 2*m3*m5*phi4*u4b + 2*m3*m6*phi4*u3b - m3*m7*phi3*u3b + m3*m8*phi3*u2b - 2*m1*m6*phi5*u5b + 2*m1*m7*phi5*u4b - 2*m1*m8*phi4*u4b - m2*m5*phi5*u5b + 2*m2*m6*phi5*u4b - 2*m2*m7*phi4*u4b + 2*m2*m8*phi4*u3b + m3*m5*phi5*u4b - 2*m3*m6*phi4*u4b + 2*m3*m7*phi4*u3b - m3*m8*phi3*u3b + m1*m6*phi6*u5b - 2*m1*m7*phi5*u5b + 2*m1*m8*phi5*u4b - 2*m2*m6*phi5*u5b + 2*m2*m7*phi5*u4b - 2*m2*m8*phi4*u4b - m3*m5*phi5*u5b + 2*m3*m6*phi5*u4b - 2*m3*m7*phi4*u4b + 2*m3*m8*phi4*u3b - m1*m6*phi6*u6b + 2*m1*m7*phi6*u5b - 2*m1*m8*phi5*u5b + m2*m6*phi6*u5b - 2*m2*m7*phi5*u5b + 2*m2*m8*phi5*u4b - 2*m3*m6*phi5*u5b + 2*m3*m7*phi5*u4b - 2*m3*m8*phi4*u4b - 2*m1*m7*phi6*u6b + 2*m1*m8*phi6*u5b - m2*m6*phi6*u6b + 2*m2*m7*phi6*u5b - 2*m2*m8*phi5*u5b + m3*m6*phi6*u5b - 2*m3*m7*phi5*u5b + 2*m3*m8*phi5*u4b + m1*m7*phi7*u6b - 2*m1*m8*phi6*u6b - 2*m2*m7*phi6*u6b + 2*m2*m8*phi6*u5b - m3*m6*phi6*u6b + 2*m3*m7*phi6*u5b - 2*m3*m8*phi5*u5b - m1*m7*phi7*u7b + 2*m1*m8*phi7*u6b + m2*m7*phi7*u6b - 2*m2*m8*phi6*u6b - 2*m3*m7*phi6*u6b + 2*m3*m8*phi6*u5b - 2*m1*m8*phi7*u7b - m2*m7*phi7*u7b + 2*m2*m8*phi7*u6b + m3*m7*phi7*u6b - 2*m3*m8*phi6*u6b + m1*m8*phi8*u7b - 2*m2*m8*phi7*u7b - m3*m7*phi7*u7b + 2*m3*m8*phi7*u6b + m2*m8*phi8*u7b - 2*m3*m8*phi7*u7b + m3*m8*phi8*u7b + 2*L1*m1*m4*phi1p^2 + 2*L1*m1*m5*phi1p^2 + 2*L1*m1*m6*phi1p^2 + 4*L2*m1*m4*phi2p^2 + 2*L1*m1*m7*phi1p^2 + 4*L2*m1*m5*phi2p^2 + 2*L2*m2*m4*phi2p^2 + 2*L1*m1*m8*phi1p^2 + 4*L2*m1*m6*phi2p^2 + 2*L2*m2*m5*phi2p^2 + 4*L3*m1*m4*phi3p^2 + 4*L2*m1*m7*phi2p^2 + 2*L2*m2*m6*phi2p^2 + 4*L3*m1*m5*phi3p^2 + 4*L3*m2*m4*phi3p^2 + 4*L2*m1*m8*phi2p^2 + 2*L2*m2*m7*phi2p^2 + 4*L3*m1*m6*phi3p^2 + 4*L3*m2*m5*phi3p^2 + 2*L3*m3*m4*phi3p^2 + 2*L4*m1*m4*phi4p^2 + 2*L2*m2*m8*phi2p^2 + 4*L3*m1*m7*phi3p^2 + 4*L3*m2*m6*phi3p^2 + 2*L3*m3*m5*phi3p^2 + 4*L4*m1*m5*phi4p^2 + 2*L4*m2*m4*phi4p^2 + 4*L3*m1*m8*phi3p^2 + 4*L3*m2*m7*phi3p^2 + 2*L3*m3*m6*phi3p^2 + 4*L4*m1*m6*phi4p^2 + 4*L4*m2*m5*phi4p^2 + 2*L4*m3*m4*phi4p^2 + 4*L3*m2*m8*phi3p^2 + 2*L3*m3*m7*phi3p^2 + 4*L4*m1*m7*phi4p^2 + 4*L4*m2*m6*phi4p^2 + 4*L4*m3*m5*phi4p^2 + 2*L5*m1*m5*phi5p^2 + 2*L3*m3*m8*phi3p^2 + 4*L4*m1*m8*phi4p^2 + 4*L4*m2*m7*phi4p^2 + 4*L4*m3*m6*phi4p^2 + 4*L5*m1*m6*phi5p^2 + 2*L5*m2*m5*phi5p^2 + 4*L4*m2*m8*phi4p^2 + 4*L4*m3*m7*phi4p^2 + 4*L5*m1*m7*phi5p^2 + 4*L5*m2*m6*phi5p^2 + 2*L5*m3*m5*phi5p^2 + 4*L4*m3*m8*phi4p^2 + 4*L5*m1*m8*phi5p^2 + 4*L5*m2*m7*phi5p^2 + 4*L5*m3*m6*phi5p^2 + 2*L6*m1*m6*phi6p^2 + 4*L5*m2*m8*phi5p^2 + 4*L5*m3*m7*phi5p^2 + 4*L6*m1*m7*phi6p^2 + 2*L6*m2*m6*phi6p^2 + 4*L5*m3*m8*phi5p^2 + 4*L6*m1*m8*phi6p^2 + 4*L6*m2*m7*phi6p^2 + 2*L6*m3*m6*phi6p^2 + 4*L6*m2*m8*phi6p^2 + 4*L6*m3*m7*phi6p^2 + 2*L7*m1*m7*phi7p^2 + 4*L6*m3*m8*phi6p^2 + 4*L7*m1*m8*phi7p^2 + 2*L7*m2*m7*phi7p^2 + 4*L7*m2*m8*phi7p^2 + 2*L7*m3*m7*phi7p^2 + 4*L7*m3*m8*phi7p^2 + 2*L8*m1*m8*phi8p^2 + 2*L8*m2*m8*phi8p^2 + 2*L8*m3*m8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
              -(2*force13*m1 - 2*force1*m6 - 2*force1*m7 - 2*force1*m8 - 2*force4*m5 - 2*force4*m6 - 2*force4*m7 - 2*force4*m8 - 2*force7*m5 - 2*force7*m6 - 2*force7*m7 - 2*force1*m5 - 2*force7*m8 - 2*force10*m5 + 2*force13*m2 - 2*force10*m6 + 2*force13*m3 - 2*force10*m7 + 2*force13*m4 + 2*force16*m1 - 2*force10*m8 + 2*force16*m2 + 2*force16*m3 + 2*force16*m4 + 2*force19*m1 + 2*force19*m2 + 2*force19*m3 + 2*force19*m4 + 2*force22*m1 + 2*force22*m2 + 2*force22*m3 + 2*force22*m4 - m1*m5*u1b - m1*m6*u1b - m2*m5*u1b - m1*m7*u1b - m2*m5*u2b - m2*m6*u1b + m1*m5*u4b - m1*m8*u1b - m2*m6*u2b - m2*m7*u1b - m3*m5*u2b + m1*m5*u5b + m2*m5*u4b - m2*m7*u2b - m2*m8*u1b - m3*m5*u3b - m3*m6*u2b + m1*m6*u5b + m2*m5*u5b - m2*m8*u2b + m3*m5*u4b - m3*m6*u3b - m3*m7*u2b - m4*m5*u3b + m1*m6*u6b + m2*m6*u5b + m3*m5*u5b - m3*m7*u3b - m3*m8*u2b - m4*m6*u3b + m1*m7*u6b + m2*m6*u6b + m3*m6*u5b - m3*m8*u3b + m4*m5*u5b - m4*m6*u4b - m4*m7*u3b + m1*m7*u7b + m2*m7*u6b + m3*m6*u6b + m4*m6*u5b - m4*m7*u4b - m4*m8*u3b + m1*m8*u7b + m2*m7*u7b + m3*m7*u6b + m4*m6*u6b - m4*m8*u4b + m2*m8*u7b + m3*m7*u7b + m4*m7*u6b + m3*m8*u7b + m4*m7*u7b + m4*m8*u7b + 2*L1*m1*m5*phi1*phi1p^2 + 2*L1*m1*m6*phi1*phi1p^2 + 2*L1*m1*m7*phi1*phi1p^2 + 2*L1*m1*m8*phi1*phi1p^2 + 4*L2*m1*m5*phi2*phi2p^2 + 4*L2*m1*m6*phi2*phi2p^2 + 2*L2*m2*m5*phi2*phi2p^2 + 4*L2*m1*m7*phi2*phi2p^2 + 2*L2*m2*m6*phi2*phi2p^2 + 4*L2*m1*m8*phi2*phi2p^2 + 2*L2*m2*m7*phi2*phi2p^2 + 4*L3*m1*m5*phi3*phi3p^2 + 2*L2*m2*m8*phi2*phi2p^2 + 4*L3*m1*m6*phi3*phi3p^2 + 4*L3*m2*m5*phi3*phi3p^2 + 4*L3*m1*m7*phi3*phi3p^2 + 4*L3*m2*m6*phi3*phi3p^2 + 2*L3*m3*m5*phi3*phi3p^2 + 4*L3*m1*m8*phi3*phi3p^2 + 4*L3*m2*m7*phi3*phi3p^2 + 2*L3*m3*m6*phi3*phi3p^2 + 4*L4*m1*m5*phi4*phi4p^2 + 4*L3*m2*m8*phi3*phi3p^2 + 2*L3*m3*m7*phi3*phi3p^2 + 4*L4*m1*m6*phi4*phi4p^2 + 4*L4*m2*m5*phi4*phi4p^2 + 2*L3*m3*m8*phi3*phi3p^2 + 4*L4*m1*m7*phi4*phi4p^2 + 4*L4*m2*m6*phi4*phi4p^2 + 4*L4*m3*m5*phi4*phi4p^2 + 4*L4*m1*m8*phi4*phi4p^2 + 4*L4*m2*m7*phi4*phi4p^2 + 4*L4*m3*m6*phi4*phi4p^2 + 2*L4*m4*m5*phi4*phi4p^2 + 2*L5*m1*m5*phi5*phi5p^2 + 4*L4*m2*m8*phi4*phi4p^2 + 4*L4*m3*m7*phi4*phi4p^2 + 2*L4*m4*m6*phi4*phi4p^2 + 4*L5*m1*m6*phi5*phi5p^2 + 2*L5*m2*m5*phi5*phi5p^2 + 4*L4*m3*m8*phi4*phi4p^2 + 2*L4*m4*m7*phi4*phi4p^2 + 4*L5*m1*m7*phi5*phi5p^2 + 4*L5*m2*m6*phi5*phi5p^2 + 2*L5*m3*m5*phi5*phi5p^2 + 2*L4*m4*m8*phi4*phi4p^2 + 4*L5*m1*m8*phi5*phi5p^2 + 4*L5*m2*m7*phi5*phi5p^2 + 4*L5*m3*m6*phi5*phi5p^2 + 2*L5*m4*m5*phi5*phi5p^2 + 4*L5*m2*m8*phi5*phi5p^2 + 4*L5*m3*m7*phi5*phi5p^2 + 4*L5*m4*m6*phi5*phi5p^2 + 2*L6*m1*m6*phi6*phi6p^2 + 4*L5*m3*m8*phi5*phi5p^2 + 4*L5*m4*m7*phi5*phi5p^2 + 4*L6*m1*m7*phi6*phi6p^2 + 2*L6*m2*m6*phi6*phi6p^2 + 4*L5*m4*m8*phi5*phi5p^2 + 4*L6*m1*m8*phi6*phi6p^2 + 4*L6*m2*m7*phi6*phi6p^2 + 2*L6*m3*m6*phi6*phi6p^2 + 4*L6*m2*m8*phi6*phi6p^2 + 4*L6*m3*m7*phi6*phi6p^2 + 2*L6*m4*m6*phi6*phi6p^2 + 4*L6*m3*m8*phi6*phi6p^2 + 4*L6*m4*m7*phi6*phi6p^2 + 2*L7*m1*m7*phi7*phi7p^2 + 4*L6*m4*m8*phi6*phi6p^2 + 4*L7*m1*m8*phi7*phi7p^2 + 2*L7*m2*m7*phi7*phi7p^2 + 4*L7*m2*m8*phi7*phi7p^2 + 2*L7*m3*m7*phi7*phi7p^2 + 4*L7*m3*m8*phi7*phi7p^2 + 2*L7*m4*m7*phi7*phi7p^2 + 4*L7*m4*m8*phi7*phi7p^2 + 2*L8*m1*m8*phi8*phi8p^2 + 2*L8*m2*m8*phi8*phi8p^2 + 2*L8*m3*m8*phi8*phi8p^2 + 2*L8*m4*m8*phi8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
               (2*force2*m5 + 2*force2*m6 + 2*force2*m7 + 2*force2*m8 + 2*force5*m5 + 2*force5*m6 + 2*force5*m7 + 2*force5*m8 + 2*force8*m5 + 2*force8*m6 + 2*force8*m7 - 2*force14*m1 + 2*force8*m8 + 2*force11*m5 - 2*force14*m2 + 2*force11*m6 - 2*force14*m3 + 2*force11*m7 - 2*force14*m4 - 2*force17*m1 + 2*force11*m8 - 2*force17*m2 - 2*force17*m3 - 2*force17*m4 - 2*force20*m1 - 2*force20*m2 - 2*force20*m3 - 2*force20*m4 - 2*force23*m1 - 2*force23*m2 - 2*force23*m3 - 2*force23*m4 - m1*m5*phi1*u1b + 2*m1*m5*phi2*u1b - m1*m6*phi1*u1b - 2*m1*m5*phi2*u2b + 2*m1*m6*phi2*u1b - m1*m7*phi1*u1b + m2*m5*phi2*u1b + 2*m1*m5*phi3*u2b - 2*m1*m6*phi2*u2b + 2*m1*m7*phi2*u1b - m1*m8*phi1*u1b - m2*m5*phi2*u2b + m2*m6*phi2*u1b - 2*m1*m5*phi3*u3b + 2*m1*m6*phi3*u2b - 2*m1*m7*phi2*u2b + 2*m1*m8*phi2*u1b + 2*m2*m5*phi3*u2b - m2*m6*phi2*u2b + m2*m7*phi2*u1b + 2*m1*m5*phi4*u3b - 2*m1*m6*phi3*u3b + 2*m1*m7*phi3*u2b - 2*m1*m8*phi2*u2b - 2*m2*m5*phi3*u3b + 2*m2*m6*phi3*u2b - m2*m7*phi2*u2b + m2*m8*phi2*u1b + m3*m5*phi3*u2b - 2*m1*m5*phi4*u4b + 2*m1*m6*phi4*u3b - 2*m1*m7*phi3*u3b + 2*m1*m8*phi3*u2b + 2*m2*m5*phi4*u3b - 2*m2*m6*phi3*u3b + 2*m2*m7*phi3*u2b - m2*m8*phi2*u2b - m3*m5*phi3*u3b + m3*m6*phi3*u2b + m1*m5*phi5*u4b - 2*m1*m6*phi4*u4b + 2*m1*m7*phi4*u3b - 2*m1*m8*phi3*u3b - 2*m2*m5*phi4*u4b + 2*m2*m6*phi4*u3b - 2*m2*m7*phi3*u3b + 2*m2*m8*phi3*u2b + 2*m3*m5*phi4*u3b - m3*m6*phi3*u3b + m3*m7*phi3*u2b - m1*m5*phi5*u5b + 2*m1*m6*phi5*u4b - 2*m1*m7*phi4*u4b + 2*m1*m8*phi4*u3b + m2*m5*phi5*u4b - 2*m2*m6*phi4*u4b + 2*m2*m7*phi4*u3b - 2*m2*m8*phi3*u3b - 2*m3*m5*phi4*u4b + 2*m3*m6*phi4*u3b - m3*m7*phi3*u3b + m3*m8*phi3*u2b + m4*m5*phi4*u3b - 2*m1*m6*phi5*u5b + 2*m1*m7*phi5*u4b - 2*m1*m8*phi4*u4b - m2*m5*phi5*u5b + 2*m2*m6*phi5*u4b - 2*m2*m7*phi4*u4b + 2*m2*m8*phi4*u3b + m3*m5*phi5*u4b - 2*m3*m6*phi4*u4b + 2*m3*m7*phi4*u3b - m3*m8*phi3*u3b - m4*m5*phi4*u4b + m4*m6*phi4*u3b + m1*m6*phi6*u5b - 2*m1*m7*phi5*u5b + 2*m1*m8*phi5*u4b - 2*m2*m6*phi5*u5b + 2*m2*m7*phi5*u4b - 2*m2*m8*phi4*u4b - m3*m5*phi5*u5b + 2*m3*m6*phi5*u4b - 2*m3*m7*phi4*u4b + 2*m3*m8*phi4*u3b + m4*m5*phi5*u4b - m4*m6*phi4*u4b + m4*m7*phi4*u3b - m1*m6*phi6*u6b + 2*m1*m7*phi6*u5b - 2*m1*m8*phi5*u5b + m2*m6*phi6*u5b - 2*m2*m7*phi5*u5b + 2*m2*m8*phi5*u4b - 2*m3*m6*phi5*u5b + 2*m3*m7*phi5*u4b - 2*m3*m8*phi4*u4b - m4*m5*phi5*u5b + 2*m4*m6*phi5*u4b - m4*m7*phi4*u4b + m4*m8*phi4*u3b - 2*m1*m7*phi6*u6b + 2*m1*m8*phi6*u5b - m2*m6*phi6*u6b + 2*m2*m7*phi6*u5b - 2*m2*m8*phi5*u5b + m3*m6*phi6*u5b - 2*m3*m7*phi5*u5b + 2*m3*m8*phi5*u4b - 2*m4*m6*phi5*u5b + 2*m4*m7*phi5*u4b - m4*m8*phi4*u4b + m1*m7*phi7*u6b - 2*m1*m8*phi6*u6b - 2*m2*m7*phi6*u6b + 2*m2*m8*phi6*u5b - m3*m6*phi6*u6b + 2*m3*m7*phi6*u5b - 2*m3*m8*phi5*u5b + m4*m6*phi6*u5b - 2*m4*m7*phi5*u5b + 2*m4*m8*phi5*u4b - m1*m7*phi7*u7b + 2*m1*m8*phi7*u6b + m2*m7*phi7*u6b - 2*m2*m8*phi6*u6b - 2*m3*m7*phi6*u6b + 2*m3*m8*phi6*u5b - m4*m6*phi6*u6b + 2*m4*m7*phi6*u5b - 2*m4*m8*phi5*u5b - 2*m1*m8*phi7*u7b - m2*m7*phi7*u7b + 2*m2*m8*phi7*u6b + m3*m7*phi7*u6b - 2*m3*m8*phi6*u6b - 2*m4*m7*phi6*u6b + 2*m4*m8*phi6*u5b + m1*m8*phi8*u7b - 2*m2*m8*phi7*u7b - m3*m7*phi7*u7b + 2*m3*m8*phi7*u6b + m4*m7*phi7*u6b - 2*m4*m8*phi6*u6b + m2*m8*phi8*u7b - 2*m3*m8*phi7*u7b - m4*m7*phi7*u7b + 2*m4*m8*phi7*u6b + m3*m8*phi8*u7b - 2*m4*m8*phi7*u7b + m4*m8*phi8*u7b + 2*L1*m1*m5*phi1p^2 + 2*L1*m1*m6*phi1p^2 + 2*L1*m1*m7*phi1p^2 + 4*L2*m1*m5*phi2p^2 + 2*L1*m1*m8*phi1p^2 + 4*L2*m1*m6*phi2p^2 + 2*L2*m2*m5*phi2p^2 + 4*L2*m1*m7*phi2p^2 + 2*L2*m2*m6*phi2p^2 + 4*L3*m1*m5*phi3p^2 + 4*L2*m1*m8*phi2p^2 + 2*L2*m2*m7*phi2p^2 + 4*L3*m1*m6*phi3p^2 + 4*L3*m2*m5*phi3p^2 + 2*L2*m2*m8*phi2p^2 + 4*L3*m1*m7*phi3p^2 + 4*L3*m2*m6*phi3p^2 + 2*L3*m3*m5*phi3p^2 + 4*L4*m1*m5*phi4p^2 + 4*L3*m1*m8*phi3p^2 + 4*L3*m2*m7*phi3p^2 + 2*L3*m3*m6*phi3p^2 + 4*L4*m1*m6*phi4p^2 + 4*L4*m2*m5*phi4p^2 + 4*L3*m2*m8*phi3p^2 + 2*L3*m3*m7*phi3p^2 + 4*L4*m1*m7*phi4p^2 + 4*L4*m2*m6*phi4p^2 + 4*L4*m3*m5*phi4p^2 + 2*L5*m1*m5*phi5p^2 + 2*L3*m3*m8*phi3p^2 + 4*L4*m1*m8*phi4p^2 + 4*L4*m2*m7*phi4p^2 + 4*L4*m3*m6*phi4p^2 + 2*L4*m4*m5*phi4p^2 + 4*L5*m1*m6*phi5p^2 + 2*L5*m2*m5*phi5p^2 + 4*L4*m2*m8*phi4p^2 + 4*L4*m3*m7*phi4p^2 + 2*L4*m4*m6*phi4p^2 + 4*L5*m1*m7*phi5p^2 + 4*L5*m2*m6*phi5p^2 + 2*L5*m3*m5*phi5p^2 + 4*L4*m3*m8*phi4p^2 + 2*L4*m4*m7*phi4p^2 + 4*L5*m1*m8*phi5p^2 + 4*L5*m2*m7*phi5p^2 + 4*L5*m3*m6*phi5p^2 + 2*L5*m4*m5*phi5p^2 + 2*L6*m1*m6*phi6p^2 + 2*L4*m4*m8*phi4p^2 + 4*L5*m2*m8*phi5p^2 + 4*L5*m3*m7*phi5p^2 + 4*L5*m4*m6*phi5p^2 + 4*L6*m1*m7*phi6p^2 + 2*L6*m2*m6*phi6p^2 + 4*L5*m3*m8*phi5p^2 + 4*L5*m4*m7*phi5p^2 + 4*L6*m1*m8*phi6p^2 + 4*L6*m2*m7*phi6p^2 + 2*L6*m3*m6*phi6p^2 + 4*L5*m4*m8*phi5p^2 + 4*L6*m2*m8*phi6p^2 + 4*L6*m3*m7*phi6p^2 + 2*L6*m4*m6*phi6p^2 + 2*L7*m1*m7*phi7p^2 + 4*L6*m3*m8*phi6p^2 + 4*L6*m4*m7*phi6p^2 + 4*L7*m1*m8*phi7p^2 + 2*L7*m2*m7*phi7p^2 + 4*L6*m4*m8*phi6p^2 + 4*L7*m2*m8*phi7p^2 + 2*L7*m3*m7*phi7p^2 + 4*L7*m3*m8*phi7p^2 + 2*L7*m4*m7*phi7p^2 + 2*L8*m1*m8*phi8p^2 + 4*L7*m4*m8*phi7p^2 + 2*L8*m2*m8*phi8p^2 + 2*L8*m3*m8*phi8p^2 + 2*L8*m4*m8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
              -(2*force16*m1 - 2*force1*m7 - 2*force1*m8 - 2*force4*m6 - 2*force4*m7 - 2*force4*m8 - 2*force7*m6 - 2*force7*m7 - 2*force7*m8 - 2*force10*m6 - 2*force10*m7 - 2*force1*m6 - 2*force10*m8 + 2*force16*m2 - 2*force13*m6 + 2*force16*m3 - 2*force13*m7 + 2*force16*m4 + 2*force19*m1 - 2*force13*m8 + 2*force16*m5 + 2*force19*m2 + 2*force19*m3 + 2*force19*m4 + 2*force22*m1 + 2*force19*m5 + 2*force22*m2 + 2*force22*m3 + 2*force22*m4 + 2*force22*m5 - m1*m6*u1b - m1*m7*u1b - m2*m6*u1b - m1*m8*u1b - m2*m6*u2b - m2*m7*u1b - m2*m7*u2b - m2*m8*u1b - m3*m6*u2b + m1*m6*u5b - m2*m8*u2b - m3*m6*u3b - m3*m7*u2b + m1*m6*u6b + m2*m6*u5b - m3*m7*u3b - m3*m8*u2b - m4*m6*u3b + m1*m7*u6b + m2*m6*u6b + m3*m6*u5b - m3*m8*u3b - m4*m6*u4b - m4*m7*u3b + m1*m7*u7b + m2*m7*u6b + m3*m6*u6b + m4*m6*u5b - m4*m7*u4b - m4*m8*u3b - m5*m6*u4b + m1*m8*u7b + m2*m7*u7b + m3*m7*u6b + m4*m6*u6b - m4*m8*u4b - m5*m7*u4b + m2*m8*u7b + m3*m7*u7b + m4*m7*u6b + m5*m6*u6b - m5*m7*u5b - m5*m8*u4b + m3*m8*u7b + m4*m7*u7b + m5*m7*u6b - m5*m8*u5b + m4*m8*u7b + m5*m7*u7b + m5*m8*u7b + 2*L1*m1*m6*phi1*phi1p^2 + 2*L1*m1*m7*phi1*phi1p^2 + 2*L1*m1*m8*phi1*phi1p^2 + 4*L2*m1*m6*phi2*phi2p^2 + 4*L2*m1*m7*phi2*phi2p^2 + 2*L2*m2*m6*phi2*phi2p^2 + 4*L2*m1*m8*phi2*phi2p^2 + 2*L2*m2*m7*phi2*phi2p^2 + 2*L2*m2*m8*phi2*phi2p^2 + 4*L3*m1*m6*phi3*phi3p^2 + 4*L3*m1*m7*phi3*phi3p^2 + 4*L3*m2*m6*phi3*phi3p^2 + 4*L3*m1*m8*phi3*phi3p^2 + 4*L3*m2*m7*phi3*phi3p^2 + 2*L3*m3*m6*phi3*phi3p^2 + 4*L3*m2*m8*phi3*phi3p^2 + 2*L3*m3*m7*phi3*phi3p^2 + 4*L4*m1*m6*phi4*phi4p^2 + 2*L3*m3*m8*phi3*phi3p^2 + 4*L4*m1*m7*phi4*phi4p^2 + 4*L4*m2*m6*phi4*phi4p^2 + 4*L4*m1*m8*phi4*phi4p^2 + 4*L4*m2*m7*phi4*phi4p^2 + 4*L4*m3*m6*phi4*phi4p^2 + 4*L4*m2*m8*phi4*phi4p^2 + 4*L4*m3*m7*phi4*phi4p^2 + 2*L4*m4*m6*phi4*phi4p^2 + 4*L5*m1*m6*phi5*phi5p^2 + 4*L4*m3*m8*phi4*phi4p^2 + 2*L4*m4*m7*phi4*phi4p^2 + 4*L5*m1*m7*phi5*phi5p^2 + 4*L5*m2*m6*phi5*phi5p^2 + 2*L4*m4*m8*phi4*phi4p^2 + 4*L5*m1*m8*phi5*phi5p^2 + 4*L5*m2*m7*phi5*phi5p^2 + 4*L5*m3*m6*phi5*phi5p^2 + 4*L5*m2*m8*phi5*phi5p^2 + 4*L5*m3*m7*phi5*phi5p^2 + 4*L5*m4*m6*phi5*phi5p^2 + 2*L6*m1*m6*phi6*phi6p^2 + 4*L5*m3*m8*phi5*phi5p^2 + 4*L5*m4*m7*phi5*phi5p^2 + 2*L5*m5*m6*phi5*phi5p^2 + 4*L6*m1*m7*phi6*phi6p^2 + 2*L6*m2*m6*phi6*phi6p^2 + 4*L5*m4*m8*phi5*phi5p^2 + 2*L5*m5*m7*phi5*phi5p^2 + 4*L6*m1*m8*phi6*phi6p^2 + 4*L6*m2*m7*phi6*phi6p^2 + 2*L6*m3*m6*phi6*phi6p^2 + 2*L5*m5*m8*phi5*phi5p^2 + 4*L6*m2*m8*phi6*phi6p^2 + 4*L6*m3*m7*phi6*phi6p^2 + 2*L6*m4*m6*phi6*phi6p^2 + 4*L6*m3*m8*phi6*phi6p^2 + 4*L6*m4*m7*phi6*phi6p^2 + 2*L6*m5*m6*phi6*phi6p^2 + 2*L7*m1*m7*phi7*phi7p^2 + 4*L6*m4*m8*phi6*phi6p^2 + 4*L6*m5*m7*phi6*phi6p^2 + 4*L7*m1*m8*phi7*phi7p^2 + 2*L7*m2*m7*phi7*phi7p^2 + 4*L6*m5*m8*phi6*phi6p^2 + 4*L7*m2*m8*phi7*phi7p^2 + 2*L7*m3*m7*phi7*phi7p^2 + 4*L7*m3*m8*phi7*phi7p^2 + 2*L7*m4*m7*phi7*phi7p^2 + 4*L7*m4*m8*phi7*phi7p^2 + 2*L7*m5*m7*phi7*phi7p^2 + 2*L8*m1*m8*phi8*phi8p^2 + 4*L7*m5*m8*phi7*phi7p^2 + 2*L8*m2*m8*phi8*phi8p^2 + 2*L8*m3*m8*phi8*phi8p^2 + 2*L8*m4*m8*phi8*phi8p^2 + 2*L8*m5*m8*phi8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
               (2*force2*m6 + 2*force2*m7 + 2*force2*m8 + 2*force5*m6 + 2*force5*m7 + 2*force5*m8 + 2*force8*m6 + 2*force8*m7 + 2*force8*m8 + 2*force11*m6 + 2*force11*m7 - 2*force17*m1 + 2*force11*m8 - 2*force17*m2 + 2*force14*m6 - 2*force17*m3 + 2*force14*m7 - 2*force17*m4 - 2*force20*m1 + 2*force14*m8 - 2*force17*m5 - 2*force20*m2 - 2*force20*m3 - 2*force20*m4 - 2*force23*m1 - 2*force20*m5 - 2*force23*m2 - 2*force23*m3 - 2*force23*m4 - 2*force23*m5 - m1*m6*phi1*u1b + 2*m1*m6*phi2*u1b - m1*m7*phi1*u1b - 2*m1*m6*phi2*u2b + 2*m1*m7*phi2*u1b - m1*m8*phi1*u1b + m2*m6*phi2*u1b + 2*m1*m6*phi3*u2b - 2*m1*m7*phi2*u2b + 2*m1*m8*phi2*u1b - m2*m6*phi2*u2b + m2*m7*phi2*u1b - 2*m1*m6*phi3*u3b + 2*m1*m7*phi3*u2b - 2*m1*m8*phi2*u2b + 2*m2*m6*phi3*u2b - m2*m7*phi2*u2b + m2*m8*phi2*u1b + 2*m1*m6*phi4*u3b - 2*m1*m7*phi3*u3b + 2*m1*m8*phi3*u2b - 2*m2*m6*phi3*u3b + 2*m2*m7*phi3*u2b - m2*m8*phi2*u2b + m3*m6*phi3*u2b - 2*m1*m6*phi4*u4b + 2*m1*m7*phi4*u3b - 2*m1*m8*phi3*u3b + 2*m2*m6*phi4*u3b - 2*m2*m7*phi3*u3b + 2*m2*m8*phi3*u2b - m3*m6*phi3*u3b + m3*m7*phi3*u2b + 2*m1*m6*phi5*u4b - 2*m1*m7*phi4*u4b + 2*m1*m8*phi4*u3b - 2*m2*m6*phi4*u4b + 2*m2*m7*phi4*u3b - 2*m2*m8*phi3*u3b + 2*m3*m6*phi4*u3b - m3*m7*phi3*u3b + m3*m8*phi3*u2b - 2*m1*m6*phi5*u5b + 2*m1*m7*phi5*u4b - 2*m1*m8*phi4*u4b + 2*m2*m6*phi5*u4b - 2*m2*m7*phi4*u4b + 2*m2*m8*phi4*u3b - 2*m3*m6*phi4*u4b + 2*m3*m7*phi4*u3b - m3*m8*phi3*u3b + m4*m6*phi4*u3b + m1*m6*phi6*u5b - 2*m1*m7*phi5*u5b + 2*m1*m8*phi5*u4b - 2*m2*m6*phi5*u5b + 2*m2*m7*phi5*u4b - 2*m2*m8*phi4*u4b + 2*m3*m6*phi5*u4b - 2*m3*m7*phi4*u4b + 2*m3*m8*phi4*u3b - m4*m6*phi4*u4b + m4*m7*phi4*u3b - m1*m6*phi6*u6b + 2*m1*m7*phi6*u5b - 2*m1*m8*phi5*u5b + m2*m6*phi6*u5b - 2*m2*m7*phi5*u5b + 2*m2*m8*phi5*u4b - 2*m3*m6*phi5*u5b + 2*m3*m7*phi5*u4b - 2*m3*m8*phi4*u4b + 2*m4*m6*phi5*u4b - m4*m7*phi4*u4b + m4*m8*phi4*u3b - 2*m1*m7*phi6*u6b + 2*m1*m8*phi6*u5b - m2*m6*phi6*u6b + 2*m2*m7*phi6*u5b - 2*m2*m8*phi5*u5b + m3*m6*phi6*u5b - 2*m3*m7*phi5*u5b + 2*m3*m8*phi5*u4b - 2*m4*m6*phi5*u5b + 2*m4*m7*phi5*u4b - m4*m8*phi4*u4b + m5*m6*phi5*u4b + m1*m7*phi7*u6b - 2*m1*m8*phi6*u6b - 2*m2*m7*phi6*u6b + 2*m2*m8*phi6*u5b - m3*m6*phi6*u6b + 2*m3*m7*phi6*u5b - 2*m3*m8*phi5*u5b + m4*m6*phi6*u5b - 2*m4*m7*phi5*u5b + 2*m4*m8*phi5*u4b - m5*m6*phi5*u5b + m5*m7*phi5*u4b - m1*m7*phi7*u7b + 2*m1*m8*phi7*u6b + m2*m7*phi7*u6b - 2*m2*m8*phi6*u6b - 2*m3*m7*phi6*u6b + 2*m3*m8*phi6*u5b - m4*m6*phi6*u6b + 2*m4*m7*phi6*u5b - 2*m4*m8*phi5*u5b + m5*m6*phi6*u5b - m5*m7*phi5*u5b + m5*m8*phi5*u4b - 2*m1*m8*phi7*u7b - m2*m7*phi7*u7b + 2*m2*m8*phi7*u6b + m3*m7*phi7*u6b - 2*m3*m8*phi6*u6b - 2*m4*m7*phi6*u6b + 2*m4*m8*phi6*u5b - m5*m6*phi6*u6b + 2*m5*m7*phi6*u5b - m5*m8*phi5*u5b + m1*m8*phi8*u7b - 2*m2*m8*phi7*u7b - m3*m7*phi7*u7b + 2*m3*m8*phi7*u6b + m4*m7*phi7*u6b - 2*m4*m8*phi6*u6b - 2*m5*m7*phi6*u6b + 2*m5*m8*phi6*u5b + m2*m8*phi8*u7b - 2*m3*m8*phi7*u7b - m4*m7*phi7*u7b + 2*m4*m8*phi7*u6b + m5*m7*phi7*u6b - 2*m5*m8*phi6*u6b + m3*m8*phi8*u7b - 2*m4*m8*phi7*u7b - m5*m7*phi7*u7b + 2*m5*m8*phi7*u6b + m4*m8*phi8*u7b - 2*m5*m8*phi7*u7b + m5*m8*phi8*u7b + 2*L1*m1*m6*phi1p^2 + 2*L1*m1*m7*phi1p^2 + 2*L1*m1*m8*phi1p^2 + 4*L2*m1*m6*phi2p^2 + 4*L2*m1*m7*phi2p^2 + 2*L2*m2*m6*phi2p^2 + 4*L2*m1*m8*phi2p^2 + 2*L2*m2*m7*phi2p^2 + 4*L3*m1*m6*phi3p^2 + 2*L2*m2*m8*phi2p^2 + 4*L3*m1*m7*phi3p^2 + 4*L3*m2*m6*phi3p^2 + 4*L3*m1*m8*phi3p^2 + 4*L3*m2*m7*phi3p^2 + 2*L3*m3*m6*phi3p^2 + 4*L4*m1*m6*phi4p^2 + 4*L3*m2*m8*phi3p^2 + 2*L3*m3*m7*phi3p^2 + 4*L4*m1*m7*phi4p^2 + 4*L4*m2*m6*phi4p^2 + 2*L3*m3*m8*phi3p^2 + 4*L4*m1*m8*phi4p^2 + 4*L4*m2*m7*phi4p^2 + 4*L4*m3*m6*phi4p^2 + 4*L5*m1*m6*phi5p^2 + 4*L4*m2*m8*phi4p^2 + 4*L4*m3*m7*phi4p^2 + 2*L4*m4*m6*phi4p^2 + 4*L5*m1*m7*phi5p^2 + 4*L5*m2*m6*phi5p^2 + 4*L4*m3*m8*phi4p^2 + 2*L4*m4*m7*phi4p^2 + 4*L5*m1*m8*phi5p^2 + 4*L5*m2*m7*phi5p^2 + 4*L5*m3*m6*phi5p^2 + 2*L6*m1*m6*phi6p^2 + 2*L4*m4*m8*phi4p^2 + 4*L5*m2*m8*phi5p^2 + 4*L5*m3*m7*phi5p^2 + 4*L5*m4*m6*phi5p^2 + 4*L6*m1*m7*phi6p^2 + 2*L6*m2*m6*phi6p^2 + 4*L5*m3*m8*phi5p^2 + 4*L5*m4*m7*phi5p^2 + 2*L5*m5*m6*phi5p^2 + 4*L6*m1*m8*phi6p^2 + 4*L6*m2*m7*phi6p^2 + 2*L6*m3*m6*phi6p^2 + 4*L5*m4*m8*phi5p^2 + 2*L5*m5*m7*phi5p^2 + 4*L6*m2*m8*phi6p^2 + 4*L6*m3*m7*phi6p^2 + 2*L6*m4*m6*phi6p^2 + 2*L7*m1*m7*phi7p^2 + 2*L5*m5*m8*phi5p^2 + 4*L6*m3*m8*phi6p^2 + 4*L6*m4*m7*phi6p^2 + 2*L6*m5*m6*phi6p^2 + 4*L7*m1*m8*phi7p^2 + 2*L7*m2*m7*phi7p^2 + 4*L6*m4*m8*phi6p^2 + 4*L6*m5*m7*phi6p^2 + 4*L7*m2*m8*phi7p^2 + 2*L7*m3*m7*phi7p^2 + 4*L6*m5*m8*phi6p^2 + 4*L7*m3*m8*phi7p^2 + 2*L7*m4*m7*phi7p^2 + 2*L8*m1*m8*phi8p^2 + 4*L7*m4*m8*phi7p^2 + 2*L7*m5*m7*phi7p^2 + 2*L8*m2*m8*phi8p^2 + 4*L7*m5*m8*phi7p^2 + 2*L8*m3*m8*phi8p^2 + 2*L8*m4*m8*phi8p^2 + 2*L8*m5*m8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
              -(2*force19*m1 - 2*force1*m8 - 2*force4*m7 - 2*force4*m8 - 2*force7*m7 - 2*force7*m8 - 2*force10*m7 - 2*force10*m8 - 2*force13*m7 - 2*force1*m7 - 2*force13*m8 + 2*force19*m2 + 2*force19*m3 - 2*force16*m7 + 2*force19*m4 + 2*force22*m1 - 2*force16*m8 + 2*force19*m5 + 2*force22*m2 + 2*force19*m6 + 2*force22*m3 + 2*force22*m4 + 2*force22*m5 + 2*force22*m6 - m1*m7*u1b - m1*m8*u1b - m2*m7*u1b - m2*m7*u2b - m2*m8*u1b - m2*m8*u2b - m3*m7*u2b - m3*m7*u3b - m3*m8*u2b + m1*m7*u6b - m3*m8*u3b - m4*m7*u3b + m1*m7*u7b + m2*m7*u6b - m4*m7*u4b - m4*m8*u3b + m1*m8*u7b + m2*m7*u7b + m3*m7*u6b - m4*m8*u4b - m5*m7*u4b + m2*m8*u7b + m3*m7*u7b + m4*m7*u6b - m5*m7*u5b - m5*m8*u4b + m3*m8*u7b + m4*m7*u7b + m5*m7*u6b - m5*m8*u5b - m6*m7*u5b + m4*m8*u7b + m5*m7*u7b - m6*m8*u5b + m5*m8*u7b + m6*m7*u7b - m6*m8*u6b + m6*m8*u7b + 2*L1*m1*m7*phi1*phi1p^2 + 2*L1*m1*m8*phi1*phi1p^2 + 4*L2*m1*m7*phi2*phi2p^2 + 4*L2*m1*m8*phi2*phi2p^2 + 2*L2*m2*m7*phi2*phi2p^2 + 2*L2*m2*m8*phi2*phi2p^2 + 4*L3*m1*m7*phi3*phi3p^2 + 4*L3*m1*m8*phi3*phi3p^2 + 4*L3*m2*m7*phi3*phi3p^2 + 4*L3*m2*m8*phi3*phi3p^2 + 2*L3*m3*m7*phi3*phi3p^2 + 2*L3*m3*m8*phi3*phi3p^2 + 4*L4*m1*m7*phi4*phi4p^2 + 4*L4*m1*m8*phi4*phi4p^2 + 4*L4*m2*m7*phi4*phi4p^2 + 4*L4*m2*m8*phi4*phi4p^2 + 4*L4*m3*m7*phi4*phi4p^2 + 4*L4*m3*m8*phi4*phi4p^2 + 2*L4*m4*m7*phi4*phi4p^2 + 4*L5*m1*m7*phi5*phi5p^2 + 2*L4*m4*m8*phi4*phi4p^2 + 4*L5*m1*m8*phi5*phi5p^2 + 4*L5*m2*m7*phi5*phi5p^2 + 4*L5*m2*m8*phi5*phi5p^2 + 4*L5*m3*m7*phi5*phi5p^2 + 4*L5*m3*m8*phi5*phi5p^2 + 4*L5*m4*m7*phi5*phi5p^2 + 4*L6*m1*m7*phi6*phi6p^2 + 4*L5*m4*m8*phi5*phi5p^2 + 2*L5*m5*m7*phi5*phi5p^2 + 4*L6*m1*m8*phi6*phi6p^2 + 4*L6*m2*m7*phi6*phi6p^2 + 2*L5*m5*m8*phi5*phi5p^2 + 4*L6*m2*m8*phi6*phi6p^2 + 4*L6*m3*m7*phi6*phi6p^2 + 4*L6*m3*m8*phi6*phi6p^2 + 4*L6*m4*m7*phi6*phi6p^2 + 2*L7*m1*m7*phi7*phi7p^2 + 4*L6*m4*m8*phi6*phi6p^2 + 4*L6*m5*m7*phi6*phi6p^2 + 4*L7*m1*m8*phi7*phi7p^2 + 2*L7*m2*m7*phi7*phi7p^2 + 4*L6*m5*m8*phi6*phi6p^2 + 2*L6*m6*m7*phi6*phi6p^2 + 4*L7*m2*m8*phi7*phi7p^2 + 2*L7*m3*m7*phi7*phi7p^2 + 2*L6*m6*m8*phi6*phi6p^2 + 4*L7*m3*m8*phi7*phi7p^2 + 2*L7*m4*m7*phi7*phi7p^2 + 4*L7*m4*m8*phi7*phi7p^2 + 2*L7*m5*m7*phi7*phi7p^2 + 2*L8*m1*m8*phi8*phi8p^2 + 4*L7*m5*m8*phi7*phi7p^2 + 2*L7*m6*m7*phi7*phi7p^2 + 2*L8*m2*m8*phi8*phi8p^2 + 4*L7*m6*m8*phi7*phi7p^2 + 2*L8*m3*m8*phi8*phi8p^2 + 2*L8*m4*m8*phi8*phi8p^2 + 2*L8*m5*m8*phi8*phi8p^2 + 2*L8*m6*m8*phi8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
               (2*force2*m7 + 2*force2*m8 + 2*force5*m7 + 2*force5*m8 + 2*force8*m7 + 2*force8*m8 + 2*force11*m7 + 2*force11*m8 + 2*force14*m7 - 2*force20*m1 + 2*force14*m8 - 2*force20*m2 - 2*force20*m3 + 2*force17*m7 - 2*force20*m4 - 2*force23*m1 + 2*force17*m8 - 2*force20*m5 - 2*force23*m2 - 2*force20*m6 - 2*force23*m3 - 2*force23*m4 - 2*force23*m5 - 2*force23*m6 - m1*m7*phi1*u1b + 2*m1*m7*phi2*u1b - m1*m8*phi1*u1b - 2*m1*m7*phi2*u2b + 2*m1*m8*phi2*u1b + m2*m7*phi2*u1b + 2*m1*m7*phi3*u2b - 2*m1*m8*phi2*u2b - m2*m7*phi2*u2b + m2*m8*phi2*u1b - 2*m1*m7*phi3*u3b + 2*m1*m8*phi3*u2b + 2*m2*m7*phi3*u2b - m2*m8*phi2*u2b + 2*m1*m7*phi4*u3b - 2*m1*m8*phi3*u3b - 2*m2*m7*phi3*u3b + 2*m2*m8*phi3*u2b + m3*m7*phi3*u2b - 2*m1*m7*phi4*u4b + 2*m1*m8*phi4*u3b + 2*m2*m7*phi4*u3b - 2*m2*m8*phi3*u3b - m3*m7*phi3*u3b + m3*m8*phi3*u2b + 2*m1*m7*phi5*u4b - 2*m1*m8*phi4*u4b - 2*m2*m7*phi4*u4b + 2*m2*m8*phi4*u3b + 2*m3*m7*phi4*u3b - m3*m8*phi3*u3b - 2*m1*m7*phi5*u5b + 2*m1*m8*phi5*u4b + 2*m2*m7*phi5*u4b - 2*m2*m8*phi4*u4b - 2*m3*m7*phi4*u4b + 2*m3*m8*phi4*u3b + m4*m7*phi4*u3b + 2*m1*m7*phi6*u5b - 2*m1*m8*phi5*u5b - 2*m2*m7*phi5*u5b + 2*m2*m8*phi5*u4b + 2*m3*m7*phi5*u4b - 2*m3*m8*phi4*u4b - m4*m7*phi4*u4b + m4*m8*phi4*u3b - 2*m1*m7*phi6*u6b + 2*m1*m8*phi6*u5b + 2*m2*m7*phi6*u5b - 2*m2*m8*phi5*u5b - 2*m3*m7*phi5*u5b + 2*m3*m8*phi5*u4b + 2*m4*m7*phi5*u4b - m4*m8*phi4*u4b + m1*m7*phi7*u6b - 2*m1*m8*phi6*u6b - 2*m2*m7*phi6*u6b + 2*m2*m8*phi6*u5b + 2*m3*m7*phi6*u5b - 2*m3*m8*phi5*u5b - 2*m4*m7*phi5*u5b + 2*m4*m8*phi5*u4b + m5*m7*phi5*u4b - m1*m7*phi7*u7b + 2*m1*m8*phi7*u6b + m2*m7*phi7*u6b - 2*m2*m8*phi6*u6b - 2*m3*m7*phi6*u6b + 2*m3*m8*phi6*u5b + 2*m4*m7*phi6*u5b - 2*m4*m8*phi5*u5b - m5*m7*phi5*u5b + m5*m8*phi5*u4b - 2*m1*m8*phi7*u7b - m2*m7*phi7*u7b + 2*m2*m8*phi7*u6b + m3*m7*phi7*u6b - 2*m3*m8*phi6*u6b - 2*m4*m7*phi6*u6b + 2*m4*m8*phi6*u5b + 2*m5*m7*phi6*u5b - m5*m8*phi5*u5b + m1*m8*phi8*u7b - 2*m2*m8*phi7*u7b - m3*m7*phi7*u7b + 2*m3*m8*phi7*u6b + m4*m7*phi7*u6b - 2*m4*m8*phi6*u6b - 2*m5*m7*phi6*u6b + 2*m5*m8*phi6*u5b + m6*m7*phi6*u5b + m2*m8*phi8*u7b - 2*m3*m8*phi7*u7b - m4*m7*phi7*u7b + 2*m4*m8*phi7*u6b + m5*m7*phi7*u6b - 2*m5*m8*phi6*u6b - m6*m7*phi6*u6b + m6*m8*phi6*u5b + m3*m8*phi8*u7b - 2*m4*m8*phi7*u7b - m5*m7*phi7*u7b + 2*m5*m8*phi7*u6b + m6*m7*phi7*u6b - m6*m8*phi6*u6b + m4*m8*phi8*u7b - 2*m5*m8*phi7*u7b - m6*m7*phi7*u7b + 2*m6*m8*phi7*u6b + m5*m8*phi8*u7b - 2*m6*m8*phi7*u7b + m6*m8*phi8*u7b + 2*L1*m1*m7*phi1p^2 + 2*L1*m1*m8*phi1p^2 + 4*L2*m1*m7*phi2p^2 + 4*L2*m1*m8*phi2p^2 + 2*L2*m2*m7*phi2p^2 + 2*L2*m2*m8*phi2p^2 + 4*L3*m1*m7*phi3p^2 + 4*L3*m1*m8*phi3p^2 + 4*L3*m2*m7*phi3p^2 + 4*L3*m2*m8*phi3p^2 + 2*L3*m3*m7*phi3p^2 + 4*L4*m1*m7*phi4p^2 + 2*L3*m3*m8*phi3p^2 + 4*L4*m1*m8*phi4p^2 + 4*L4*m2*m7*phi4p^2 + 4*L4*m2*m8*phi4p^2 + 4*L4*m3*m7*phi4p^2 + 4*L5*m1*m7*phi5p^2 + 4*L4*m3*m8*phi4p^2 + 2*L4*m4*m7*phi4p^2 + 4*L5*m1*m8*phi5p^2 + 4*L5*m2*m7*phi5p^2 + 2*L4*m4*m8*phi4p^2 + 4*L5*m2*m8*phi5p^2 + 4*L5*m3*m7*phi5p^2 + 4*L6*m1*m7*phi6p^2 + 4*L5*m3*m8*phi5p^2 + 4*L5*m4*m7*phi5p^2 + 4*L6*m1*m8*phi6p^2 + 4*L6*m2*m7*phi6p^2 + 4*L5*m4*m8*phi5p^2 + 2*L5*m5*m7*phi5p^2 + 4*L6*m2*m8*phi6p^2 + 4*L6*m3*m7*phi6p^2 + 2*L7*m1*m7*phi7p^2 + 2*L5*m5*m8*phi5p^2 + 4*L6*m3*m8*phi6p^2 + 4*L6*m4*m7*phi6p^2 + 4*L7*m1*m8*phi7p^2 + 2*L7*m2*m7*phi7p^2 + 4*L6*m4*m8*phi6p^2 + 4*L6*m5*m7*phi6p^2 + 4*L7*m2*m8*phi7p^2 + 2*L7*m3*m7*phi7p^2 + 4*L6*m5*m8*phi6p^2 + 2*L6*m6*m7*phi6p^2 + 4*L7*m3*m8*phi7p^2 + 2*L7*m4*m7*phi7p^2 + 2*L8*m1*m8*phi8p^2 + 2*L6*m6*m8*phi6p^2 + 4*L7*m4*m8*phi7p^2 + 2*L7*m5*m7*phi7p^2 + 2*L8*m2*m8*phi8p^2 + 4*L7*m5*m8*phi7p^2 + 2*L7*m6*m7*phi7p^2 + 2*L8*m3*m8*phi8p^2 + 4*L7*m6*m8*phi7p^2 + 2*L8*m4*m8*phi8p^2 + 2*L8*m5*m8*phi8p^2 + 2*L8*m6*m8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
              -(2*force22*m1 - 2*force4*m8 - 2*force7*m8 - 2*force10*m8 - 2*force13*m8 - 2*force1*m8 - 2*force16*m8 + 2*force22*m2 + 2*force22*m3 + 2*force22*m4 - 2*force19*m8 + 2*force22*m5 + 2*force22*m6 + 2*force22*m7 - m1*m8*u1b - m2*m8*u1b - m2*m8*u2b - m3*m8*u2b - m3*m8*u3b - m4*m8*u3b + m1*m8*u7b - m4*m8*u4b + m2*m8*u7b - m5*m8*u4b + m3*m8*u7b - m5*m8*u5b + m4*m8*u7b - m6*m8*u5b + m5*m8*u7b - m6*m8*u6b + m6*m8*u7b - m7*m8*u6b + 2*L1*m1*m8*phi1*phi1p^2 + 4*L2*m1*m8*phi2*phi2p^2 + 2*L2*m2*m8*phi2*phi2p^2 + 4*L3*m1*m8*phi3*phi3p^2 + 4*L3*m2*m8*phi3*phi3p^2 + 2*L3*m3*m8*phi3*phi3p^2 + 4*L4*m1*m8*phi4*phi4p^2 + 4*L4*m2*m8*phi4*phi4p^2 + 4*L4*m3*m8*phi4*phi4p^2 + 2*L4*m4*m8*phi4*phi4p^2 + 4*L5*m1*m8*phi5*phi5p^2 + 4*L5*m2*m8*phi5*phi5p^2 + 4*L5*m3*m8*phi5*phi5p^2 + 4*L5*m4*m8*phi5*phi5p^2 + 4*L6*m1*m8*phi6*phi6p^2 + 2*L5*m5*m8*phi5*phi5p^2 + 4*L6*m2*m8*phi6*phi6p^2 + 4*L6*m3*m8*phi6*phi6p^2 + 4*L6*m4*m8*phi6*phi6p^2 + 4*L7*m1*m8*phi7*phi7p^2 + 4*L6*m5*m8*phi6*phi6p^2 + 4*L7*m2*m8*phi7*phi7p^2 + 2*L6*m6*m8*phi6*phi6p^2 + 4*L7*m3*m8*phi7*phi7p^2 + 4*L7*m4*m8*phi7*phi7p^2 + 2*L8*m1*m8*phi8*phi8p^2 + 4*L7*m5*m8*phi7*phi7p^2 + 2*L8*m2*m8*phi8*phi8p^2 + 4*L7*m6*m8*phi7*phi7p^2 + 2*L8*m3*m8*phi8*phi8p^2 + 2*L7*m7*m8*phi7*phi7p^2 + 2*L8*m4*m8*phi8*phi8p^2 + 2*L8*m5*m8*phi8*phi8p^2 + 2*L8*m6*m8*phi8*phi8p^2 + 2*L8*m7*m8*phi8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8);...
               (2*force2*m8 + 2*force5*m8 + 2*force8*m8 + 2*force11*m8 + 2*force14*m8 - 2*force23*m1 + 2*force17*m8 - 2*force23*m2 - 2*force23*m3 - 2*force23*m4 + 2*force20*m8 - 2*force23*m5 - 2*force23*m6 - 2*force23*m7 - m1*m8*phi1*u1b + 2*m1*m8*phi2*u1b - 2*m1*m8*phi2*u2b + m2*m8*phi2*u1b + 2*m1*m8*phi3*u2b - m2*m8*phi2*u2b - 2*m1*m8*phi3*u3b + 2*m2*m8*phi3*u2b + 2*m1*m8*phi4*u3b - 2*m2*m8*phi3*u3b + m3*m8*phi3*u2b - 2*m1*m8*phi4*u4b + 2*m2*m8*phi4*u3b - m3*m8*phi3*u3b + 2*m1*m8*phi5*u4b - 2*m2*m8*phi4*u4b + 2*m3*m8*phi4*u3b - 2*m1*m8*phi5*u5b + 2*m2*m8*phi5*u4b - 2*m3*m8*phi4*u4b + m4*m8*phi4*u3b + 2*m1*m8*phi6*u5b - 2*m2*m8*phi5*u5b + 2*m3*m8*phi5*u4b - m4*m8*phi4*u4b - 2*m1*m8*phi6*u6b + 2*m2*m8*phi6*u5b - 2*m3*m8*phi5*u5b + 2*m4*m8*phi5*u4b + 2*m1*m8*phi7*u6b - 2*m2*m8*phi6*u6b + 2*m3*m8*phi6*u5b - 2*m4*m8*phi5*u5b + m5*m8*phi5*u4b - 2*m1*m8*phi7*u7b + 2*m2*m8*phi7*u6b - 2*m3*m8*phi6*u6b + 2*m4*m8*phi6*u5b - m5*m8*phi5*u5b + m1*m8*phi8*u7b - 2*m2*m8*phi7*u7b + 2*m3*m8*phi7*u6b - 2*m4*m8*phi6*u6b + 2*m5*m8*phi6*u5b + m2*m8*phi8*u7b - 2*m3*m8*phi7*u7b + 2*m4*m8*phi7*u6b - 2*m5*m8*phi6*u6b + m6*m8*phi6*u5b + m3*m8*phi8*u7b - 2*m4*m8*phi7*u7b + 2*m5*m8*phi7*u6b - m6*m8*phi6*u6b + m4*m8*phi8*u7b - 2*m5*m8*phi7*u7b + 2*m6*m8*phi7*u6b + m5*m8*phi8*u7b - 2*m6*m8*phi7*u7b + m7*m8*phi7*u6b + m6*m8*phi8*u7b - m7*m8*phi7*u7b + m7*m8*phi8*u7b + 2*L1*m1*m8*phi1p^2 + 4*L2*m1*m8*phi2p^2 + 2*L2*m2*m8*phi2p^2 + 4*L3*m1*m8*phi3p^2 + 4*L3*m2*m8*phi3p^2 + 2*L3*m3*m8*phi3p^2 + 4*L4*m1*m8*phi4p^2 + 4*L4*m2*m8*phi4p^2 + 4*L4*m3*m8*phi4p^2 + 4*L5*m1*m8*phi5p^2 + 2*L4*m4*m8*phi4p^2 + 4*L5*m2*m8*phi5p^2 + 4*L5*m3*m8*phi5p^2 + 4*L6*m1*m8*phi6p^2 + 4*L5*m4*m8*phi5p^2 + 4*L6*m2*m8*phi6p^2 + 2*L5*m5*m8*phi5p^2 + 4*L6*m3*m8*phi6p^2 + 4*L7*m1*m8*phi7p^2 + 4*L6*m4*m8*phi6p^2 + 4*L7*m2*m8*phi7p^2 + 4*L6*m5*m8*phi6p^2 + 4*L7*m3*m8*phi7p^2 + 2*L8*m1*m8*phi8p^2 + 2*L6*m6*m8*phi6p^2 + 4*L7*m4*m8*phi7p^2 + 2*L8*m2*m8*phi8p^2 + 4*L7*m5*m8*phi7p^2 + 2*L8*m3*m8*phi8p^2 + 4*L7*m6*m8*phi7p^2 + 2*L8*m4*m8*phi8p^2 + 2*L7*m7*m8*phi7p^2 + 2*L8*m5*m8*phi8p^2 + 2*L8*m6*m8*phi8p^2 + 2*L8*m7*m8*phi8p^2)/(2*m1 + 2*m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8)];
end

% Components of Lambda Vector
lambda1 = Lambda(1);
lambda2 = Lambda(2);
lambda3 = Lambda(3);
lambda4 = Lambda(4);
lambda5 = Lambda(5);
lambda6 = Lambda(6);
lambda7 = Lambda(7);
lambda8 = Lambda(8);
lambda9 = Lambda(9);
lambda10 = Lambda(10);
lambda11 = Lambda(11);
lambda12 = Lambda(12);
lambda13 = Lambda(13);
lambda14 = Lambda(14);

% Total Actuation
if Go == 1  % Go
    if SmallAngle == 0  % Use full feedforward control
        Ui = [(2*(I2*force3 + I3*force3 - I1*force6 + I4*force3 + I5*force3 + I6*force3 - I1*force9 + I7*force3 + I8*force3 - I1*force12 - I1*force15 - I1*force18 - I1*force21 - I1*force24 + I1*lambda1*cos(phi2) - I2*lambda1*cos(phi1) - I3*lambda1*cos(phi1) + I1*lambda3*cos(phi2) - I4*lambda1*cos(phi1) + I1*lambda3*cos(phi3) - I5*lambda1*cos(phi1) - I6*lambda1*cos(phi1) + I1*lambda5*cos(phi3) - I7*lambda1*cos(phi1) + I1*lambda5*cos(phi4) - I8*lambda1*cos(phi1) + I1*lambda7*cos(phi4) + I1*lambda7*cos(phi5) + I1*lambda9*cos(phi5) + I1*lambda9*cos(phi6) + I1*lambda11*cos(phi6) + I1*lambda11*cos(phi7) + I1*lambda13*cos(phi7) + I1*lambda13*cos(phi8) + I1*lambda2*sin(phi2) - I2*lambda2*sin(phi1) - I3*lambda2*sin(phi1) + I1*lambda4*sin(phi2) - I4*lambda2*sin(phi1) + I1*lambda4*sin(phi3) - I5*lambda2*sin(phi1) - I6*lambda2*sin(phi1) + I1*lambda6*sin(phi3) - I7*lambda2*sin(phi1) + I1*lambda6*sin(phi4) - I8*lambda2*sin(phi1) + I1*lambda8*sin(phi4) + I1*lambda8*sin(phi5) + I1*lambda10*sin(phi5) + I1*lambda10*sin(phi6) + I1*lambda12*sin(phi6) + I1*lambda12*sin(phi7) + I1*lambda14*sin(phi7) + I1*lambda14*sin(phi8)))/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
              (2*(I3*force3 + I4*force3 + I5*force3 + I3*force6 + I6*force3 - I1*force9 + I4*force6 + I7*force3 - I2*force9 + I5*force6 + I8*force3 + I6*force6 - I1*force12 + I7*force6 - I2*force12 + I8*force6 - I1*force15 - I2*force15 - I1*force18 - I2*force18 - I1*force21 - I2*force21 - I1*force24 - I2*force24 - I3*lambda1*cos(phi1) - I3*lambda1*cos(phi2) - I4*lambda1*cos(phi1) + I1*lambda3*cos(phi3) - I4*lambda1*cos(phi2) - I5*lambda1*cos(phi1) + I2*lambda3*cos(phi3) - I3*lambda3*cos(phi2) - I5*lambda1*cos(phi2) - I6*lambda1*cos(phi1) + I1*lambda5*cos(phi3) - I4*lambda3*cos(phi2) - I6*lambda1*cos(phi2) - I7*lambda1*cos(phi1) + I1*lambda5*cos(phi4) + I2*lambda5*cos(phi3) - I5*lambda3*cos(phi2) - I7*lambda1*cos(phi2) - I8*lambda1*cos(phi1) + I2*lambda5*cos(phi4) - I6*lambda3*cos(phi2) - I8*lambda1*cos(phi2) + I1*lambda7*cos(phi4) - I7*lambda3*cos(phi2) + I1*lambda7*cos(phi5) + I2*lambda7*cos(phi4) - I8*lambda3*cos(phi2) + I2*lambda7*cos(phi5) + I1*lambda9*cos(phi5) + I1*lambda9*cos(phi6) + I2*lambda9*cos(phi5) + I2*lambda9*cos(phi6) + I1*lambda11*cos(phi6) + I1*lambda11*cos(phi7) + I2*lambda11*cos(phi6) + I2*lambda11*cos(phi7) + I1*lambda13*cos(phi7) + I1*lambda13*cos(phi8) + I2*lambda13*cos(phi7) + I2*lambda13*cos(phi8) - I3*lambda2*sin(phi1) - I3*lambda2*sin(phi2) - I4*lambda2*sin(phi1) + I1*lambda4*sin(phi3) - I4*lambda2*sin(phi2) - I5*lambda2*sin(phi1) + I2*lambda4*sin(phi3) - I3*lambda4*sin(phi2) - I5*lambda2*sin(phi2) - I6*lambda2*sin(phi1) + I1*lambda6*sin(phi3) - I4*lambda4*sin(phi2) - I6*lambda2*sin(phi2) - I7*lambda2*sin(phi1) + I1*lambda6*sin(phi4) + I2*lambda6*sin(phi3) - I5*lambda4*sin(phi2) - I7*lambda2*sin(phi2) - I8*lambda2*sin(phi1) + I2*lambda6*sin(phi4) - I6*lambda4*sin(phi2) - I8*lambda2*sin(phi2) + I1*lambda8*sin(phi4) - I7*lambda4*sin(phi2) + I1*lambda8*sin(phi5) + I2*lambda8*sin(phi4) - I8*lambda4*sin(phi2) + I2*lambda8*sin(phi5) + I1*lambda10*sin(phi5) + I1*lambda10*sin(phi6) + I2*lambda10*sin(phi5) + I2*lambda10*sin(phi6) + I1*lambda12*sin(phi6) + I1*lambda12*sin(phi7) + I2*lambda12*sin(phi6) + I2*lambda12*sin(phi7) + I1*lambda14*sin(phi7) + I1*lambda14*sin(phi8) + I2*lambda14*sin(phi7) + I2*lambda14*sin(phi8)))/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
              (2*(I4*force3 + I5*force3 + I6*force3 + I4*force6 + I7*force3 + I5*force6 + I8*force3 + I6*force6 - I1*force12 + I4*force9 + I7*force6 - I2*force12 + I5*force9 + I8*force6 - I3*force12 + I6*force9 - I1*force15 + I7*force9 - I2*force15 + I8*force9 - I3*force15 - I1*force18 - I2*force18 - I3*force18 - I1*force21 - I2*force21 - I3*force21 - I1*force24 - I2*force24 - I3*force24 - I4*lambda1*cos(phi1) - I4*lambda1*cos(phi2) - I5*lambda1*cos(phi1) - I5*lambda1*cos(phi2) - I6*lambda1*cos(phi1) - I4*lambda3*cos(phi2) - I6*lambda1*cos(phi2) - I7*lambda1*cos(phi1) + I1*lambda5*cos(phi4) - I4*lambda3*cos(phi3) - I5*lambda3*cos(phi2) - I7*lambda1*cos(phi2) - I8*lambda1*cos(phi1) + I2*lambda5*cos(phi4) - I5*lambda3*cos(phi3) - I6*lambda3*cos(phi2) - I8*lambda1*cos(phi2) + I1*lambda7*cos(phi4) + I3*lambda5*cos(phi4) - I4*lambda5*cos(phi3) - I6*lambda3*cos(phi3) - I7*lambda3*cos(phi2) + I1*lambda7*cos(phi5) + I2*lambda7*cos(phi4) - I5*lambda5*cos(phi3) - I7*lambda3*cos(phi3) - I8*lambda3*cos(phi2) + I2*lambda7*cos(phi5) + I3*lambda7*cos(phi4) - I6*lambda5*cos(phi3) - I8*lambda3*cos(phi3) + I1*lambda9*cos(phi5) + I3*lambda7*cos(phi5) - I7*lambda5*cos(phi3) + I1*lambda9*cos(phi6) + I2*lambda9*cos(phi5) - I8*lambda5*cos(phi3) + I2*lambda9*cos(phi6) + I3*lambda9*cos(phi5) + I1*lambda11*cos(phi6) + I3*lambda9*cos(phi6) + I1*lambda11*cos(phi7) + I2*lambda11*cos(phi6) + I2*lambda11*cos(phi7) + I3*lambda11*cos(phi6) + I1*lambda13*cos(phi7) + I3*lambda11*cos(phi7) + I1*lambda13*cos(phi8) + I2*lambda13*cos(phi7) + I2*lambda13*cos(phi8) + I3*lambda13*cos(phi7) + I3*lambda13*cos(phi8) - I4*lambda2*sin(phi1) - I4*lambda2*sin(phi2) - I5*lambda2*sin(phi1) - I5*lambda2*sin(phi2) - I6*lambda2*sin(phi1) - I4*lambda4*sin(phi2) - I6*lambda2*sin(phi2) - I7*lambda2*sin(phi1) + I1*lambda6*sin(phi4) - I4*lambda4*sin(phi3) - I5*lambda4*sin(phi2) - I7*lambda2*sin(phi2) - I8*lambda2*sin(phi1) + I2*lambda6*sin(phi4) - I5*lambda4*sin(phi3) - I6*lambda4*sin(phi2) - I8*lambda2*sin(phi2) + I1*lambda8*sin(phi4) + I3*lambda6*sin(phi4) - I4*lambda6*sin(phi3) - I6*lambda4*sin(phi3) - I7*lambda4*sin(phi2) + I1*lambda8*sin(phi5) + I2*lambda8*sin(phi4) - I5*lambda6*sin(phi3) - I7*lambda4*sin(phi3) - I8*lambda4*sin(phi2) + I2*lambda8*sin(phi5) + I3*lambda8*sin(phi4) - I6*lambda6*sin(phi3) - I8*lambda4*sin(phi3) + I1*lambda10*sin(phi5) + I3*lambda8*sin(phi5) - I7*lambda6*sin(phi3) + I1*lambda10*sin(phi6) + I2*lambda10*sin(phi5) - I8*lambda6*sin(phi3) + I2*lambda10*sin(phi6) + I3*lambda10*sin(phi5) + I1*lambda12*sin(phi6) + I3*lambda10*sin(phi6) + I1*lambda12*sin(phi7) + I2*lambda12*sin(phi6) + I2*lambda12*sin(phi7) + I3*lambda12*sin(phi6) + I1*lambda14*sin(phi7) + I3*lambda12*sin(phi7) + I1*lambda14*sin(phi8) + I2*lambda14*sin(phi7) + I2*lambda14*sin(phi8) + I3*lambda14*sin(phi7) + I3*lambda14*sin(phi8)))/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
              (2*(I5*force3 + I6*force3 + I7*force3 + I5*force6 + I8*force3 + I6*force6 + I7*force6 + I5*force9 + I8*force6 + I6*force9 - I1*force15 + I7*force9 - I2*force15 + I5*force12 + I8*force9 - I3*force15 + I6*force12 - I1*force18 - I4*force15 + I7*force12 - I2*force18 + I8*force12 - I3*force18 - I1*force21 - I4*force18 - I2*force21 - I3*force21 - I1*force24 - I4*force21 - I2*force24 - I3*force24 - I4*force24 - I5*lambda1*cos(phi1) - I5*lambda1*cos(phi2) - I6*lambda1*cos(phi1) - I6*lambda1*cos(phi2) - I7*lambda1*cos(phi1) - I5*lambda3*cos(phi2) - I7*lambda1*cos(phi2) - I8*lambda1*cos(phi1) - I5*lambda3*cos(phi3) - I6*lambda3*cos(phi2) - I8*lambda1*cos(phi2) - I6*lambda3*cos(phi3) - I7*lambda3*cos(phi2) + I1*lambda7*cos(phi5) - I5*lambda5*cos(phi3) - I7*lambda3*cos(phi3) - I8*lambda3*cos(phi2) + I2*lambda7*cos(phi5) - I5*lambda5*cos(phi4) - I6*lambda5*cos(phi3) - I8*lambda3*cos(phi3) + I1*lambda9*cos(phi5) + I3*lambda7*cos(phi5) - I6*lambda5*cos(phi4) - I7*lambda5*cos(phi3) + I1*lambda9*cos(phi6) + I2*lambda9*cos(phi5) + I4*lambda7*cos(phi5) - I5*lambda7*cos(phi4) - I7*lambda5*cos(phi4) - I8*lambda5*cos(phi3) + I2*lambda9*cos(phi6) + I3*lambda9*cos(phi5) - I6*lambda7*cos(phi4) - I8*lambda5*cos(phi4) + I1*lambda11*cos(phi6) + I3*lambda9*cos(phi6) + I4*lambda9*cos(phi5) - I7*lambda7*cos(phi4) + I1*lambda11*cos(phi7) + I2*lambda11*cos(phi6) + I4*lambda9*cos(phi6) - I8*lambda7*cos(phi4) + I2*lambda11*cos(phi7) + I3*lambda11*cos(phi6) + I1*lambda13*cos(phi7) + I3*lambda11*cos(phi7) + I4*lambda11*cos(phi6) + I1*lambda13*cos(phi8) + I2*lambda13*cos(phi7) + I4*lambda11*cos(phi7) + I2*lambda13*cos(phi8) + I3*lambda13*cos(phi7) + I3*lambda13*cos(phi8) + I4*lambda13*cos(phi7) + I4*lambda13*cos(phi8) - I5*lambda2*sin(phi1) - I5*lambda2*sin(phi2) - I6*lambda2*sin(phi1) - I6*lambda2*sin(phi2) - I7*lambda2*sin(phi1) - I5*lambda4*sin(phi2) - I7*lambda2*sin(phi2) - I8*lambda2*sin(phi1) - I5*lambda4*sin(phi3) - I6*lambda4*sin(phi2) - I8*lambda2*sin(phi2) - I6*lambda4*sin(phi3) - I7*lambda4*sin(phi2) + I1*lambda8*sin(phi5) - I5*lambda6*sin(phi3) - I7*lambda4*sin(phi3) - I8*lambda4*sin(phi2) + I2*lambda8*sin(phi5) - I5*lambda6*sin(phi4) - I6*lambda6*sin(phi3) - I8*lambda4*sin(phi3) + I1*lambda10*sin(phi5) + I3*lambda8*sin(phi5) - I6*lambda6*sin(phi4) - I7*lambda6*sin(phi3) + I1*lambda10*sin(phi6) + I2*lambda10*sin(phi5) + I4*lambda8*sin(phi5) - I5*lambda8*sin(phi4) - I7*lambda6*sin(phi4) - I8*lambda6*sin(phi3) + I2*lambda10*sin(phi6) + I3*lambda10*sin(phi5) - I6*lambda8*sin(phi4) - I8*lambda6*sin(phi4) + I1*lambda12*sin(phi6) + I3*lambda10*sin(phi6) + I4*lambda10*sin(phi5) - I7*lambda8*sin(phi4) + I1*lambda12*sin(phi7) + I2*lambda12*sin(phi6) + I4*lambda10*sin(phi6) - I8*lambda8*sin(phi4) + I2*lambda12*sin(phi7) + I3*lambda12*sin(phi6) + I1*lambda14*sin(phi7) + I3*lambda12*sin(phi7) + I4*lambda12*sin(phi6) + I1*lambda14*sin(phi8) + I2*lambda14*sin(phi7) + I4*lambda12*sin(phi7) + I2*lambda14*sin(phi8) + I3*lambda14*sin(phi7) + I3*lambda14*sin(phi8) + I4*lambda14*sin(phi7) + I4*lambda14*sin(phi8)))/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
             -(2*(I1*force18 - I7*force3 - I8*force3 - I6*force6 - I7*force6 - I8*force6 - I6*force9 - I7*force9 - I8*force9 - I6*force12 - I6*force3 - I7*force12 + I2*force18 - I8*force12 + I3*force18 - I6*force15 + I1*force21 + I4*force18 - I7*force15 + I2*force21 + I5*force18 - I8*force15 + I3*force21 + I1*force24 + I4*force21 + I2*force24 + I5*force21 + I3*force24 + I4*force24 + I5*force24 + I6*lambda1*cos(phi1) + I6*lambda1*cos(phi2) + I7*lambda1*cos(phi1) + I7*lambda1*cos(phi2) + I8*lambda1*cos(phi1) + I6*lambda3*cos(phi2) + I8*lambda1*cos(phi2) + I6*lambda3*cos(phi3) + I7*lambda3*cos(phi2) + I7*lambda3*cos(phi3) + I8*lambda3*cos(phi2) + I6*lambda5*cos(phi3) + I8*lambda3*cos(phi3) + I6*lambda5*cos(phi4) + I7*lambda5*cos(phi3) - I1*lambda9*cos(phi6) + I7*lambda5*cos(phi4) + I8*lambda5*cos(phi3) - I2*lambda9*cos(phi6) + I6*lambda7*cos(phi4) + I8*lambda5*cos(phi4) - I1*lambda11*cos(phi6) - I3*lambda9*cos(phi6) + I6*lambda7*cos(phi5) + I7*lambda7*cos(phi4) - I1*lambda11*cos(phi7) - I2*lambda11*cos(phi6) - I4*lambda9*cos(phi6) + I7*lambda7*cos(phi5) + I8*lambda7*cos(phi4) - I2*lambda11*cos(phi7) - I3*lambda11*cos(phi6) - I5*lambda9*cos(phi6) + I6*lambda9*cos(phi5) + I8*lambda7*cos(phi5) - I1*lambda13*cos(phi7) - I3*lambda11*cos(phi7) - I4*lambda11*cos(phi6) + I7*lambda9*cos(phi5) - I1*lambda13*cos(phi8) - I2*lambda13*cos(phi7) - I4*lambda11*cos(phi7) - I5*lambda11*cos(phi6) + I8*lambda9*cos(phi5) - I2*lambda13*cos(phi8) - I3*lambda13*cos(phi7) - I5*lambda11*cos(phi7) - I3*lambda13*cos(phi8) - I4*lambda13*cos(phi7) - I4*lambda13*cos(phi8) - I5*lambda13*cos(phi7) - I5*lambda13*cos(phi8) + I6*lambda2*sin(phi1) + I6*lambda2*sin(phi2) + I7*lambda2*sin(phi1) + I7*lambda2*sin(phi2) + I8*lambda2*sin(phi1) + I6*lambda4*sin(phi2) + I8*lambda2*sin(phi2) + I6*lambda4*sin(phi3) + I7*lambda4*sin(phi2) + I7*lambda4*sin(phi3) + I8*lambda4*sin(phi2) + I6*lambda6*sin(phi3) + I8*lambda4*sin(phi3) + I6*lambda6*sin(phi4) + I7*lambda6*sin(phi3) - I1*lambda10*sin(phi6) + I7*lambda6*sin(phi4) + I8*lambda6*sin(phi3) - I2*lambda10*sin(phi6) + I6*lambda8*sin(phi4) + I8*lambda6*sin(phi4) - I1*lambda12*sin(phi6) - I3*lambda10*sin(phi6) + I6*lambda8*sin(phi5) + I7*lambda8*sin(phi4) - I1*lambda12*sin(phi7) - I2*lambda12*sin(phi6) - I4*lambda10*sin(phi6) + I7*lambda8*sin(phi5) + I8*lambda8*sin(phi4) - I2*lambda12*sin(phi7) - I3*lambda12*sin(phi6) - I5*lambda10*sin(phi6) + I6*lambda10*sin(phi5) + I8*lambda8*sin(phi5) - I1*lambda14*sin(phi7) - I3*lambda12*sin(phi7) - I4*lambda12*sin(phi6) + I7*lambda10*sin(phi5) - I1*lambda14*sin(phi8) - I2*lambda14*sin(phi7) - I4*lambda12*sin(phi7) - I5*lambda12*sin(phi6) + I8*lambda10*sin(phi5) - I2*lambda14*sin(phi8) - I3*lambda14*sin(phi7) - I5*lambda12*sin(phi7) - I3*lambda14*sin(phi8) - I4*lambda14*sin(phi7) - I4*lambda14*sin(phi8) - I5*lambda14*sin(phi7) - I5*lambda14*sin(phi8)))/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
             -(2*(I1*force21 - I8*force3 - I7*force6 - I8*force6 - I7*force9 - I8*force9 - I7*force12 - I8*force12 - I7*force3 - I7*force15 + I2*force21 - I8*force15 + I3*force21 + I1*force24 + I4*force21 - I7*force18 + I2*force24 + I5*force21 - I8*force18 + I3*force24 + I6*force21 + I4*force24 + I5*force24 + I6*force24 + I7*lambda1*cos(phi1) + I7*lambda1*cos(phi2) + I8*lambda1*cos(phi1) + I8*lambda1*cos(phi2) + I7*lambda3*cos(phi2) + I7*lambda3*cos(phi3) + I8*lambda3*cos(phi2) + I8*lambda3*cos(phi3) + I7*lambda5*cos(phi3) + I7*lambda5*cos(phi4) + I8*lambda5*cos(phi3) + I8*lambda5*cos(phi4) + I7*lambda7*cos(phi4) - I1*lambda11*cos(phi7) + I7*lambda7*cos(phi5) + I8*lambda7*cos(phi4) - I2*lambda11*cos(phi7) + I8*lambda7*cos(phi5) - I1*lambda13*cos(phi7) - I3*lambda11*cos(phi7) + I7*lambda9*cos(phi5) - I1*lambda13*cos(phi8) - I2*lambda13*cos(phi7) - I4*lambda11*cos(phi7) + I7*lambda9*cos(phi6) + I8*lambda9*cos(phi5) - I2*lambda13*cos(phi8) - I3*lambda13*cos(phi7) - I5*lambda11*cos(phi7) + I8*lambda9*cos(phi6) - I3*lambda13*cos(phi8) - I4*lambda13*cos(phi7) - I6*lambda11*cos(phi7) + I7*lambda11*cos(phi6) - I4*lambda13*cos(phi8) - I5*lambda13*cos(phi7) + I8*lambda11*cos(phi6) - I5*lambda13*cos(phi8) - I6*lambda13*cos(phi7) - I6*lambda13*cos(phi8) + I7*lambda2*sin(phi1) + I7*lambda2*sin(phi2) + I8*lambda2*sin(phi1) + I8*lambda2*sin(phi2) + I7*lambda4*sin(phi2) + I7*lambda4*sin(phi3) + I8*lambda4*sin(phi2) + I8*lambda4*sin(phi3) + I7*lambda6*sin(phi3) + I7*lambda6*sin(phi4) + I8*lambda6*sin(phi3) + I8*lambda6*sin(phi4) + I7*lambda8*sin(phi4) - I1*lambda12*sin(phi7) + I7*lambda8*sin(phi5) + I8*lambda8*sin(phi4) - I2*lambda12*sin(phi7) + I8*lambda8*sin(phi5) - I1*lambda14*sin(phi7) - I3*lambda12*sin(phi7) + I7*lambda10*sin(phi5) - I1*lambda14*sin(phi8) - I2*lambda14*sin(phi7) - I4*lambda12*sin(phi7) + I7*lambda10*sin(phi6) + I8*lambda10*sin(phi5) - I2*lambda14*sin(phi8) - I3*lambda14*sin(phi7) - I5*lambda12*sin(phi7) + I8*lambda10*sin(phi6) - I3*lambda14*sin(phi8) - I4*lambda14*sin(phi7) - I6*lambda12*sin(phi7) + I7*lambda12*sin(phi6) - I4*lambda14*sin(phi8) - I5*lambda14*sin(phi7) + I8*lambda12*sin(phi6) - I5*lambda14*sin(phi8) - I6*lambda14*sin(phi7) - I6*lambda14*sin(phi8)))/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
             -(2*(I1*force24 - I8*force6 - I8*force9 - I8*force12 - I8*force15 - I8*force3 + I2*force24 - I8*force18 + I3*force24 + I4*force24 + I5*force24 - I8*force21 + I6*force24 + I7*force24 + I8*lambda1*cos(phi1) + I8*lambda1*cos(phi2) + I8*lambda3*cos(phi2) + I8*lambda3*cos(phi3) + I8*lambda5*cos(phi3) + I8*lambda5*cos(phi4) + I8*lambda7*cos(phi4) + I8*lambda7*cos(phi5) - I1*lambda13*cos(phi8) + I8*lambda9*cos(phi5) - I2*lambda13*cos(phi8) + I8*lambda9*cos(phi6) - I3*lambda13*cos(phi8) - I4*lambda13*cos(phi8) + I8*lambda11*cos(phi6) - I5*lambda13*cos(phi8) + I8*lambda11*cos(phi7) - I6*lambda13*cos(phi8) - I7*lambda13*cos(phi8) + I8*lambda13*cos(phi7) + I8*lambda2*sin(phi1) + I8*lambda2*sin(phi2) + I8*lambda4*sin(phi2) + I8*lambda4*sin(phi3) + I8*lambda6*sin(phi3) + I8*lambda6*sin(phi4) + I8*lambda8*sin(phi4) + I8*lambda8*sin(phi5) - I1*lambda14*sin(phi8) + I8*lambda10*sin(phi5) - I2*lambda14*sin(phi8) + I8*lambda10*sin(phi6) - I3*lambda14*sin(phi8) - I4*lambda14*sin(phi8) + I8*lambda12*sin(phi6) - I5*lambda14*sin(phi8) + I8*lambda12*sin(phi7) - I6*lambda14*sin(phi8) - I7*lambda14*sin(phi8) + I8*lambda14*sin(phi7)))/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8)];
    elseif SmallAngle == 1 % Use small angle approximation
        Ui = [(2*I2*force3 + 2*I3*force3 - 2*I1*force6 + 2*I4*force3 + 2*I5*force3 + 2*I6*force3 - 2*I1*force9 + 2*I7*force3 + 2*I8*force3 - 2*I1*force12 - 2*I1*force15 - 2*I1*force18 - 2*I1*force21 - 2*I1*force24 + 2*I1*lambda1 - 2*I2*lambda1 + 4*I1*lambda3 - 2*I3*lambda1 - 2*I4*lambda1 + 4*I1*lambda5 - 2*I5*lambda1 - 2*I6*lambda1 + 4*I1*lambda7 - 2*I7*lambda1 - 2*I8*lambda1 + 4*I1*lambda9 + 4*I1*lambda11 + 4*I1*lambda13 + 2*I1*lambda2*phi2 - 2*I2*lambda2*phi1 - 2*I3*lambda2*phi1 + 2*I1*lambda4*phi2 - 2*I4*lambda2*phi1 + 2*I1*lambda4*phi3 - 2*I5*lambda2*phi1 - 2*I6*lambda2*phi1 + 2*I1*lambda6*phi3 - 2*I7*lambda2*phi1 + 2*I1*lambda6*phi4 - 2*I8*lambda2*phi1 + 2*I1*lambda8*phi4 + 2*I1*lambda8*phi5 + 2*I1*lambda10*phi5 + 2*I1*lambda10*phi6 + 2*I1*lambda12*phi6 + 2*I1*lambda12*phi7 + 2*I1*lambda14*phi7 + 2*I1*lambda14*phi8)/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
              (2*I3*force3 + 2*I4*force3 + 2*I5*force3 + 2*I3*force6 + 2*I6*force3 - 2*I1*force9 + 2*I4*force6 + 2*I7*force3 - 2*I2*force9 + 2*I5*force6 + 2*I8*force3 + 2*I6*force6 - 2*I1*force12 + 2*I7*force6 - 2*I2*force12 + 2*I8*force6 - 2*I1*force15 - 2*I2*force15 - 2*I1*force18 - 2*I2*force18 - 2*I1*force21 - 2*I2*force21 - 2*I1*force24 - 2*I2*force24 + 2*I1*lambda3 - 4*I3*lambda1 + 2*I2*lambda3 - 4*I4*lambda1 + 4*I1*lambda5 - 2*I3*lambda3 - 4*I5*lambda1 + 4*I2*lambda5 - 2*I4*lambda3 - 4*I6*lambda1 + 4*I1*lambda7 - 2*I5*lambda3 - 4*I7*lambda1 + 4*I2*lambda7 - 2*I6*lambda3 - 4*I8*lambda1 + 4*I1*lambda9 - 2*I7*lambda3 + 4*I2*lambda9 - 2*I8*lambda3 + 4*I1*lambda11 + 4*I2*lambda11 + 4*I1*lambda13 + 4*I2*lambda13 - 2*I3*lambda2*phi1 - 2*I3*lambda2*phi2 - 2*I4*lambda2*phi1 + 2*I1*lambda4*phi3 - 2*I4*lambda2*phi2 - 2*I5*lambda2*phi1 + 2*I2*lambda4*phi3 - 2*I3*lambda4*phi2 - 2*I5*lambda2*phi2 - 2*I6*lambda2*phi1 + 2*I1*lambda6*phi3 - 2*I4*lambda4*phi2 - 2*I6*lambda2*phi2 - 2*I7*lambda2*phi1 + 2*I1*lambda6*phi4 + 2*I2*lambda6*phi3 - 2*I5*lambda4*phi2 - 2*I7*lambda2*phi2 - 2*I8*lambda2*phi1 + 2*I2*lambda6*phi4 - 2*I6*lambda4*phi2 - 2*I8*lambda2*phi2 + 2*I1*lambda8*phi4 - 2*I7*lambda4*phi2 + 2*I1*lambda8*phi5 + 2*I2*lambda8*phi4 - 2*I8*lambda4*phi2 + 2*I2*lambda8*phi5 + 2*I1*lambda10*phi5 + 2*I1*lambda10*phi6 + 2*I2*lambda10*phi5 + 2*I2*lambda10*phi6 + 2*I1*lambda12*phi6 + 2*I1*lambda12*phi7 + 2*I2*lambda12*phi6 + 2*I2*lambda12*phi7 + 2*I1*lambda14*phi7 + 2*I1*lambda14*phi8 + 2*I2*lambda14*phi7 + 2*I2*lambda14*phi8)/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
              (2*I4*force3 + 2*I5*force3 + 2*I6*force3 + 2*I4*force6 + 2*I7*force3 + 2*I5*force6 + 2*I8*force3 + 2*I6*force6 - 2*I1*force12 + 2*I4*force9 + 2*I7*force6 - 2*I2*force12 + 2*I5*force9 + 2*I8*force6 - 2*I3*force12 + 2*I6*force9 - 2*I1*force15 + 2*I7*force9 - 2*I2*force15 + 2*I8*force9 - 2*I3*force15 - 2*I1*force18 - 2*I2*force18 - 2*I3*force18 - 2*I1*force21 - 2*I2*force21 - 2*I3*force21 - 2*I1*force24 - 2*I2*force24 - 2*I3*force24 - 4*I4*lambda1 + 2*I1*lambda5 - 4*I5*lambda1 + 2*I2*lambda5 - 4*I4*lambda3 - 4*I6*lambda1 + 4*I1*lambda7 + 2*I3*lambda5 - 4*I5*lambda3 - 4*I7*lambda1 + 4*I2*lambda7 - 2*I4*lambda5 - 4*I6*lambda3 - 4*I8*lambda1 + 4*I1*lambda9 + 4*I3*lambda7 - 2*I5*lambda5 - 4*I7*lambda3 + 4*I2*lambda9 - 2*I6*lambda5 - 4*I8*lambda3 + 4*I1*lambda11 + 4*I3*lambda9 - 2*I7*lambda5 + 4*I2*lambda11 - 2*I8*lambda5 + 4*I1*lambda13 + 4*I3*lambda11 + 4*I2*lambda13 + 4*I3*lambda13 - 2*I4*lambda2*phi1 - 2*I4*lambda2*phi2 - 2*I5*lambda2*phi1 - 2*I5*lambda2*phi2 - 2*I6*lambda2*phi1 - 2*I4*lambda4*phi2 - 2*I6*lambda2*phi2 - 2*I7*lambda2*phi1 + 2*I1*lambda6*phi4 - 2*I4*lambda4*phi3 - 2*I5*lambda4*phi2 - 2*I7*lambda2*phi2 - 2*I8*lambda2*phi1 + 2*I2*lambda6*phi4 - 2*I5*lambda4*phi3 - 2*I6*lambda4*phi2 - 2*I8*lambda2*phi2 + 2*I1*lambda8*phi4 + 2*I3*lambda6*phi4 - 2*I4*lambda6*phi3 - 2*I6*lambda4*phi3 - 2*I7*lambda4*phi2 + 2*I1*lambda8*phi5 + 2*I2*lambda8*phi4 - 2*I5*lambda6*phi3 - 2*I7*lambda4*phi3 - 2*I8*lambda4*phi2 + 2*I2*lambda8*phi5 + 2*I3*lambda8*phi4 - 2*I6*lambda6*phi3 - 2*I8*lambda4*phi3 + 2*I1*lambda10*phi5 + 2*I3*lambda8*phi5 - 2*I7*lambda6*phi3 + 2*I1*lambda10*phi6 + 2*I2*lambda10*phi5 - 2*I8*lambda6*phi3 + 2*I2*lambda10*phi6 + 2*I3*lambda10*phi5 + 2*I1*lambda12*phi6 + 2*I3*lambda10*phi6 + 2*I1*lambda12*phi7 + 2*I2*lambda12*phi6 + 2*I2*lambda12*phi7 + 2*I3*lambda12*phi6 + 2*I1*lambda14*phi7 + 2*I3*lambda12*phi7 + 2*I1*lambda14*phi8 + 2*I2*lambda14*phi7 + 2*I2*lambda14*phi8 + 2*I3*lambda14*phi7 + 2*I3*lambda14*phi8)/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
              (2*I5*force3 + 2*I6*force3 + 2*I7*force3 + 2*I5*force6 + 2*I8*force3 + 2*I6*force6 + 2*I7*force6 + 2*I5*force9 + 2*I8*force6 + 2*I6*force9 - 2*I1*force15 + 2*I7*force9 - 2*I2*force15 + 2*I5*force12 + 2*I8*force9 - 2*I3*force15 + 2*I6*force12 - 2*I1*force18 - 2*I4*force15 + 2*I7*force12 - 2*I2*force18 + 2*I8*force12 - 2*I3*force18 - 2*I1*force21 - 2*I4*force18 - 2*I2*force21 - 2*I3*force21 - 2*I1*force24 - 2*I4*force21 - 2*I2*force24 - 2*I3*force24 - 2*I4*force24 - 4*I5*lambda1 - 4*I6*lambda1 + 2*I1*lambda7 - 4*I5*lambda3 - 4*I7*lambda1 + 2*I2*lambda7 - 4*I6*lambda3 - 4*I8*lambda1 + 4*I1*lambda9 + 2*I3*lambda7 - 4*I5*lambda5 - 4*I7*lambda3 + 4*I2*lambda9 + 2*I4*lambda7 - 4*I6*lambda5 - 4*I8*lambda3 + 4*I1*lambda11 + 4*I3*lambda9 - 2*I5*lambda7 - 4*I7*lambda5 + 4*I2*lambda11 + 4*I4*lambda9 - 2*I6*lambda7 - 4*I8*lambda5 + 4*I1*lambda13 + 4*I3*lambda11 - 2*I7*lambda7 + 4*I2*lambda13 + 4*I4*lambda11 - 2*I8*lambda7 + 4*I3*lambda13 + 4*I4*lambda13 - 2*I5*lambda2*phi1 - 2*I5*lambda2*phi2 - 2*I6*lambda2*phi1 - 2*I6*lambda2*phi2 - 2*I7*lambda2*phi1 - 2*I5*lambda4*phi2 - 2*I7*lambda2*phi2 - 2*I8*lambda2*phi1 - 2*I5*lambda4*phi3 - 2*I6*lambda4*phi2 - 2*I8*lambda2*phi2 - 2*I6*lambda4*phi3 - 2*I7*lambda4*phi2 + 2*I1*lambda8*phi5 - 2*I5*lambda6*phi3 - 2*I7*lambda4*phi3 - 2*I8*lambda4*phi2 + 2*I2*lambda8*phi5 - 2*I5*lambda6*phi4 - 2*I6*lambda6*phi3 - 2*I8*lambda4*phi3 + 2*I1*lambda10*phi5 + 2*I3*lambda8*phi5 - 2*I6*lambda6*phi4 - 2*I7*lambda6*phi3 + 2*I1*lambda10*phi6 + 2*I2*lambda10*phi5 + 2*I4*lambda8*phi5 - 2*I5*lambda8*phi4 - 2*I7*lambda6*phi4 - 2*I8*lambda6*phi3 + 2*I2*lambda10*phi6 + 2*I3*lambda10*phi5 - 2*I6*lambda8*phi4 - 2*I8*lambda6*phi4 + 2*I1*lambda12*phi6 + 2*I3*lambda10*phi6 + 2*I4*lambda10*phi5 - 2*I7*lambda8*phi4 + 2*I1*lambda12*phi7 + 2*I2*lambda12*phi6 + 2*I4*lambda10*phi6 - 2*I8*lambda8*phi4 + 2*I2*lambda12*phi7 + 2*I3*lambda12*phi6 + 2*I1*lambda14*phi7 + 2*I3*lambda12*phi7 + 2*I4*lambda12*phi6 + 2*I1*lambda14*phi8 + 2*I2*lambda14*phi7 + 2*I4*lambda12*phi7 + 2*I2*lambda14*phi8 + 2*I3*lambda14*phi7 + 2*I3*lambda14*phi8 + 2*I4*lambda14*phi7 + 2*I4*lambda14*phi8)/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
             -(2*I1*force18 - 2*I7*force3 - 2*I8*force3 - 2*I6*force6 - 2*I7*force6 - 2*I8*force6 - 2*I6*force9 - 2*I7*force9 - 2*I8*force9 - 2*I6*force12 - 2*I6*force3 - 2*I7*force12 + 2*I2*force18 - 2*I8*force12 + 2*I3*force18 - 2*I6*force15 + 2*I1*force21 + 2*I4*force18 - 2*I7*force15 + 2*I2*force21 + 2*I5*force18 - 2*I8*force15 + 2*I3*force21 + 2*I1*force24 + 2*I4*force21 + 2*I2*force24 + 2*I5*force21 + 2*I3*force24 + 2*I4*force24 + 2*I5*force24 + 4*I6*lambda1 + 4*I7*lambda1 + 4*I6*lambda3 + 4*I8*lambda1 - 2*I1*lambda9 + 4*I7*lambda3 - 2*I2*lambda9 + 4*I6*lambda5 + 4*I8*lambda3 - 4*I1*lambda11 - 2*I3*lambda9 + 4*I7*lambda5 - 4*I2*lambda11 - 2*I4*lambda9 + 4*I6*lambda7 + 4*I8*lambda5 - 4*I1*lambda13 - 4*I3*lambda11 - 2*I5*lambda9 + 4*I7*lambda7 - 4*I2*lambda13 - 4*I4*lambda11 + 2*I6*lambda9 + 4*I8*lambda7 - 4*I3*lambda13 - 4*I5*lambda11 + 2*I7*lambda9 - 4*I4*lambda13 + 2*I8*lambda9 - 4*I5*lambda13 + 2*I6*lambda2*phi1 + 2*I6*lambda2*phi2 + 2*I7*lambda2*phi1 + 2*I7*lambda2*phi2 + 2*I8*lambda2*phi1 + 2*I6*lambda4*phi2 + 2*I8*lambda2*phi2 + 2*I6*lambda4*phi3 + 2*I7*lambda4*phi2 + 2*I7*lambda4*phi3 + 2*I8*lambda4*phi2 + 2*I6*lambda6*phi3 + 2*I8*lambda4*phi3 + 2*I6*lambda6*phi4 + 2*I7*lambda6*phi3 - 2*I1*lambda10*phi6 + 2*I7*lambda6*phi4 + 2*I8*lambda6*phi3 - 2*I2*lambda10*phi6 + 2*I6*lambda8*phi4 + 2*I8*lambda6*phi4 - 2*I1*lambda12*phi6 - 2*I3*lambda10*phi6 + 2*I6*lambda8*phi5 + 2*I7*lambda8*phi4 - 2*I1*lambda12*phi7 - 2*I2*lambda12*phi6 - 2*I4*lambda10*phi6 + 2*I7*lambda8*phi5 + 2*I8*lambda8*phi4 - 2*I2*lambda12*phi7 - 2*I3*lambda12*phi6 - 2*I5*lambda10*phi6 + 2*I6*lambda10*phi5 + 2*I8*lambda8*phi5 - 2*I1*lambda14*phi7 - 2*I3*lambda12*phi7 - 2*I4*lambda12*phi6 + 2*I7*lambda10*phi5 - 2*I1*lambda14*phi8 - 2*I2*lambda14*phi7 - 2*I4*lambda12*phi7 - 2*I5*lambda12*phi6 + 2*I8*lambda10*phi5 - 2*I2*lambda14*phi8 - 2*I3*lambda14*phi7 - 2*I5*lambda12*phi7 - 2*I3*lambda14*phi8 - 2*I4*lambda14*phi7 - 2*I4*lambda14*phi8 - 2*I5*lambda14*phi7 - 2*I5*lambda14*phi8)/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
             -(2*I1*force21 - 2*I8*force3 - 2*I7*force6 - 2*I8*force6 - 2*I7*force9 - 2*I8*force9 - 2*I7*force12 - 2*I8*force12 - 2*I7*force3 - 2*I7*force15 + 2*I2*force21 - 2*I8*force15 + 2*I3*force21 + 2*I1*force24 + 2*I4*force21 - 2*I7*force18 + 2*I2*force24 + 2*I5*force21 - 2*I8*force18 + 2*I3*force24 + 2*I6*force21 + 2*I4*force24 + 2*I5*force24 + 2*I6*force24 + 4*I7*lambda1 + 4*I8*lambda1 + 4*I7*lambda3 + 4*I8*lambda3 - 2*I1*lambda11 + 4*I7*lambda5 - 2*I2*lambda11 + 4*I8*lambda5 - 4*I1*lambda13 - 2*I3*lambda11 + 4*I7*lambda7 - 4*I2*lambda13 - 2*I4*lambda11 + 4*I8*lambda7 - 4*I3*lambda13 - 2*I5*lambda11 + 4*I7*lambda9 - 4*I4*lambda13 - 2*I6*lambda11 + 4*I8*lambda9 - 4*I5*lambda13 + 2*I7*lambda11 - 4*I6*lambda13 + 2*I8*lambda11 + 2*I7*lambda2*phi1 + 2*I7*lambda2*phi2 + 2*I8*lambda2*phi1 + 2*I8*lambda2*phi2 + 2*I7*lambda4*phi2 + 2*I7*lambda4*phi3 + 2*I8*lambda4*phi2 + 2*I8*lambda4*phi3 + 2*I7*lambda6*phi3 + 2*I7*lambda6*phi4 + 2*I8*lambda6*phi3 + 2*I8*lambda6*phi4 + 2*I7*lambda8*phi4 - 2*I1*lambda12*phi7 + 2*I7*lambda8*phi5 + 2*I8*lambda8*phi4 - 2*I2*lambda12*phi7 + 2*I8*lambda8*phi5 - 2*I1*lambda14*phi7 - 2*I3*lambda12*phi7 + 2*I7*lambda10*phi5 - 2*I1*lambda14*phi8 - 2*I2*lambda14*phi7 - 2*I4*lambda12*phi7 + 2*I7*lambda10*phi6 + 2*I8*lambda10*phi5 - 2*I2*lambda14*phi8 - 2*I3*lambda14*phi7 - 2*I5*lambda12*phi7 + 2*I8*lambda10*phi6 - 2*I3*lambda14*phi8 - 2*I4*lambda14*phi7 - 2*I6*lambda12*phi7 + 2*I7*lambda12*phi6 - 2*I4*lambda14*phi8 - 2*I5*lambda14*phi7 + 2*I8*lambda12*phi6 - 2*I5*lambda14*phi8 - 2*I6*lambda14*phi7 - 2*I6*lambda14*phi8)/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8);...
             -(2*I1*force24 - 2*I8*force6 - 2*I8*force9 - 2*I8*force12 - 2*I8*force15 - 2*I8*force3 + 2*I2*force24 - 2*I8*force18 + 2*I3*force24 + 2*I4*force24 + 2*I5*force24 - 2*I8*force21 + 2*I6*force24 + 2*I7*force24 + 4*I8*lambda1 + 4*I8*lambda3 + 4*I8*lambda5 - 2*I1*lambda13 - 2*I2*lambda13 + 4*I8*lambda7 - 2*I3*lambda13 - 2*I4*lambda13 + 4*I8*lambda9 - 2*I5*lambda13 - 2*I6*lambda13 + 4*I8*lambda11 - 2*I7*lambda13 + 2*I8*lambda13 + 2*I8*lambda2*phi1 + 2*I8*lambda2*phi2 + 2*I8*lambda4*phi2 + 2*I8*lambda4*phi3 + 2*I8*lambda6*phi3 + 2*I8*lambda6*phi4 + 2*I8*lambda8*phi4 + 2*I8*lambda8*phi5 - 2*I1*lambda14*phi8 + 2*I8*lambda10*phi5 - 2*I2*lambda14*phi8 + 2*I8*lambda10*phi6 - 2*I3*lambda14*phi8 - 2*I4*lambda14*phi8 + 2*I8*lambda12*phi6 - 2*I5*lambda14*phi8 + 2*I8*lambda12*phi7 - 2*I6*lambda14*phi8 - 2*I7*lambda14*phi8 + 2*I8*lambda14*phi7)/(I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8)];
    end
elseif Go == 0  % Stop
    ActivelyStop = 0;
    if ActivelyStop == 0  % Turn off motors
        Ui = zeros(nb,1);
    elseif ActivelyStop == 1  % Actively Stop
        Ui = [150*(0-(phi4p-phi1p));...
              150*(0-(phi4p-phi1p));...
              150*(0-(phi4p-phi1p));...
              0;...
              150*(0-(phi8p-phi5p));...
              150*(0-(phi8p-phi5p));...
              150*(0-(phi8p-phi5p))];
    end
end

end